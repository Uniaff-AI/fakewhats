---
// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
---

<script>
  // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
  (function() {
    'use strict';
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–±–∏–ª—å–Ω–æ–µ –ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
    const isAndroid = /Android/.test(navigator.userAgent);
    
    if (!isMobile) return; // –í—ã—Ö–æ–¥–∏–º –µ—Å–ª–∏ –Ω–µ –º–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
    
    // console.log('üì± Mobile device detected, applying optimizations...');
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–∞–º—è—Ç–∏
    function cleanupMemory() {
      // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—á–∏—â–∞–µ–º –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞
      if ('caches' in window) {
        caches.keys().then(function(names) {
          names.forEach(function(name) {
            caches.delete(name);
          });
        });
      }
      
      // –û—á–∏—â–∞–µ–º –≤—Å–µ —Ç–∞–π–º–µ—Ä—ã
      const highestTimeoutId = setTimeout(";");
      for (let i = 0; i < highestTimeoutId; i++) {
        clearTimeout(i);
      }
      
      // –û—á–∏—â–∞–µ–º –≤—Å–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
      const highestIntervalId = setInterval(";");
      for (let i = 0; i < highestIntervalId; i++) {
        clearInterval(i);
      }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤–∏–¥–µ–æ
    function optimizeVideos() {
      const videos = document.querySelectorAll('video');
      videos.forEach(video => {
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        video.setAttribute('playsinline', 'true');
        video.setAttribute('webkit-playsinline', 'true');
        video.setAttribute('x5-video-player-type', 'h5');
        video.setAttribute('x5-video-player-fullscreen', 'false');
        
        // –û—Ç–∫–ª—é—á–∞–µ–º –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫—É –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
        video.setAttribute('preload', 'metadata');
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
        if (video.videoWidth > 0) {
          const aspectRatio = video.videoWidth / video.videoHeight;
          if (aspectRatio > 1.5) { // –®–∏—Ä–æ–∫–æ—Ñ–æ—Ä–º–∞—Ç–Ω–æ–µ –≤–∏–¥–µ–æ
            video.style.objectFit = 'contain';
          }
        }
      });
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    function optimizeImages() {
      const images = document.querySelectorAll('img');
      images.forEach(img => {
        // –û—Ç–∫–ª—é—á–∞–µ–º –ª–µ–Ω–∏–≤—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        if (img.classList.contains('product-image') || img.classList.contains('review-image')) {
          img.removeAttribute('loading');
        }
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
        img.style.imageRendering = 'optimize-contrast';
      });
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ CSS –∞–Ω–∏–º–∞—Ü–∏–π
    function optimizeAnimations() {
      // –û—Ç–∫–ª—é—á–∞–µ–º —Å–ª–æ–∂–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
      const style = document.createElement('style');
      style.textContent = `
        @media (max-width: 768px) {
          * {
            transition: none !important;
            animation: none !important;
            transform: none !important;
          }
          
          .vsl-overlay,
          .vsl-vignette,
          .vsl-text-overlay {
            transition: none !important;
            animation: none !important;
          }
        }
      `;
      document.head.appendChild(style);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    function monitorPerformance() {
      let frameCount = 0;
      let lastTime = performance.now();
      
      function countFrames() {
        frameCount++;
        const currentTime = performance.now();
        
        if (currentTime - lastTime >= 1000) {
          const fps = Math.round((frameCount * 1000) / (currentTime - lastTime));
          
          // –ï—Å–ª–∏ FPS –ø–∞–¥–∞–µ—Ç –Ω–∏–∂–µ 30, –ø—Ä–∏–º–µ–Ω—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
          if (fps < 30) {
            // console.log('‚ö†Ô∏è Low FPS detected:', fps, 'applying additional optimizations...');
            
            // –û—Ç–∫–ª—é—á–∞–µ–º –≤—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            const style = document.createElement('style');
            style.textContent = `
              * {
                transition: none !important;
                animation: none !important;
                transform: none !important;
                box-shadow: none !important;
                filter: none !important;
              }
            `;
            document.head.appendChild(style);
            
            // –û—á–∏—â–∞–µ–º –ø–∞–º—è—Ç—å
            cleanupMemory();
          }
          
          frameCount = 0;
          lastTime = currentTime;
        }
        
        requestAnimationFrame(countFrames);
      }
      
      requestAnimationFrame(countFrames);
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π
    function optimizeEvents() {
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º passive listeners –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
      const passiveOptions = { passive: true };
      
      // –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∫—Ä–æ–ª–ª–∞
      document.addEventListener('scroll', () => {}, passiveOptions);
      document.addEventListener('touchmove', () => {}, passiveOptions);
      document.addEventListener('wheel', () => {}, passiveOptions);
      
      // –û—Ç–∫–ª—é—á–∞–µ–º –Ω–µ–Ω—É–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
      document.addEventListener('contextmenu', (e) => {
        e.preventDefault();
        return false;
      });
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ localStorage
    function optimizeStorage() {
      // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
      setInterval(() => {
        const savedTime = localStorage.getItem('savedVideoTime');
        if (savedTime) {
          const savedTimeNum = parseFloat(savedTime);
          // –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –±–æ–ª—å—à–µ 15 –º–∏–Ω—É—Ç, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –µ–≥–æ
          if (savedTimeNum > 900) {
            localStorage.removeItem('savedVideoTime');
            localStorage.removeItem('savedChatVideoTime');
            // console.log('üßπ Cleared old video time data');
          }
        }
      }, 300000); // 5 –º–∏–Ω—É—Ç
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–µ—Ç–∏
    function optimizeNetwork() {
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –≤–∏–¥–µ–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
      const videos = document.querySelectorAll('video');
      videos.forEach(video => {
        if (video.preload === 'auto') {
          video.preload = 'metadata';
        }
      });
      
      // –û—Ç–∫–ª—é—á–∞–µ–º –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫—É –¥–ª—è –Ω–µ–≤–∞–∂–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
      const links = document.querySelectorAll('link[rel="preload"]');
      links.forEach(link => {
        if (link.href.includes('video') || link.href.includes('image')) {
          link.remove();
        }
      });
    }
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    function applyAllOptimizations() {
      // console.log('üöÄ Applying mobile optimizations...');
      
      optimizeVideos();
      optimizeImages();
      optimizeAnimations();
      optimizeEvents();
      optimizeStorage();
      optimizeNetwork();
      
      // –ó–∞–ø—É—Å–∫–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
      monitorPerformance();
      
      // console.log('‚úÖ Mobile optimizations applied successfully');
    }
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', applyAllOptimizations);
    } else {
      applyAllOptimizations();
    }
    
    // –ü—Ä–∏–º–µ–Ω—è–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        // –ü—Ä–∏ —Å–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ—á–∏—â–∞–µ–º –ø–∞–º—è—Ç—å
        cleanupMemory();
      } else {
        // –ü—Ä–∏ –ø–æ–∫–∞–∑–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏–º–µ–Ω—è–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–Ω–æ–≤–æ
        setTimeout(applyAllOptimizations, 1000);
      }
    });
    
    // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
    window.mobileOptimizations = {
      cleanupMemory,
      optimizeVideos,
      isMobile,
      isIOS,
      isAndroid
    };
    
  })();
</script>
