ÐºÐ»Ð¸Ðº---
import { COPY } from '../content/copy';
import OrderForm from './OrderForm.astro';
import ReturnPopup from './ReturnPopup.astro';
import FormReturnPopup from './FormReturnPopup.astro';
import TimeSelectionPopup from './TimeSelectionPopup.astro';
import DomonetkaForm from './DomonetkaForm.astro';
import VSLExitPopup from './VSLExitPopup.astro';
import ReturnVisitPopup from './ReturnVisitPopup.astro';

import DiscountButton from './DiscountButton.astro';
import { siteConfig } from '../config/site-config';
const { messages, form } = COPY;
  const autoPostbackMs = form.autoPostbackSeconds ? form.autoPostbackSeconds * 1000 : 180000;
---

<div class="container">
  <slot name="header" />
  <div class="chat" id="chat">
    <!-- Encryption Message -->
    <div class="bubble encryption">
      ðŸ”’ {siteConfig.texts.chatMessages.encryptionMessage}
    </div>

    <!-- Urgent Message -->
    <div class="bubble urgent">
      <strong>{siteConfig.texts.chatMessages.urgentMessage}</strong><br><br>
      {siteConfig.texts.chatMessages.problemMessage}
    </div>

    <!-- VSL Card -->
    <div class="bubble vsl-bubble">
      <div class="vsl-card">
        <div class="vsl-thumb">
                      <video id="vslVideoInline" src={siteConfig.images.videos.chatVsl} muted loop playsinline preload="metadata" loading="lazy" class="vsl-video" controls webkit-playsinline x-webkit-airplay="allow" x5-video-player-type="h5" data-popup-start={siteConfig.settings.vslPopupStartTime} data-popup-end={siteConfig.settings.vslPopupEndTime} data-video-src={siteConfig.images.videos.chatVsl}></video>
          <div class="vsl-overlay">
            <!-- Ð—ÐµÐ»ÐµÐ½Ð°Ñ Ð¼Ð¸Ð³Ð°ÑŽÑ‰Ð°Ñ ÐºÐ½Ð¾Ð¿ÐºÐ° Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð·Ð²ÑƒÐºÐ° -->
            <div class="vsl-sound-btn" id="vslPlayBtn" style="cursor: pointer; z-index: 5; pointer-events: auto;">
              <div class="sound-btn-content">
                <div class="sound-btn-text-top">{siteConfig.texts.buttons.enableSound}</div>
                <div class="sound-btn-text-bottom">{siteConfig.texts.buttons.saveErection}</div>
              </div>
            </div>
            
            <!-- ÐŸÑ€Ð¾ÑÑ‚Ð°Ñ ÐºÐ½Ð¾Ð¿ÐºÐ° Ð¿Ð¾Ð²ÐµÑ€Ñ… Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ (ÑÐºÑ€Ñ‹Ñ‚Ð° Ð¸Ð·Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾) -->
            <button id="vslPlayBtnSimple" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: transparent; border: none; width: 200px; height: 80px; cursor: pointer; z-index: 7; display: none;"></button>
            
            <!-- ÐœÐ°Ð»ÐµÐ½ÑŒÐºÐ°Ñ ÐºÐ½Ð¾Ð¿ÐºÐ° Ð²Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð·Ð²ÑƒÐºÐ° (ÑÐºÑ€Ñ‹Ñ‚Ð° Ð¸Ð·Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾) -->
            <button id="vslMuteBtn" style="position: absolute; top: 10px; right: 10px; background: rgba(0, 0, 0, 0.7); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; z-index: 6; font-size: 16px; display: none; pointer-events: auto;">ðŸ”‡</button>
            
            <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° "ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ ÑÐ½Ð°Ñ‡Ð°Ð»Ð°" -->
            <button id="vslRestartBtn" style="position: absolute; top: 10px; right: 90px; background: rgba(0, 0, 0, 0.7); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; z-index: 8; font-size: 16px; display: none; pointer-events: auto;" title="ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ ÑÐ½Ð°Ñ‡Ð°Ð»Ð°">â†»</button>
            
            <!-- ÐšÑ€ÐµÑÑ‚Ð¸Ðº Ð´Ð»Ñ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ VSL -->
            <button id="vslCloseBtn" style="position: absolute; top: 10px; right: 50px; background: rgba(0, 0, 0, 0.7); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; z-index: 8; font-size: 18px; display: none; pointer-events: auto;">âœ•</button>
            
            <!-- ÐŸÐ¾Ð¿Ð°Ð¿ Ð½Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¹ Ð¼Ð¸Ð½ÑƒÑ‚Ðµ VSL -->
            <div id="vslMidPopup" class="vsl-mid-popup" style="display: none;">
              <!-- Ð—ÐµÐ»ÐµÐ½Ð°Ñ Ð¿Ð»Ð°ÑˆÐºÐ° ÑÐ²ÐµÑ€Ñ…Ñƒ -->
              <div class="vsl-mid-banner" onclick="if(window.showOrderForm) window.showOrderForm();" style="cursor: pointer;">
                <div class="vsl-mid-vignette"></div>
                <div>{siteConfig.texts.popups.vslMidPopup.title}</div>
                <div style="font-size: 14px; margin-top: 5px;">{siteConfig.texts.popups.vslMidPopup.subtitle}</div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- Discount Button Message (ÑÐºÑ€Ñ‹Ñ‚ Ð¸Ð·Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾) -->
    <div class="discount-message" style="display: none;">
      <div class="product-image">
        <img src={siteConfig.images.chatImages.productImage} alt={siteConfig.productName} loading="lazy" />
      </div>
      <div class="discount-content">
        <div class="discount-text">
          <p><strong>{siteConfig.texts.banners.exclusiveOffer}</strong> Disponible especÃ­ficamente para ti</p>
          <p>{siteConfig.texts.banners.actionPrice} {siteConfig.productName}!</p>
          <p>{siteConfig.texts.banners.leaveRequest}</p>
        </div>
        <button id="getDiscountBtn" class="discount-btn">
          {siteConfig.texts.buttons.getSpecialOffer}
        </button>
      </div>
    </div>



    <!-- Auto Message with Product (shown after 3 minutes or on minimize) -->
    <div class="auto-message" id="autoMessage" style="display: none;">
      <div class="auto-message-content">
        <div class="product-image">
          <img src={siteConfig.images.chatImages.productImage} alt={siteConfig.productName} loading="lazy" />
        </div>
        <div class="message-text">
          <p><strong>{siteConfig.texts.banners.exclusiveOffer}</strong> Disponible especÃ­ficamente para ti</p>
          <p>{siteConfig.texts.banners.actionPrice} {siteConfig.productName}!</p>
          <p>{siteConfig.texts.banners.leaveRequest}</p>
        </div>
      </div>
    </div>

    <!-- Auto Discount Button (separate from message) -->
    <div class="bubble auto-discount-container" id="autoDiscountContainer" style="display: none;">
      <button class="auto-discount-btn" id="autoDiscountBtn">
        {siteConfig.texts.buttons.getSpecialOffer}
      </button>
    </div>

    <!-- ÐŸÐ¾Ð¿Ð°Ð¿ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð¿Ñ€Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ VSL -->
    <div id="vslCloseChoicePopup" class="vsl-close-choice-popup" style="display: none;">
      <div class="vsl-close-choice-content">
        <h3>{siteConfig.texts.popups.vslCloseChoicePopup.title}</h3>
        <p class="vsl-close-choice-subtitle">{siteConfig.texts.popups.vslCloseChoicePopup.subtitle}</p>
        <div class="vsl-close-choice-buttons">
          <button id="continueWatchingChoice" class="btn-primary">{siteConfig.texts.popups.vslCloseChoicePopup.continueButton}</button>
          <button id="returnToChatChoice" class="btn-secondary">{siteConfig.texts.popups.vslCloseChoicePopup.returnToChatButton}</button>
        </div>
      </div>
    </div>





  </div>

  <!-- PWA Modals (positioned relative to chat container) -->
  <div class="pwa-modal" id="orderFormModal" style="display: none;">
    <div class="pwa-modal-backdrop" id="orderFormBackdrop"></div>
    <div class="pwa-modal-content">
      <div class="pwa-modal-header">
        <div class="pwa-modal-handle"></div>
        <button class="pwa-modal-close" id="closeOrderFormModal">âœ•</button>
      </div>
      
      <div class="pwa-modal-body">
        <!-- Form Header -->
        <div class="form-header">
          <h2 class="form-title">Formulario oficial de pedido UROXEL</h2>
        </div>

        <!-- Product Image -->
        <div class="product-image-section">
          <img src="/Uroxel_form.png" alt="UROXEL Triple Action" class="product-image" loading="eager" fetchpriority="high" />
        </div>

        <!-- Timer -->
        <div class="timer-section">
          <div class="timer-badge">
            <span id="orderTimer">04:19</span>
          </div>
        </div>

        <!-- Form Fields -->
        <form id="orderLeadForm" class="order-form-fields">
          <div class="form-group">
            <label for="orderName" class="field-label">{siteConfig.texts.forms.orderForm.namePlaceholder}</label>
            <input type="text" id="orderName" name="name" class="form-input" placeholder={siteConfig.texts.forms.orderForm.namePlaceholder} required>
          </div>

          <div class="form-group">
            <label for="orderPhone" class="field-label">{siteConfig.texts.forms.orderForm.phonePlaceholder}</label>
                          <input type="tel" id="orderPhone" name="phone" class="form-input" placeholder={siteConfig.texts.forms.orderForm.phonePlaceholder} required>
          </div>

                      <button type="submit" class="submit-btn">{siteConfig.texts.buttons.orderCall}</button>

          <div class="form-disclaimer">
            {siteConfig.legal.specialPriceDisclaimer} {siteConfig.legal.timerDisclaimer} {siteConfig.legal.mexicoOnly} {siteConfig.legal.consultationDisclaimer}
          </div>

          <!-- ÐŸÐ»Ð°ÑˆÐºÐ° Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°Ð¼Ð¸ Ð¼ÑƒÐ¶Ñ‡Ð¸Ð½ -->
          <div class="reviews-banner">
            <div class="reviews-text">
              {siteConfig.texts.banners.reviewsBanner.split(', ').slice(0, 1).join(', ')}<br>
              {siteConfig.texts.banners.reviewsBanner.split(', ').slice(1, 2).join(', ')}<br>
              {siteConfig.texts.banners.reviewsBanner.split(', ').slice(2).join(', ')}
            </div>
          </div>

          <!-- ÐžÑ‚Ð·Ñ‹Ð²Ñ‹ -->
          <div class="reviews-section">
            <!-- ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ð¾Ñ‚Ð·Ñ‹Ð² (ÐÐ½Ñ‚Ð¾Ð½Ð¸Ð¾) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback1.image} alt={`${siteConfig.productName} Ð¾Ñ‚Ð·Ñ‹Ð² ${siteConfig.reviews.feedback1.name}`} loading="eager" fetchpriority="high">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback1.name} - {siteConfig.reviews.feedback1.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'â˜…'.repeat(siteConfig.reviews.feedback1.rating)}{'â˜†'.repeat(5 - siteConfig.reviews.feedback1.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback1.rating}.0</span>
                </div>
              </div>
            </div>

            <!-- Ð’Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¾Ñ‚Ð·Ñ‹Ð² (ÐšÐ°Ñ€Ð»Ð¾Ñ) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback2.image} alt={`${siteConfig.productName} Ð¾Ñ‚Ð·Ñ‹Ð² ${siteConfig.reviews.feedback2.name}`} loading="eager" fetchpriority="high">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback2.name} - {siteConfig.reviews.feedback2.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'â˜…'.repeat(siteConfig.reviews.feedback2.rating)}{'â˜†'.repeat(5 - siteConfig.reviews.feedback2.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback2.rating}.0</span>
                </div>
              </div>
            </div>

            <!-- Ð¢Ñ€ÐµÑ‚Ð¸Ð¹ Ð¾Ñ‚Ð·Ñ‹Ð² (ÐÐ¼Ð°Ð»Ð¸Ñ) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback3.image} alt={`${siteConfig.productName} Ð¾Ñ‚Ð·Ñ‹Ð² ${siteConfig.reviews.feedback3.name}`} loading="eager" fetchpriority="high">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback3.name} - {siteConfig.reviews.feedback3.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'â˜…'.repeat(siteConfig.reviews.feedback3.rating)}{'â˜†'.repeat(5 - siteConfig.reviews.feedback3.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback3.rating}.0</span>
                </div>
              </div>
            </div>

            <!-- Ð§ÐµÑ‚Ð²ÐµÑ€Ñ‚Ñ‹Ð¹ Ð¾Ñ‚Ð·Ñ‹Ð² (ÐÐ»Ð¾Ð½ÑÐ¾) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback4.image} alt={`${siteConfig.productName} Ð¾Ñ‚Ð·Ñ‹Ð² ${siteConfig.reviews.feedback4.name}`} loading="eager" fetchpriority="high">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback4.name} - {siteConfig.reviews.feedback4.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'â˜…'.repeat(siteConfig.reviews.feedback4.rating)}{'â˜†'.repeat(5 - siteConfig.reviews.feedback4.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback4.rating}.0</span>
                </div>
              </div>
            </div>

            <!-- ÐŸÑÑ‚Ñ‹Ð¹ Ð¾Ñ‚Ð·Ñ‹Ð² (Ð“ÑƒÑÑ‚Ð°Ð²Ð¾) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback5.image} alt={`${siteConfig.productName} Ð¾Ñ‚Ð·Ñ‹Ð² ${siteConfig.reviews.feedback5.name}`} loading="eager" fetchpriority="high">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback5.name} - {siteConfig.reviews.feedback5.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'â˜…'.repeat(siteConfig.reviews.feedback5.rating)}{'â˜†'.repeat(5 - siteConfig.reviews.feedback5.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback5.rating}.0</span>
                </div>
              </div>
            </div>

            <!-- Ð¨ÐµÑÑ‚Ð¾Ð¹ Ð¾Ñ‚Ð·Ñ‹Ð² (Ð˜Ð³Ð½Ð°ÑÐ¸Ð¾) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback6.image} alt={`${siteConfig.productName} Ð¾Ñ‚Ð·Ñ‹Ð² ${siteConfig.reviews.feedback6.name}`} loading="eager" fetchpriority="high">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback6.name} - {siteConfig.reviews.feedback6.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'â˜…'.repeat(siteConfig.reviews.feedback6.rating)}{'â˜†'.repeat(5 - siteConfig.reviews.feedback6.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback6.rating}.0</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Ð¢ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ðµ Ð¾Ñ‚Ð·Ñ‹Ð²Ñ‹ Ð±ÐµÐ· ÐºÐ°Ñ€Ñ‚Ð¸Ð½Ð¾Ðº -->
          <div class="text-reviews-section">
            <!-- ÐžÑ‚Ð·Ñ‹Ð² 1 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">ðŸ‘¤</div>
                  <div class="reviewer-name">{siteConfig.textReviews.review1.name}</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">{'â˜…'.repeat(siteConfig.textReviews.review1.rating)}{'â˜†'.repeat(5 - siteConfig.textReviews.review1.rating)}</span>
                  <span class="rating-score">{siteConfig.textReviews.review1.rating}.0</span>
                </div>
              </div>
              <div class="review-title">{siteConfig.textReviews.review1.title}</div>
              <div class="review-date">{siteConfig.textReviews.review1.date}</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">{siteConfig.textReviews.review1.text}</div>
              {siteConfig.textReviews.review1.helpful && <div class="review-helpful">{siteConfig.textReviews.review1.helpful}</div>}
            </div>

            <!-- ÐžÑ‚Ð·Ñ‹Ð² 2 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">ðŸ‘¤</div>
                  <div class="reviewer-name">Carlos</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">â˜…â˜…â˜…â˜…â˜…</span>
                  <span class="rating-score">5.0</span>
                </div>
              </div>
              <div class="review-title">Buen producto</div>
              <div class="review-date">Comentado en MÃ©xico el 21 de abril de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Estoy muy conforme con el producto</div>
            </div>

            <!-- ÐžÑ‚Ð·Ñ‹Ð² 3 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">ðŸ‘¤</div>
                  <div class="reviewer-name">Elmer HRmo</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">â˜…â˜…â˜…â˜…â˜†</span>
                  <span class="rating-score">4.0</span>
                </div>
              </div>
              <div class="review-title">Buen producto</div>
              <div class="review-date">Comentado en MÃ©xico el 11 de agosto de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Buen producto</div>
            </div>

            <!-- ÐžÑ‚Ð·Ñ‹Ð² 4 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">ðŸ‘¤</div>
                  <div class="reviewer-name">Roberto Soriano DÃ¡vila</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">â˜…â˜…â˜…â˜…â˜…</span>
                  <span class="rating-score">5.0</span>
                </div>
              </div>
              <div class="review-title">Seriedad del proveedor.</div>
              <div class="review-date">Comentado en MÃ©xico el 9 de noviembre de 2024</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Muy buen producto, empezÃ³ a actuar desde la primera toma, contiene elementos muy valiosos como el zinc, ya que la prÃ³stata es el Ã³rgano que contiene 10 veces mÃ¡s Zinc que cualquier otro Ã³rgano, tambiÃ©n el licopeno que se usa para combatir el cÃ¡ncer, asÃ­ como otros productos valiosos como el ciruelo africano y la ortiga que han sido probados para desinflamar la prÃ³stata. Lo recomiendo ampliamente.</div>
              <div class="review-helpful">A 4 personas les resultÃ³ Ãºtil</div>
            </div>

            <!-- ÐžÑ‚Ð·Ñ‹Ð² 5 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">ðŸ‘¤</div>
                  <div class="reviewer-name">Gerardo ponce lopez</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">â˜…â˜…â˜…â˜…â˜…</span>
                  <span class="rating-score">5.0</span>
                </div>
              </div>
              <div class="review-title">MUY BIEN</div>
              <div class="review-date">Comentado en MÃ©xico el 20 de junio de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">LLEGÃ“ BIEN GRACIAS</div>
              <div class="review-helpful">A 2 personas les resultÃ³ Ãºtil</div>
            </div>

            <!-- ÐžÑ‚Ð·Ñ‹Ð² 6 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">ðŸ‘¤</div>
                  <div class="reviewer-name">Cliente de Kindle</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">â˜…â˜…â˜…â˜…â˜†</span>
                  <span class="rating-score">4.0</span>
                </div>
              </div>
              <div class="review-title">Excelente</div>
              <div class="review-date">Comentado en MÃ©xico el 4 de mayo de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Ya voy por la quinta lata. Â¡El efecto es mejor de lo prometido!</div>
            </div>

            <!-- ÐžÑ‚Ð·Ñ‹Ð² 7 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">ðŸ‘¤</div>
                  <div class="reviewer-name">GABRIEL MUÃ‘OZ NUÃ‘EZ</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">â˜…â˜…â˜…â˜…â˜…</span>
                  <span class="rating-score">5.0</span>
                </div>
              </div>
              <div class="review-title">Gracias</div>
              <div class="review-date">Comentado en MÃ©xico el 7 de junio de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Gracias</div>
            </div>

            <!-- ÐžÑ‚Ð·Ñ‹Ð² 8 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">ðŸ‘¤</div>
                  <div class="reviewer-name">RamÃ³n NÃºÃ±ez-Doval</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">â˜…â˜…â˜…â˜…â˜…</span>
                  <span class="rating-score">5.0</span>
                </div>
              </div>
              <div class="review-title">Uroxel es un buen producto</div>
              <div class="review-date">Comentado en MÃ©xico el 16 de abril de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Es un buen producto como se nos habÃ­a anunciado.</div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="pwa-modal" id="callBookingModal" style="display: none;">
    <div class="pwa-modal-backdrop" id="callBookingBackdrop"></div>
    <div class="pwa-modal-content">
      <div class="pwa-modal-header">
        <div class="pwa-modal-handle"></div>
        <button class="pwa-modal-close" id="closeCallBookingModal">âœ•</button>
      </div>
      
      <div class="pwa-modal-body">
        <!-- Product Image -->
        <div class="product-image-section">
          <img src="/Uroxel_form.png" alt="UROXEL Triple Action" class="product-image" loading="eager" fetchpriority="high" />
        </div>

        <div class="call-to-action">
          <h3 class="call-title">{siteConfig.texts.headers.bookCallTitle}</h3>
                      <p class="call-subtitle">{siteConfig.texts.headers.bookCallSubtitle}</p>
        </div>

        <div class="time-selection">
          <select id="callTime" class="time-dropdown">
            <option value="Ahora mismo">Ahora mismo</option>
            <option value="5 minutos">5 minutos</option>
            <option value="15 minutos">15 minutos</option>
            <option value="30 minutos">30 minutos</option>
          </select>
        </div>

                  <button id="callSubmitBtn" class="call-submit-btn">{siteConfig.texts.buttons.orderCall}</button>
        <button id="backToOrderBtn" class="back-btn-chat">{siteConfig.texts.buttons.backToOrder}</button>
      </div>
    </div>
  </div>

  

    <!-- Chat Input (outside of chat container) -->
    <div class="chat-input">
    <button class="input-btn">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
      </svg>
    </button>
    <div class="input-field-container">
      <input type="text" class="chat-input-field" placeholder="Mensaje" />
      <button class="emoji-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.5 11c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0C9.33 11 10 10.33 10 9.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
        </svg>
      </button>
    </div>
    <div class="input-actions">
      <button class="action-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"/>
        </svg>
      </button>
      <button class="action-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 12m-3.2 0a3.2 3.2 0 1 1 6.4 0a3.2 3.2 0 1 1 -6.4 0"/>
          <path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"/>
        </svg>
      </button>
      <button class="action-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
          <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<!-- ÐŸÐ¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ð»ÐµÐµÑ€ Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð²ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð·Ð²ÑƒÐº -->
<div id="fullscreenPlayer" class="fullscreen-player" style="display: none;">
  <div class="fullscreen-player-content">
            <div class="video-wrapper">
          <video id="fullscreenVideo" src={siteConfig.images.videos.chatVsl} playsinline preload="metadata" controls webkit-playsinline x-webkit-airplay="allow" x5-video-player-type="h5" x5-video-player-fullscreen="true" x5-video-orientation="landscape"></video>
        </div>
    <button id="fullscreenCloseBtn" class="fullscreen-close-btn" style="z-index: 1010;">âœ•</button>
    
    <!-- ÐŸÐ¾Ð¿Ð°Ð¿ Ð½Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¹ Ð¼Ð¸Ð½ÑƒÑ‚Ðµ VSL (ÑÐºÑ€Ñ‹Ñ‚ Ð¸Ð·Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾) -->
    <div id="fullscreenVslMidPopup" class="fullscreen-vsl-mid-popup" style="display: none;">
      <!-- Ð—ÐµÐ»ÐµÐ½Ð°Ñ Ð¿Ð»Ð°ÑˆÐºÐ° ÑÐ²ÐµÑ€Ñ…Ñƒ -->
      <div class="fullscreen-vsl-mid-banner" onclick="showOrderFormModal();" style="cursor: pointer;">
        <div class="fullscreen-vsl-mid-vignette"></div>
        <div>{siteConfig.texts.popups.vslMidPopup.title}</div>
        <div style="font-size: 14px; margin-top: 5px;">{siteConfig.texts.popups.vslMidPopup.subtitle}</div>
      </div>
    </div>
  </div>
</div>

<!-- Main VSL Popup -->
<!-- ÐŸÐ¾Ð¿Ð°Ð¿ Ñ Ð²Ð¸Ð´ÐµÐ¾ ÑƒÐ´Ð°Ð»ÐµÐ½ - Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ -->

<!-- Return Popup Component -->
<ReturnPopup />

<!-- Form Return Popup Component -->
<FormReturnPopup />

<!-- Time Selection Popup Component -->
<TimeSelectionPopup />

<!-- Order Form Component (ÑÐºÑ€Ñ‹Ñ‚, Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ñ„Ð¾Ñ€Ð¼Ð° Ð² Ñ‡Ð°Ñ‚Ðµ) -->
<!-- <OrderForm /> -->

  <!-- Domonetka Form Component -->
  <DomonetkaForm />
  
  <!-- VSL Start Popup Component -->
  
  
  <!-- VSL Exit Popup Component -->
  <!-- <VSLExitPopup /> -->
  
  <!-- Return Visit Popup Component -->
  <ReturnVisitPopup />

<script>
  const openVsl = document.getElementById('openVsl');
  // const popup = document.getElementById('popup'); // Ð£Ð´Ð°Ð»ÐµÐ½
  // const closePopup = document.getElementById('closePopup'); // Ð£Ð´Ð°Ð»ÐµÐ½
  // const video = document.getElementById('vslVideo'); // Ð£Ð´Ð°Ð»ÐµÐ½
  const floatingForm = document.getElementById('floatingForm');
  const minimizeBtn = document.getElementById('minimizeBtn');
  const minimizedBadge = document.getElementById('minimizedBadge');
  const leadForm = document.getElementById('leadForm');
  const calltime = document.getElementById('calltime');

  let postbackTimeoutId;
  let videoStartTime = 0;
  let hasShownForm = false;
  
  // Ð¤Ð»Ð°Ð³Ð¸ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ð½ÑƒÐ¶Ð½Ñ‹ - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ ÐµÐ´Ð¸Ð½Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°

  function toggleVslSound() {
    const video = document.getElementById('vslVideoInline');
    const playBtn = document.getElementById('vslPlayBtn');
    const playBtnSimple = document.getElementById('vslPlayBtnSimple');
    const muteBtn = document.getElementById('vslMuteBtn');
    const closeBtn = document.getElementById('vslCloseBtn');
    
    if (video) {
      if (video.muted) {
        // Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð·Ð²ÑƒÐº
        video.muted = false;
        
        // Ð¡ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¾ÑÐ½Ð¾Ð²Ð½ÑƒÑŽ ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð¸ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÐ¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ
        if (playBtn) playBtn.style.display = 'none';
        if (playBtnSimple) playBtnSimple.style.display = 'none';
        if (muteBtn) {
          muteBtn.style.display = 'block';
          muteBtn.textContent = 'ðŸ”‡';
        }
        if (closeBtn) closeBtn.style.display = 'block';
      } else {
        // Ð’Ñ‹ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð·Ð²ÑƒÐº
        video.muted = true;
        
        // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¾ÑÐ½Ð¾Ð²Ð½ÑƒÑŽ ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð¸ ÑÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÐ¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ
        if (playBtn) playBtn.style.display = 'flex';
        if (playBtnSimple) playBtnSimple.style.display = 'block';
        if (muteBtn) muteBtn.style.display = 'none';
        if (closeBtn) closeBtn.style.display = 'none';
      }
    }
  }

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾ Ð² ReturnPopup Ð±ÐµÐ· ÐºÐ½Ð¾Ð¿Ð¾Ðº
  function openVideoInReturnPopup() {
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ReturnPopup
    if (window.showReturnPopup) {
      window.showReturnPopup();
      
      // Ð¡Ñ€Ð°Ð·Ñƒ ÑÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð¸ Ñ‚ÐµÐºÑÑ‚
      setTimeout(function() {
        const textOverlay = document.querySelector('.vsl-text-overlay');
        const vignette = document.querySelector('.vsl-vignette');
        
        if (textOverlay) {
          textOverlay.style.display = 'none';
        }
        if (vignette) {
          vignette.style.display = 'none';
        }
        
        // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ ÐºÑƒÑ€ÑÐ¾Ñ€ pointer Ñ Ð²Ð¸Ð´ÐµÐ¾
        const video = document.getElementById('returnVslVideo');
        if (video) {
          video.style.cursor = 'default';
        }
      }, 100);
    }
  }
  
  function openPopup() {
    // ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ VSL Ð² Ñ‡Ð°Ñ‚Ðµ Ð¿ÐµÑ€ÐµÐ´ Ð¿Ð¾ÐºÐ°Ð·Ð¾Ð¼ Ð¿Ð¾Ð¿Ð°Ð¿Ð°
    if (window.stopChatVsl) {
      window.stopChatVsl();
    }
    
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð¾Ð¼ Ð²Ð¼ÐµÑÑ‚Ð¾ Ð¿Ñ€ÑÐ¼Ð¾Ð³Ð¾ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾
    if (window.showReturnPopup) {
      window.showReturnPopup();
    }
  }

  // function closePopupAndShowForm() {
  //   // Ð£Ð´Ð°Ð»ÐµÐ½Ð° - Ð¿Ð¾Ð¿Ð°Ð¿ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ
  // }
  
  hasShownForm = true;
  scheduleAutoPostback();

  function minimizeForm() {
    floatingForm.dataset.minimized = 'true';
    floatingForm.style.display = 'none';
    minimizedBadge.style.display = 'inline-flex';
  }

  function expandForm() {
    floatingForm.dataset.minimized = 'false';
    floatingForm.style.display = 'block';
    minimizedBadge.style.display = 'none';
  }

  function scheduleAutoPostback() {
    // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÑƒ Ð·Ð°ÑÐ²Ð¾Ðº
    clearTimeout(postbackTimeoutId);
  }

  async function sendPostback(extra={}) {
    const formData = new FormData(leadForm);
    const payload = {
      ktDomain: "uniaffshark.com",
      ktCampaignId: 10314,
      leadName: formData.get('name') || '',
      phone: formData.get('phone') || '',
      calltime: formData.get('calltime') || '',
      videoWatchTime: videoStartTime ? Math.floor((Date.now() - videoStartTime) / 1000) : 0,
      ...extra,
      ts: Date.now(),
      ua: navigator.userAgent
    };
    
    // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ (Ð´Ð»Ñ ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ ÑÐ°Ð¹Ñ‚Ð°)
    // console.log('[UROXEL Lead]', {
    //   serverTimestamp: new Date().toISOString(),
    //   ktDomain: payload.ktDomain,
    //   ktCampaignId: payload.ktCampaignId,
    //   leadName: payload.leadName,
    //   phone: payload.phone,
    //   calltime: payload.calltime,
    //   reason: payload.reason,
    //   videoWatchTime: payload.videoWatchTime,
    //   userAgent: payload.ua,
    //   clientTimestamp: payload.ts
    // });
    
    // Ð—Ð´ÐµÑÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÑƒ Ð² Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ ÑÐµÑ€Ð²Ð¸ÑÑ‹
    // ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Google Analytics, Facebook Pixel, Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ CRM Ð¸ Ñ‚.Ð´.
    // console.log('ðŸ“Š Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹ Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð² CRM:', payload);
  }

  // Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð½Ð° API
  async function sendLeadToAPI(leadData, action) {
    const apiUrl = "https://api.pwa.uniaffcrm.com/v1/add_lead";
    
    // ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ API
    const apiData = {
      ktDomain: leadData.ktDomain || "uniaffshark.com",
      ktCampaignId: leadData.ktCampaignId || 10314,
      leadName: leadData.leadName || leadData.name,
      phone: leadData.phone,
      calltime: leadData.calltime,
    };
    
    try {
      // console.log(`ðŸš€ ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ð° API (${action}):`, apiData);
      
      const response = await fetch(apiUrl, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(apiData)
      });
      
      if (response.ok) {
        const result = await response.json();
        // console.log(`âœ… Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ñ‹ Ð½Ð° API (${action}):`, result);
        return { success: true, data: result };
      } else {
        // console.error(`âŒ ÐžÑˆÐ¸Ð±ÐºÐ° API (${action}):`, response.status, response.statusText);
        return { success: false, error: `HTTP ${response.status}: ${response.statusText}` };
      }
    } catch (error) {
      // console.error(`âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð½Ð° API (${action}):`, error);
      return { success: false, error: error.message };
    }
  }

  // Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ð·Ð°Ð¼ÐµÐ½Ð° API)
  function logLeadData(leadData, action) {
    // console.log(`[UROXEL Lead - ${action}]`, {
    //   serverTimestamp: new Date().toISOString(),
    //   ktDomain: leadData.ktDomain || "uniaffshark.com",
    //   ktCampaignId: leadData.ktCampaignId || 10314,
    //   leadName: leadData.leadName || leadData.name,
    //   phone: leadData.phone,
    //   calltime: leadData.calltime,
    //   reason: leadData.reason || action,
    //   videoWatchTime: leadData.videoWatchTime,
    //   userAgent: leadData.userAgent,
    //   clientTimestamp: leadData.ts || Date.now()
    // });
    // console.log(`ðŸ“Š Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸ (${action}) Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹ Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð² CRM:`, leadData);
  }

  // Event Listeners
  // openVsl?.addEventListener('click', (e) => { 
  //   e.preventDefault(); 
  //   openPopup(); 
  // });

  // closePopup?.addEventListener('click', () => { 
  //   closePopupAndShowForm(); 
  // });

  // popup?.addEventListener('click', (e) => { 
  //   if (e.target === popup) { 
  //     closePopupAndShowForm(); 
  //   } 
  // });

  minimizeBtn?.addEventListener('click', () => { 
    minimizeForm(); 
  });

  minimizedBadge?.addEventListener('click', () => { 
    expandForm(); 
  });

  calltime?.addEventListener('change', () => { 
    // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÑƒ
  });

  leadForm?.addEventListener('submit', async (e) => {
    e.preventDefault();
    clearTimeout(postbackTimeoutId);
    await sendPostback({ reason: 'submit' });
    minimizeForm();
    alert('Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾! ÐœÑ‹ ÑÐ²ÑÐ¶ÐµÐ¼ÑÑ Ñ Ð²Ð°Ð¼Ð¸.');
  });

  // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹
  // console.log('ðŸ” Chat.astro: Checking localStorage for savedVideoTime...');
  const savedTimeFromStorage = localStorage.getItem('savedVideoTime');
  // console.log('ðŸ” Chat.astro: savedTimeFromStorage:', savedTimeFromStorage);
  // console.log('ðŸ” Chat.astro: All localStorage keys:', Object.keys(localStorage));
  
  if (savedTimeFromStorage) {
    const savedTime = parseFloat(savedTimeFromStorage);
    // console.log('ðŸ” Chat.astro: Found saved time:', savedTime, 'seconds');
    if (savedTime > 10) {
      // console.log('ðŸ” Chat.astro: Time > 10 seconds, should show return popup');
    }
  } else {
    // console.log('ðŸ” Chat.astro: No saved time found');
  }

  // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð²Ð¸Ð´ÐµÐ¾ Ð¿Ñ€Ð¸ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐµ ÑƒÑ…Ð¾Ð´Ð°
  document.addEventListener('visibilitychange', () => {
    const video = document.getElementById('vslVideoInline');
    const fullscreenVideo = document.getElementById('fullscreenVideo');
    
    if (document.hidden) {
      // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ Ð²Ð¸Ð´ÐµÐ¾ Ð² Ñ‡Ð°Ñ‚Ðµ (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² savedChatVideoTime)
      if (video && !video.paused) {
        if (window.saveVideoTime) {
          window.saveVideoTime();
        }
      }
      
      // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð²Ð¸Ð´ÐµÐ¾ (Ð² savedVideoTime Ð´Ð»Ñ Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð°)
      if (fullscreenVideo && !fullscreenVideo.paused && fullscreenVideo.currentTime > 0) {
        // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð²ÑÐµÑ… Ð¿Ð»ÐµÐµÑ€Ð¾Ð² Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ ÑÐ°Ð¼Ð¾Ðµ Ð¿Ð¾Ð·Ð´Ð½ÐµÐµ
        const chatVideo = document.getElementById('vslVideoInline');
        const returnVideo = document.getElementById('returnVslVideo');
        const returnVisitVideo = document.getElementById('returnVisitVideo');
        
        let maxTime = fullscreenVideo.currentTime;
        let maxSource = 'fullscreen';
        
        if (chatVideo && chatVideo.currentTime > maxTime) {
          maxTime = chatVideo.currentTime;
          maxSource = 'chat';
        }
        
        if (returnVideo && returnVideo.currentTime > maxTime) {
          maxTime = returnVideo.currentTime;
          maxSource = 'return';
        }
        
        if (returnVisitVideo && returnVisitVideo.currentTime > maxTime) {
          maxTime = returnVisitVideo.currentTime;
          maxSource = 'returnVisit';
        }
        
        localStorage.setItem('savedVideoTime', maxTime.toString());
        // console.log('ðŸ’¾ Saved MAX video time on page hide from', maxSource, ':', maxTime, 'seconds');
      }
      
      // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ñ€ÐµÑÑƒÑ€ÑÑ‹ Ð´Ð»Ñ ÑÐºÐ¾Ð½Ð¾Ð¼Ð¸Ð¸ Ð¿Ð°Ð¼ÑÑ‚Ð¸ Ð½Ð° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ…
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      if (isMobile) {
        // ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¾Ñ‡Ð¸Ñ‰Ð°ÐµÐ¼ ÐºÐµÑˆ Ð²Ð¸Ð´ÐµÐ¾ Ð½Ð° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ…
        if (video) {
          video.removeAttribute('src');
          video.load();
        }
        if (fullscreenVideo) {
          fullscreenVideo.removeAttribute('src');
          fullscreenVideo.load();
        }
      }
    }
  });

  // ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð²Ð¸Ð´ÐµÐ¾ (Ð¿ÐµÑ€ÐµÐ¼Ð¾Ñ‚ÐºÐ° Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð°)
  const vslVideoInline = document.getElementById('vslVideoInline');
  if (vslVideoInline) {
    // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
    const newVslVideoInline = vslVideoInline.cloneNode(true);
    vslVideoInline.parentNode.replaceChild(newVslVideoInline, vslVideoInline);
    
    // ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð½Ð¾Ð²Ñ‹Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚
    const cleanVslVideoInline = document.getElementById('vslVideoInline');
    
    // ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ
    cleanVslVideoInline.addEventListener('contextmenu', (e) => {
      e.preventDefault();
      return false;
    });
    
    // ÐŸÐµÑ€ÐµÐ¼Ð¾Ñ‚ÐºÐ° Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð° - ÑƒÐ±Ð¸Ñ€Ð°ÐµÐ¼ Ð²ÑÐµ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸
    // console.log('âœ… Video seeking enabled for vslVideoInline');

    // Ð›Ð¾Ð³Ð¸ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ð´Ð»Ñ Ð²Ð¸Ð´ÐµÐ¾ Ð² Ñ‡Ð°Ñ‚Ðµ
    let savedChatVideoTime = 0;
    
    // Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¸ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸
    const savedTime = localStorage.getItem('savedChatVideoTime');
    if (savedTime) {
      savedChatVideoTime = parseFloat(savedTime);
      // console.log('ðŸ“º Loaded saved chat video time:', savedChatVideoTime);
    }
    
    // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°
    function saveChatVideoTime() {
      if (cleanVslVideoInline && cleanVslVideoInline.currentTime > 0) {
        savedChatVideoTime = cleanVslVideoInline.currentTime;
        localStorage.setItem('savedChatVideoTime', savedChatVideoTime.toString());
        
        // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð²ÑÐµÑ… Ð¿Ð»ÐµÐµÑ€Ð¾Ð² Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ ÑÐ°Ð¼Ð¾Ðµ Ð¿Ð¾Ð·Ð´Ð½ÐµÐµ Ð² savedVideoTime
        const fullscreenVideo = document.getElementById('fullscreenVideo');
        const returnVideo = document.getElementById('returnVslVideo');
        const returnVisitVideo = document.getElementById('returnVisitVideo');
        
        let maxTime = cleanVslVideoInline.currentTime;
        let maxSource = 'chat';
        
        if (fullscreenVideo && fullscreenVideo.currentTime > maxTime) {
          maxTime = fullscreenVideo.currentTime;
          maxSource = 'fullscreen';
        }
        
        if (returnVideo && returnVideo.currentTime > maxTime) {
          maxTime = returnVideo.currentTime;
          maxSource = 'return';
        }
        
        if (returnVisitVideo && returnVisitVideo.currentTime > maxTime) {
          maxTime = returnVisitVideo.currentTime;
          maxSource = 'returnVisit';
        }
        
        localStorage.setItem('savedVideoTime', maxTime.toString());
        
        const minutes = Math.floor(savedChatVideoTime / 60);
        const seconds = Math.floor(savedChatVideoTime % 60);
        // console.log(`ðŸ’¾ Saved chat video time: ${savedChatVideoTime} seconds (${minutes}:${seconds.toString().padStart(2, '0')})`);
        // console.log(`ðŸ’¾ Saved MAX video time from ${maxSource}: ${maxTime} seconds`);
      }
    }
    
    // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ ÐºÐ°Ð¶Ð´Ñ‹Ðµ 5 ÑÐµÐºÑƒÐ½Ð´ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ
    const chatTimeInterval = setInterval(() => {
      if (cleanVslVideoInline && !cleanVslVideoInline.paused && cleanVslVideoInline.currentTime > 0) {
        saveChatVideoTime();
      }
    }, 5000); // ÐšÐ°Ð¶Ð´Ñ‹Ðµ 5 ÑÐµÐºÑƒÐ½Ð´
    
    // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¸ Ð¿Ð°ÑƒÐ·Ðµ
    cleanVslVideoInline.addEventListener('pause', saveChatVideoTime);
    
    // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹
    window.addEventListener('beforeunload', saveChatVideoTime);
    
    // Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ Ð²Ð¸Ð´ÐµÐ¾
    cleanVslVideoInline.addEventListener('loadeddata', () => {
      if (savedChatVideoTime > 0) {
        cleanVslVideoInline.currentTime = savedChatVideoTime;
        // console.log('â° Restored chat video time to:', savedChatVideoTime);
      }
    });

    // Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð´Ð»Ñ iOS Safari
    if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
      // console.log('ðŸŽ iOS device detected, applying special handling');
      
      // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾ Ð¿Ð¾ÑÐ»Ðµ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ ÑÐºÑ€Ð°Ð½Ð°
      const iosVisibilityHandler = () => {
        if (!document.hidden && cleanVslVideoInline.paused && cleanVslVideoInline.currentTime > 0) {
          // console.log('ðŸ“± Device unlocked, attempting to resume video');
          setTimeout(() => {
            cleanVslVideoInline.play().catch(() => {
              // console.log('âš ï¸ Could not auto-resume on iOS unlock');
            });
          }, 500);
        }
      };
      
      // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð¾Ñ‚ÐµÑ€Ð¸ Ñ„Ð¾ÐºÑƒÑÐ°
      const iosFocusHandler = () => {
        if (cleanVslVideoInline.paused && cleanVslVideoInline.currentTime > 0) {
          // console.log('ðŸ“± Window focused, attempting to resume video');
          setTimeout(() => {
            cleanVslVideoInline.play().catch(() => {
              // console.log('âš ï¸ Could not auto-resume on iOS focus');
            });
          }, 300);
        }
      };
      
      document.addEventListener('visibilitychange', iosVisibilityHandler);
      window.addEventListener('focus', iosFocusHandler);
      
      // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð°Ñ…
      cleanVslVideoInline.addEventListener('stalled', () => {
        // console.log('â¸ï¸ iOS video stalled, attempting recovery...');
        setTimeout(() => {
          if (cleanVslVideoInline.readyState < 2) {
            cleanVslVideoInline.load();
            // console.log('ðŸ”„ iOS video reloaded after stall');
          }
        }, 2000);
      });
      
      // ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° iOS Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð² Ð¿Ñ€Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹
      window.addEventListener('beforeunload', () => {
        document.removeEventListener('visibilitychange', iosVisibilityHandler);
        window.removeEventListener('focus', iosFocusHandler);
        clearInterval(chatTimeInterval);
      });
    } else {
      // ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»Ð° Ð´Ð»Ñ Ð½Ðµ-iOS ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²
      window.addEventListener('beforeunload', () => {
        clearInterval(chatTimeInterval);
      });
    }

  }



  // Exit intent Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½ - Ð¿Ð¾Ð¿Ð°Ð¿ Ð¿Ñ€Ð¸ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐµ Ð·Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ð½Ðµ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ
  // document.addEventListener('mouseleave', (e) => {
  //   if (e.clientY <= 0 && !hasShownForm && !hasVisitedBefore) {
  //     if (window.showReturnPopup) {
  //       window.showReturnPopup();
  //     }
  //   }
  // });

  // VSL Ð½Ðµ Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ - Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ ÐºÐ»Ð¸ÐºÑƒ
  let hasOpenedVsl = false;
  
  // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð±Ñ‹Ð» Ð»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ Ñ€Ð°Ð½ÐµÐµ
  let hasVisitedBefore = localStorage.getItem('hasVisitedBefore');
  
  // ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ð²Ð¸Ð·Ð¸Ñ‚ - Ð·Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°ÐµÐ¼ (VSL Ð² Ñ‡Ð°Ñ‚Ðµ Ð½Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸)
  if (!hasVisitedBefore) {
    localStorage.setItem('hasVisitedBefore', 'true');
  }

  // Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ð¸ ÑÑ‡ÐµÑ‚Ñ‡Ð¸Ðº Ð±Ð°Ð½Ð¾Ðº
  let globalTimeLeft = 4 * 60 + 19; // 4 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ 19 ÑÐµÐºÑƒÐ½Ð´
  let globalBottlesLeft = 39;
  let globalTotalBottles = 1500;
  
  function updateGlobalTimer() {
    const minutes = Math.floor(globalTimeLeft / 60);
    const seconds = globalTimeLeft % 60;
    const timerElements = document.querySelectorAll('#timer, #domonetkaTimer, #orderTimer');
    timerElements.forEach(element => {
      element.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    });
    
    if (globalTimeLeft > 0) {
      globalTimeLeft--;
    }
  }
  
  function updateGlobalBottles() {
    const bottlesElements = document.querySelectorAll('#bottles, #domonetkaBottles');
    bottlesElements.forEach(element => {
      if (globalBottlesLeft > 0) {
        globalBottlesLeft--;
        element.textContent = `${globalBottlesLeft}/${globalTotalBottles}`;
      }
    });
  }
  
  // Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ñ‹ (Ð·Ð°Ð¿ÑƒÑÐºÐ°ÑŽÑ‚ÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð·)
  let globalTimerInterval;
  let globalBottlesInterval;
  let globalTimersStarted = false;
  
  function startGlobalTimers() {
    if (!globalTimersStarted) {
      if (!globalTimerInterval) {
        globalTimerInterval = setInterval(updateGlobalTimer, 1000);
      }
      if (!globalBottlesInterval) {
        globalBottlesInterval = setInterval(updateGlobalBottles, 4000 + Math.random() * 1000);
      }
      globalTimersStarted = true;
    }
  }
  
  // Ð¢Ð°Ð¹Ð¼ÐµÑ€Ñ‹ Ð±ÑƒÐ´ÑƒÑ‚ Ð·Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¸ Ð¿Ð¾ÐºÐ°Ð·Ðµ Ñ„Ð¾Ñ€Ð¼
  // startGlobalTimers(); // Ð£Ð±Ñ€Ð°Ð½Ð¾ - Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ñ‹ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÑŽÑ‚ÑÑ Ð¿Ñ€Ð¸ Ð¿Ð¾ÐºÐ°Ð·Ðµ Ñ„Ð¾Ñ€Ð¼

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÐºÐ½Ð¾Ð¿ÐºÐ¸ "ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÐºÐ¸Ð´ÐºÑƒ"
  const getDiscountBtn = document.getElementById('getDiscountBtn');
  getDiscountBtn?.addEventListener('click', () => {
    // console.log('getDiscountBtn clicked');
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ñ„Ð¾Ñ€Ð¼Ñƒ Ð·Ð°ÐºÐ°Ð·Ð° ÐºÐ°Ðº PWA Ð¼Ð¾Ð´Ð°Ð»
    const orderFormModal = document.getElementById('orderFormModal');
    if (orderFormModal) {
      orderFormModal.style.display = 'flex';
      setTimeout(() => {
        orderFormModal.classList.add('show');
        // Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ñ‹ Ð¿Ñ€Ð¸ Ð¿Ð¾ÐºÐ°Ð·Ðµ Ñ„Ð¾Ñ€Ð¼Ñ‹
        startGlobalTimers();
      }, 10);
    }
  });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð´Ð»Ñ Ñ„Ð¾Ñ€Ð¼ Ð² Ñ‡Ð°Ñ‚Ðµ
  const orderLeadForm = document.getElementById('orderLeadForm');
  const callSubmitBtn = document.getElementById('callSubmitBtn');
  const backToOrderBtn = document.getElementById('backToOrderBtn');

  // Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ñ„Ð¾Ñ€Ð¼Ñ‹
  let savedFormData = {};

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ñ„Ð¾Ñ€Ð¼Ñ‹ Ð·Ð°ÐºÐ°Ð·Ð°
  orderLeadForm?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    // console.log('Order form submitted');
    
    const formData = new FormData(orderLeadForm);
    const leadData = {
      ktDomain: "uniaffshark.com",
      ktCampaignId: 10314,
      leadName: formData.get('name'),
      phone: formData.get('phone'),
      calltime: "ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð¾",
      timestamp: new Date().toISOString(),
      reason: 'order_form',
      videoWatchTime: videoStartTime ? Math.floor((Date.now() - videoStartTime) / 1000) : 0,
      userAgent: navigator.userAgent
    };
    
    // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ Ñ„Ð¾Ñ€Ð¼Ñ‹
    savedFormData = {
      name: formData.get('name'),
      phone: formData.get('phone'),
      videoWatchTime: videoStartTime ? Math.floor((Date.now() - videoStartTime) / 1000) : 0
    };
    
    // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ð° API
    const apiResult = await sendLeadToAPI(leadData, 'order_form_submit');
    
    // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸
    logLeadData(leadData, 'order_form_submit');
    // console.log('Order form submitted successfully');
    
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ñ„Ð¾Ñ€Ð¼Ñƒ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð·Ð²Ð¾Ð½ÐºÐ°
    const orderFormModal = document.getElementById('orderFormModal');
    if (orderFormModal) {
      orderFormModal.classList.remove('show');
      setTimeout(() => {
        orderFormModal.style.display = 'none';
      }, 300);
    }
    
    const callBookingModal = document.getElementById('callBookingModal');
    if (callBookingModal) {
      callBookingModal.style.display = 'flex';
      setTimeout(() => {
        callBookingModal.classList.add('show');
      }, 10);
    }
  });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ñ„Ð¾Ñ€Ð¼Ñ‹ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð·Ð²Ð¾Ð½ÐºÐ°
  callSubmitBtn?.addEventListener('click', async () => {
    const callTimeElement = document.getElementById('callTime');
    const callTime = callTimeElement ? callTimeElement.value : 'ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð¾';
    
    // console.log('Selected call time:', callTime);
    // console.log('Call time element:', callTimeElement);
    
    const leadData = {
      ktDomain: "uniaffshark.com",
      ktCampaignId: 10314,
      leadName: savedFormData.name || '',
      phone: savedFormData.phone || '',
      calltime: callTime,
      timestamp: new Date().toISOString(),
      reason: 'call_booking',
      videoWatchTime: savedFormData.videoWatchTime || 0,
      userAgent: navigator.userAgent
    };
    
    // console.log('Call booking form submitted with data:', leadData);
    
    // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ð° API
    const apiResult = await sendLeadToAPI(leadData, 'call_booking_submit');
    
    // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸
    logLeadData(leadData, 'call_booking_submit');
    
    // Ð¡ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ñ„Ð¾Ñ€Ð¼Ñƒ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
    const callBookingModal = document.getElementById('callBookingModal');
    if (callBookingModal) {
      callBookingModal.classList.remove('show');
      setTimeout(() => {
        callBookingModal.style.display = 'none';
      }, 300);
    }
    
          // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾Ð± ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¼ Ð·Ð°ÐºÐ°Ð·Ðµ Ð² Ñ‡Ð°Ñ‚Ðµ
      showSuccessMessageInChat(savedFormData.name || '');
    
    // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ
    savedFormData = {};
    // console.log('Call booking form submitted successfully');
  });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÐºÐ½Ð¾Ð¿ÐºÐ¸ "ÐÐ°Ð·Ð°Ð´" Ð² Ñ„Ð¾Ñ€Ð¼Ðµ Ð±Ñ€Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
  backToOrderBtn?.addEventListener('click', async () => {
    // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸ Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ð¸ "ÐÐ°Ð·Ð°Ð´"
    if (savedFormData.name && savedFormData.phone) {
      const callTimeElement = document.getElementById('callTime');
      const callTime = callTimeElement ? callTimeElement.value : 'ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð¾';
      
      const leadData = {
        name: savedFormData.name,
        phone: savedFormData.phone,
        callTime: callTime,
        timestamp: new Date().toISOString(),
        reason: 'call_booking_back_button',
        videoWatchTime: savedFormData.videoWatchTime || 0,
        userAgent: navigator.userAgent
      };
      
      try {
        // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸ (Ð·Ð°Ð¼ÐµÐ½Ð° API)
        logLeadData(leadData, 'form_interaction');
        // console.log('Call booking back button clicked - data sent');
      } catch (error) {
        // console.error('Error sending call booking back button data:', error);
      }
    }
    
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ (Ñ‡ÐµÑ‚Ð²ÐµÑ€Ñ‚Ð°Ñ ÑÑ‚Ð°Ð´Ð¸Ñ)
    if (window.showTimeSelectionPopup) {
      window.showTimeSelectionPopup();
    }
  });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð¼Ð¾Ð´Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð¾ÐºÐ¾Ð½
  const closeOrderFormModal = document.getElementById('closeOrderFormModal');
  const closeCallBookingModal = document.getElementById('closeCallBookingModal');
  const orderFormBackdrop = document.getElementById('orderFormBackdrop');
  const callBookingBackdrop = document.getElementById('callBookingBackdrop');

  function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.remove('show');
      setTimeout(() => {
        modal.style.display = 'none';
      }, 300);
    }
  }

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð·Ð°ÑÐ²ÐºÐ¸ Ð±ÐµÐ· Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
  async function sendAutoCallRequest() {
    const leadData = {
      ktDomain: "uniaffshark.com",
      ktCampaignId: 10314,
      leadName: savedFormData.name || '',
      phone: savedFormData.phone || '',
      calltime: 'ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð¾',
      timestamp: new Date().toISOString(),
      reason: 'auto_call_booking',
      videoWatchTime: savedFormData.videoWatchTime || 0,
      userAgent: navigator.userAgent
    };
    
    // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ð° API
    const apiResult = await sendLeadToAPI(leadData, 'call_booking_submit');
    
    // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸
    logLeadData(leadData, 'call_booking_submit');
    // console.log('Auto call request sent successfully');
  }

  closeOrderFormModal?.addEventListener('click', async () => {
    // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ Ñ„Ð¾Ñ€Ð¼Ñ‹ Ð·Ð°ÐºÐ°Ð·Ð°
    if (savedFormData.name && savedFormData.phone) {
      const leadData = {
        ktDomain: "uniaffshark.com",
        ktCampaignId: 10314,
        leadName: savedFormData.name,
        phone: savedFormData.phone,
        calltime: 'Ð¤Ð¾Ñ€Ð¼Ð° Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼',
        timestamp: new Date().toISOString(),
        reason: 'order_form_closed',
        videoWatchTime: savedFormData.videoWatchTime || 0,
        userAgent: navigator.userAgent
      };
      
      try {
        // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð½Ð° API
        const apiResult = await sendLeadToAPI(leadData, 'form_interaction');
        
        // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸
        logLeadData(leadData, 'form_interaction');
        // console.log('Order form closed - data sent');
      } catch (error) {
        // console.error('Error sending order form close data:', error);
      }
    }
    
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ñ Ñ„Ð¾Ñ€Ð¼Ñ‹ (Ñ‚Ñ€ÐµÑ‚ÑŒÑ ÑÑ‚Ð°Ð´Ð¸Ñ)
    if (window.showFormReturnPopup) {
      window.showFormReturnPopup();
    }
  });

  closeCallBookingModal?.addEventListener('click', async () => {
    // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ Ñ„Ð¾Ñ€Ð¼Ñ‹ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
    if (savedFormData.name && savedFormData.phone) {
      const callTimeElement = document.getElementById('callTime');
      const callTime = callTimeElement ? callTimeElement.value : 'ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð¾';
      
      const leadData = {
        name: savedFormData.name,
        phone: savedFormData.phone,
        callTime: callTime,
        timestamp: new Date().toISOString(),
        reason: 'call_booking_closed',
        videoWatchTime: savedFormData.videoWatchTime || 0,
        userAgent: navigator.userAgent
      };
      
      try {
        // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸ (Ð·Ð°Ð¼ÐµÐ½Ð° API)
        logLeadData(leadData, 'form_interaction');
        // console.log('Call booking form closed - data sent');
      } catch (error) {
        // console.error('Error sending call booking close data:', error);
      }
    }
    
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ (Ñ‡ÐµÑ‚Ð²ÐµÑ€Ñ‚Ð°Ñ ÑÑ‚Ð°Ð´Ð¸Ñ)
    if (window.showTimeSelectionPopup) {
      window.showTimeSelectionPopup();
    }
  });

  orderFormBackdrop?.addEventListener('click', async () => {
    // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸ ÐºÐ»Ð¸ÐºÐµ Ð½Ð° Ñ„Ð¾Ð½ Ñ„Ð¾Ñ€Ð¼Ñ‹ Ð·Ð°ÐºÐ°Ð·Ð°
    if (savedFormData.name && savedFormData.phone) {
      const leadData = {
        name: savedFormData.name,
        phone: savedFormData.phone,
        callTime: 'Ð¤Ð¾Ñ€Ð¼Ð° Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼',
        timestamp: new Date().toISOString(),
        reason: 'order_form_backdrop_closed',
        videoWatchTime: savedFormData.videoWatchTime || 0,
        userAgent: navigator.userAgent
      };
      
      try {
        // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸ (Ð·Ð°Ð¼ÐµÐ½Ð° API)
        logLeadData(leadData, 'form_interaction');
        // console.log('Order form backdrop clicked - data sent');
      } catch (error) {
        // console.error('Error sending order form backdrop data:', error);
      }
    }
    
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ñ Ñ„Ð¾Ñ€Ð¼Ñ‹ (Ñ‚Ñ€ÐµÑ‚ÑŒÑ ÑÑ‚Ð°Ð´Ð¸Ñ)
    if (window.showFormReturnPopup) {
      window.showFormReturnPopup();
    }
  });

  callBookingBackdrop?.addEventListener('click', async () => {
    // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸ ÐºÐ»Ð¸ÐºÐµ Ð½Ð° Ñ„Ð¾Ð½ Ñ„Ð¾Ñ€Ð¼Ñ‹ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
    if (savedFormData.name && savedFormData.phone) {
      const callTimeElement = document.getElementById('callTime');
      const callTime = callTimeElement ? callTimeElement.value : 'ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð¾';
      
      const leadData = {
        name: savedFormData.name,
        phone: savedFormData.phone,
        callTime: callTime,
        timestamp: new Date().toISOString(),
        reason: 'call_booking_backdrop_closed',
        videoWatchTime: savedFormData.videoWatchTime || 0,
        userAgent: navigator.userAgent
      };
      
      try {
        // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸ (Ð·Ð°Ð¼ÐµÐ½Ð° API)
        logLeadData(leadData, 'form_interaction');
        // console.log('Call booking backdrop clicked - data sent');
      } catch (error) {
        // console.error('Error sending call booking backdrop data:', error);
      }
    }
    
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ (Ñ‡ÐµÑ‚Ð²ÐµÑ€Ñ‚Ð°Ñ ÑÑ‚Ð°Ð´Ð¸Ñ)
    if (window.showTimeSelectionPopup) {
      window.showTimeSelectionPopup();
    }
  });





  // ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ñ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸ÐµÐ¼
  const autoMessage = document.getElementById('autoMessage');
  const autoDiscountContainer = document.getElementById('autoDiscountContainer');
  const autoDiscountBtn = document.getElementById('autoDiscountBtn');
  let hasShownAutoMessage = false;

  function showAutoMessage() {
    // console.log('ðŸŽ¯ showAutoMessage called');
    if (!hasShownAutoMessage && autoMessage && autoDiscountContainer) {
      // console.log('âœ… Showing auto message and button');
      autoMessage.style.display = 'block';
      autoDiscountContainer.style.display = 'block';
      hasShownAutoMessage = true;
      
      // ÐŸÑ€Ð¾ÐºÑ€ÑƒÑ‡Ð¸Ð²Ð°ÐµÐ¼ Ðº ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑŽ
      setTimeout(() => {
        const chatContainer = document.querySelector('.chat');
        if (chatContainer) {
          chatContainer.scrollTop = chatContainer.scrollHeight;
          // console.log('ðŸ“œ Scrolled chat to bottom');
        }
      }, 200);
    } else {
      // console.log('âš ï¸ Auto message already shown or element not found');
    }
  }

  // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð¿Ð¾ÐºÐ°Ð· ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸ ÑÐ²Ð¾Ñ€Ð°Ñ‡Ð¸Ð²Ð°Ð½Ð¸Ð¸ Ð¾ÐºÐ½Ð° - Ð¾Ð½Ð¾ Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² Ð½ÑƒÐ¶Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ VSL
  // document.addEventListener('visibilitychange', () => {
  //   if (document.hidden && !hasShownAutoMessage) {
  //     showAutoMessage();
  //   }
  // });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÐºÐ½Ð¾Ð¿ÐºÐ¸ "ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÐºÐ¸Ð´ÐºÑƒ" Ð² Ð°Ð²Ñ‚Ð¾ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¸
  autoDiscountBtn?.addEventListener('click', () => {
    // console.log('ðŸŽ¯ autoDiscountBtn clicked');
    // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ñ„Ð¾Ñ€Ð¼Ñƒ Ð·Ð°ÐºÐ°Ð·Ð° ÐºÐ°Ðº PWA Ð¼Ð¾Ð´Ð°Ð»
    const orderFormModal = document.getElementById('orderFormModal');
    if (orderFormModal) {
      orderFormModal.style.display = 'flex';
      setTimeout(() => {
        orderFormModal.classList.add('show');
        // Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ñ‹ Ð¿Ñ€Ð¸ Ð¿Ð¾ÐºÐ°Ð·Ðµ Ñ„Ð¾Ñ€Ð¼Ñ‹
        startGlobalTimers();
      }, 10);
    }
  });



  // Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿Ð¾ÐºÐ°Ð· ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ - Ð¾Ð½Ð¾ Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒÑÑ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² Ð½ÑƒÐ¶Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ VSL
  // setTimeout(showAutoMessage, 5000);



  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¾Ð±Ñ…Ð¾Ð´Ð° Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ Ð°Ð²Ñ‚Ð¾Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ
  function startAutoplayWithBypass(video) {
    if (!video) return;
    
    // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð¾ÑˆÐ¸Ð±Ð¾Ðº
    video.removeEventListener('error', handleVideoError);
    video.removeEventListener('stalled', handleVideoStalled);
    video.removeEventListener('waiting', handleVideoWaiting);
    
    // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð´Ð»Ñ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð·Ð°Ð²Ð¸ÑÐ°Ð½Ð¸Ñ
    video.addEventListener('error', handleVideoError);
    video.addEventListener('stalled', handleVideoStalled);
    video.addEventListener('waiting', handleVideoWaiting);
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð»Ð¸ ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð¾
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
    if (isMobile) {
      // ÐÐ° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ… Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð±Ð¾Ð»ÐµÐµ Ð¼ÑÐ³ÐºÐ¸Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´
      video.muted = true;
      video.playsInline = true;
      
      // ÐÐµÐ±Ð¾Ð»ÑŒÑˆÐ°Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ð´Ð»Ñ ÑÑ‚Ð°Ð±Ð¸Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸
      setTimeout(() => {
        video.play().then(() => {
          // console.log('âœ… Mobile video started playing (muted)');
          // Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð·Ð²ÑƒÐº Ñ Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ¾Ð¹ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹
          setTimeout(() => {
            video.muted = false;
            // console.log('ðŸ”Š Mobile video sound enabled');
          }, 1000);
        }).catch((error) => {
          // console.log('âŒ Mobile autoplay failed:', error.name);
          // ÐÐ° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ… Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¶Ð´ÐµÐ¼ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ
          setupUserInteractionAutoplay(video);
        });
      }, 300);
    } else {
      // ÐÐ° Ð´ÐµÑÐºÑ‚Ð¾Ð¿Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸ÑŽ
      video.muted = true;
      video.play().then(() => {
        // console.log('âœ… Desktop video started playing (muted)');
        // Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð·Ð²ÑƒÐº ÑÑ€Ð°Ð·Ñƒ
        video.muted = false;
        // console.log('ðŸ”Š Sound enabled immediately');
      }).catch((error) => {
        // console.log('âŒ Desktop autoplay failed:', error.name);
        
        // Ð¡Ñ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ 2: ÐŸÑ€Ð¾Ð±ÑƒÐµÐ¼ Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹
        setTimeout(() => {
          video.muted = true;
          video.play().then(() => {
            // console.log('âœ… Desktop video started playing (delayed muted)');
            // Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð·Ð²ÑƒÐº ÑÑ€Ð°Ð·Ñƒ
            video.muted = false;
            // console.log('ðŸ”Š Sound enabled immediately (delayed)');
          }).catch((error2) => {
            // console.log('âŒ Delayed autoplay failed:', error2.name);
            
            // Ð¡Ñ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ 3: Ð–Ð´ÐµÐ¼ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
            setupUserInteractionAutoplay(video);
          });
        }, 500);
      });
    }
  }

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð²Ð¸Ð´ÐµÐ¾ Ð´Ð»Ñ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð·Ð°Ð²Ð¸ÑÐ°Ð½Ð¸Ñ
  function handleVideoError(e) {
    const video = e.target;
    // console.log('ðŸš¨ Video error detected:', e);
    
    // ÐŸÑ€Ð¾Ð±ÑƒÐµÐ¼ Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð²Ð¸Ð´ÐµÐ¾
    setTimeout(() => {
      if (video && video.readyState === 0) {
        video.load();
        // console.log('ðŸ”„ Video reloaded after error');
      }
    }, 1000);
  }

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð·Ð°Ð²Ð¸ÑÐ°Ð½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾
  function handleVideoStalled(e) {
    const video = e.target;
    // console.log('â¸ï¸ Video stalled, attempting recovery...');
    
    // ÐŸÑ€Ð¾Ð±ÑƒÐµÐ¼ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ
    setTimeout(() => {
      if (video && video.paused && video.readyState >= 2) {
        video.play().catch(() => {
          // Ð•ÑÐ»Ð¸ Ð½Ðµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ, Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼
          video.load();
          // console.log('ðŸ”„ Video reloaded after stall');
        });
      }
    }, 2000);
  }

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð¾Ð¶Ð¸Ð´Ð°Ð½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…
  function handleVideoWaiting(e) {
    const video = e.target;
    // console.log('â³ Video waiting for data...');
    
    // Ð”Ð°ÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð½Ð° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ, Ð·Ð°Ñ‚ÐµÐ¼ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼
    setTimeout(() => {
      if (video && video.readyState < 2) {
        // console.log('ðŸ”„ Video stuck waiting, reloading...');
        video.load();
      }
    }, 5000);
  }

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð²Ð¸Ð´ÐµÐ¾ Ð¿Ð¾ÑÐ»Ðµ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
  function setupUserInteractionAutoplay(video) {
    let hasUserInteracted = false;
    
    // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð½ÐµÐ²Ð¸Ð´Ð¸Ð¼ÑƒÑŽ ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ
    const playButton = document.createElement('div');
    playButton.style.cssText = `
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: transparent;
      cursor: pointer;
      z-index: 1000;
    `;
    playButton.innerHTML = `
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 20px 40px;
        border-radius: 10px;
        font-size: 18px;
        text-align: center;
        pointer-events: none;
      ">
        â–¶ï¸ ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ
      </div>
    `;
    
    playButton.onclick = () => {
      if (!hasUserInteracted) {
        hasUserInteracted = true;
        playButton.remove();
        video.muted = false;
        video.play().then(() => {
          // console.log('âœ… Fullscreen video started after user interaction');
        }).catch((error) => {
          // console.error('âŒ Failed to play after interaction:', error);
        });
      }
    };
    
    // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð´Ð»Ñ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ñ… Ñ‚Ð¸Ð¿Ð¾Ð² Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ
    const interactionEvents = ['click', 'touchstart', 'keydown', 'mousedown'];
    interactionEvents.forEach(event => {
      playButton.addEventListener(event, () => {
        if (!hasUserInteracted) {
          hasUserInteracted = true;
          playButton.remove();
          video.muted = false;
          video.play().then(() => {
            // console.log('âœ… Fullscreen video started after user interaction');
          }).catch((error) => {
            // console.error('âŒ Failed to play after interaction:', error);
          });
        }
      });
    });
    
    const fullscreenPlayer = document.getElementById('fullscreenPlayer');
    if (fullscreenPlayer) {
      fullscreenPlayer.appendChild(playButton);
    }
  }

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾
  function forceVideoRecovery(video) {
    if (!video) return;
    
    // console.log('ðŸ”„ Force video recovery initiated');
    
    // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ñ‚ÐµÐºÑƒÑ‰ÐµÐµ Ð²Ñ€ÐµÐ¼Ñ
    const currentTime = video.currentTime;
    const wasPaused = video.paused;
    
    // ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð²Ð¸Ð´ÐµÐ¾
    video.load();
    
    // Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ
    video.addEventListener('loadedmetadata', () => {
      if (currentTime > 0) {
        video.currentTime = currentTime;
        // console.log('â° Restored video time to:', currentTime);
      }
      
      // Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ ÐµÑÐ»Ð¸ Ð±Ñ‹Ð»Ð¾
      if (!wasPaused) {
        setTimeout(() => {
          video.play().catch(() => {
            // console.log('âš ï¸ Could not auto-resume after recovery');
          });
        }, 100);
      }
    }, { once: true });
  }

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾
  function setupVideoHealthMonitoring(video) {
    if (!video) return;
    
    let lastProgressTime = 0;
    let stuckCounter = 0;
    let healthCheckInterval;
    let isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
    // ÐÐ° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ… Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ñ€ÐµÐ¶Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ Ð½Ð°Ð³Ñ€ÑƒÐ¶Ð°Ñ‚ÑŒ ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð¾
    const checkInterval = isMobile ? 15000 : 10000;
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÐµ Ð²Ð¸Ð´ÐµÐ¾
    healthCheckInterval = setInterval(() => {
      if (!video || video.ended) {
        clearInterval(healthCheckInterval);
        return;
      }
      
      const currentTime = video.currentTime;
      const isPlaying = !video.paused;
      
      // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð½Ðµ Ð·Ð°Ð²Ð¸ÑÐ»Ð¾ Ð»Ð¸ Ð²Ð¸Ð´ÐµÐ¾
      if (isPlaying && currentTime === lastProgressTime) {
        stuckCounter++;
        // console.log(`âš ï¸ Video might be stuck (${stuckCounter}/3 checks)`);
        
        if (stuckCounter >= 3) {
          // console.log('ðŸš¨ Video confirmed stuck, attempting recovery...');
          // ÐÐ° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ… Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð±Ð¾Ð»ÐµÐµ Ð¼ÑÐ³ÐºÐ¾Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ
          if (isMobile) {
            // ÐŸÑ€Ð¾ÑÑ‚Ð¾ Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð²Ð¸Ð´ÐµÐ¾ Ð±ÐµÐ· Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ
            video.load();
            // console.log('ðŸ”„ Mobile video reloaded after stall');
          } else {
            forceVideoRecovery(video);
          }
          stuckCounter = 0;
        }
      } else {
        stuckCounter = 0;
      }
      
      lastProgressTime = currentTime;
    }, checkInterval);
    
    // Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð´Ð»Ñ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸
    return () => clearInterval(healthCheckInterval);
  }

  // Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð²ÑÐµÑ… Ð²Ð¸Ð´ÐµÐ¾
  window.recoverAllVideos = function() {
    // console.log('ðŸ”„ Global video recovery initiated');
    
    const videos = [
      document.getElementById('vslVideoInline'),
      document.getElementById('fullscreenVideo'),
      document.getElementById('returnVslVideo'),
      document.getElementById('returnVisitVideo')
    ].filter(Boolean);
    
    videos.forEach(video => {
      if (video && video.readyState < 2) {
        // console.log('ðŸ”„ Recovering video:', video.id);
        // ÐÐ° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ… Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð±Ð¾Ð»ÐµÐµ Ð¼ÑÐ³ÐºÐ¾Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        if (isMobile) {
          video.load();
          // console.log('ðŸ”„ Mobile video reloaded:', video.id);
        } else {
          forceVideoRecovery(video);
        }
      }
    });
  };

  // ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð²Ð¸Ð´ÐµÐ¾ ÐºÐ°Ð¶Ð´Ñ‹Ðµ 2 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹
  setInterval(() => {
    if (document.visibilityState === 'visible') {
      window.recoverAllVideos();
    }
  }, 120000); // 2 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹
  
  // ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° Ñ€ÐµÑÑƒÑ€ÑÐ¾Ð² Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ
  window.addEventListener('load', () => {
    // Ð¡Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ Ð²ÑÐµ Ñ„Ð»Ð°Ð³Ð¸ Ð¸ Ð¾Ñ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ñ€ÐµÑÑƒÑ€ÑÑ‹
    if (fullscreenPlayerCleanup) {
      fullscreenPlayerCleanup();
      fullscreenPlayerCleanup = null;
    }
    iosHandlersAdded = false;
    
    // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ localStorage Ð¾Ñ‚ ÑÑ‚Ð°Ñ€Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… ÐµÑÐ»Ð¸ Ð¾Ð½Ð¸ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ ÑÑ‚Ð°Ñ€Ñ‹Ðµ
    const savedTime = localStorage.getItem('savedVideoTime');
    if (savedTime) {
      const savedTimeNum = parseFloat(savedTime);
      // Ð•ÑÐ»Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð±Ð¾Ð»ÑŒÑˆÐµ 10 Ð¼Ð¸Ð½ÑƒÑ‚, ÑÐ±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ ÐµÐ³Ð¾
      if (savedTimeNum > 600) {
        localStorage.removeItem('savedVideoTime');
        localStorage.removeItem('savedChatVideoTime');
        // console.log('ðŸ§¹ Cleared old video time data');
      }
    }
  });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð°Ñ… Ñ Ð¿Ð°Ð¼ÑÑ‚ÑŒÑŽ
  window.addEventListener('beforeunload', () => {
    // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð²ÑÐµ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ñ‹ Ð¸ Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»Ñ‹
    const highestTimeoutId = setTimeout(";");
    for (let i = 0; i < highestTimeoutId; i++) {
      clearTimeout(i);
    }
    
    const highestIntervalId = setInterval(";");
    for (let i = 0; i < highestIntervalId; i++) {
      clearInterval(i);
    }
  });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾ÑÐ»Ðµ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ
  document.addEventListener('visibilitychange', () => {
    if (!document.hidden) {
      // console.log('ðŸ“± Page became visible, checking video health...');
      setTimeout(() => {
        window.recoverAllVideos();
      }, 1000);
    } else {
      // ÐŸÑ€Ð¸ ÑÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹ Ð¾Ñ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ñ€ÐµÑÑƒÑ€ÑÑ‹ Ð´Ð»Ñ ÑÐºÐ¾Ð½Ð¾Ð¼Ð¸Ð¸ Ð¿Ð°Ð¼ÑÑ‚Ð¸
      if (fullscreenPlayerCleanup) {
        fullscreenPlayerCleanup();
        fullscreenPlayerCleanup = null;
      }
      iosHandlersAdded = false;
    }
  });

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ñ‹Ð¼ Ð¿Ð»ÐµÐµÑ€Ð¾Ð¼
  let fullscreenPlayerCleanup = null; // Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ Ð´Ð»Ñ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸
  let iosHandlersAdded = false; // Ð¤Ð»Ð°Ð³ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ Ð´ÑƒÐ±Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ iOS Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð²
  
  function showFullscreenPlayer() {
    const fullscreenPlayer = document.getElementById('fullscreenPlayer');
    const fullscreenVideo = document.getElementById('fullscreenVideo');
    
    if (fullscreenPlayer && fullscreenVideo) {
      // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ðµ Ñ€ÐµÑÑƒÑ€ÑÑ‹ Ð¿ÐµÑ€ÐµÐ´ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸ÐµÐ¼
      if (fullscreenPlayerCleanup) {
        fullscreenPlayerCleanup();
        fullscreenPlayerCleanup = null;
      }
      
      fullscreenPlayer.style.display = 'flex';
      
      // ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ
      fullscreenVideo.controls = true;
      fullscreenVideo.setAttribute('controlsList', 'nodownload nofullscreen noremoteplayback');
      
      // Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð²Ð¸Ð´ÐµÐ¾
      const savedTime = localStorage.getItem('savedVideoTime');
      if (savedTime) {
        const savedVideoTime = parseFloat(savedTime);
        // console.log('ðŸŽ¬ Setting fullscreen video time to:', savedVideoTime, 'seconds');
        
        // Ð–Ð´ÐµÐ¼, Ð¿Ð¾ÐºÐ° Ð²Ð¸Ð´ÐµÐ¾ Ð±ÑƒÐ´ÐµÑ‚ Ð³Ð¾Ñ‚Ð¾Ð²Ð¾ Ðº Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸ÑŽ
        if (fullscreenVideo.readyState >= 2) {
          // Ð’Ð¸Ð´ÐµÐ¾ Ð³Ð¾Ñ‚Ð¾Ð²Ð¾, ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ ÑÑ€Ð°Ð·Ñƒ
          fullscreenVideo.currentTime = savedVideoTime;
          // console.log('âœ… Fullscreen video ready, time set immediately to:', savedVideoTime);
        } else {
          // Ð’Ð¸Ð´ÐµÐ¾ Ð½Ðµ Ð³Ð¾Ñ‚Ð¾Ð²Ð¾, Ð¶Ð´ÐµÐ¼ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ loadedmetadata
          // console.log('â³ Fullscreen video not ready, waiting for loadedmetadata...');
          fullscreenVideo.addEventListener('loadedmetadata', () => {
            fullscreenVideo.currentTime = savedVideoTime;
            // console.log('âœ… Fullscreen video metadata loaded, time set to:', savedVideoTime);
          }, { once: true });
        }
      } else {
        // console.log('ðŸŽ¬ No saved time found, starting from beginning');
        // Ð•ÑÐ»Ð¸ Ð½ÐµÑ‚ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸, Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ñ Ð½Ð°Ñ‡Ð°Ð»Ð°
        if (fullscreenVideo.readyState >= 2) {
          fullscreenVideo.currentTime = 0;
          // console.log('âœ… Fullscreen video ready, starting from beginning');
        } else {
          fullscreenVideo.addEventListener('loadedmetadata', () => {
            fullscreenVideo.currentTime = 0;
            // console.log('âœ… Fullscreen video metadata loaded, starting from beginning');
          }, { once: true });
        }
      }
      
      // Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð²Ð¸Ð´ÐµÐ¾ Ñ Ð¾Ð±Ñ…Ð¾Ð´Ð¾Ð¼ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ Ð°Ð²Ñ‚Ð¾Ð¿Ð»ÐµÑ
      startAutoplayWithBypass(fullscreenVideo);
      
      // Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ Ð²Ð¸Ð´ÐµÐ¾
      const cleanupHealthMonitoring = setupVideoHealthMonitoring(fullscreenVideo);
      
      // ÐŸÐ¾Ð¿Ð°Ð¿ Ð¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· Ð¾Ð±Ñ‹Ñ‡Ð½ÑƒÑŽ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ setupVslTimePopup
      
      // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸ Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ ÑÐºÐ·ÐµÐ¼Ð¿Ð»ÑÑ€Ð°
      fullscreenPlayerCleanup = () => {
        if (cleanupHealthMonitoring) {
          cleanupHealthMonitoring();
        }
        // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð²ÑÐµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹
        fullscreenVideo.removeEventListener('ended', handleFullscreenVideoEnded);
        fullscreenVideo.removeEventListener('timeupdate', handleFullscreenVideoTimeUpdate);
      };
      
      // Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð´Ð»Ñ iOS Safari (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð·)
      if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !iosHandlersAdded) {
        // console.log('ðŸŽ iOS device detected for fullscreen video');
        iosHandlersAdded = true;
        
        // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾ Ð¿Ð¾ÑÐ»Ðµ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ ÑÐºÑ€Ð°Ð½Ð°
        const iosVisibilityHandler = () => {
          if (!document.hidden && fullscreenVideo.paused && fullscreenVideo.currentTime > 0) {
            // console.log('ðŸ“± iOS device unlocked, attempting to resume fullscreen video');
            setTimeout(() => {
              fullscreenVideo.play().catch(() => {
                // console.log('âš ï¸ Could not auto-resume fullscreen video on iOS unlock');
              });
            }, 500);
          }
        };
        
        // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð¾Ñ‚ÐµÑ€Ð¸ Ñ„Ð¾ÐºÑƒÑÐ°
        const iosFocusHandler = () => {
          if (fullscreenVideo.paused && fullscreenVideo.currentTime > 0) {
            // console.log('ðŸ“± iOS window focused, attempting to resume fullscreen video');
            setTimeout(() => {
              fullscreenVideo.play().catch(() => {
                // console.log('âš ï¸ Could not auto-resume fullscreen video on iOS focus');
              });
            }, 300);
          }
        };
        
        document.addEventListener('visibilitychange', iosVisibilityHandler);
        window.addEventListener('focus', iosFocusHandler);
        
        // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÑƒ iOS Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð² Ð² Ð¾Ð±Ñ‰ÑƒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸
        const originalCleanup = fullscreenPlayerCleanup;
        fullscreenPlayerCleanup = () => {
          if (originalCleanup) originalCleanup();
          document.removeEventListener('visibilitychange', iosVisibilityHandler);
          window.removeEventListener('focus', iosFocusHandler);
          iosHandlersAdded = false;
        };
      }
      
      // ÐÐ°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ð½Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¹ Ð¼Ð¸Ð½ÑƒÑ‚Ðµ Ð´Ð»Ñ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¿Ð»ÐµÐµÑ€Ð°
      if (window.setupVslTimePopup) {
        window.setupVslTimePopup(fullscreenVideo);
      }

      // ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ñ„Ð¾Ñ€Ð¼Ñƒ Ð·Ð°ÐºÐ°Ð·Ð° ÐºÐ¾Ð³Ð´Ð° Ð²Ð¸Ð´ÐµÐ¾ Ð·Ð°ÐºÐ¾Ð½Ñ‡Ð¸Ð»Ð¾ÑÑŒ
      fullscreenVideo.addEventListener('ended', handleFullscreenVideoEnded);

      // ÐŸÐµÑ€Ð¸Ð¾Ð´Ð¸Ñ‡ÐµÑÐºÐ¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° ÐºÐ°Ð¶Ð´Ñ‹Ðµ 5 ÑÐµÐºÑƒÐ½Ð´
      fullscreenVideo.addEventListener('timeupdate', handleFullscreenVideoTimeUpdate);
    }
  }
  
  // Ð’Ñ‹Ð½Ð¾ÑÐ¸Ð¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð² Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð´Ð»Ñ Ð»ÑƒÑ‡ÑˆÐµÐ¹ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ¸
  function handleFullscreenVideoEnded() {
    // console.log('ðŸŽ¬ Fullscreen video ended, showing order form');
    if (window.showOrderFormModal) {
      window.showOrderFormModal();
    }
  }
  
  function handleFullscreenVideoTimeUpdate() {
    if (fullscreenVideo && !fullscreenVideo.paused && fullscreenVideo.currentTime > 0) {
      localStorage.setItem('savedVideoTime', fullscreenVideo.currentTime.toString());
      // console.log('ðŸ’¾ Auto-saved fullscreen video time:', fullscreenVideo.currentTime, 'seconds');
      
      // Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¸ Ð¿Ð¾Ð¿Ð°Ð¿ Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· Ð¾Ð±Ñ‹Ñ‡Ð½ÑƒÑŽ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ setupVslTimePopup
      
      // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð½Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ð»Ð¸ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¿Ð¾Ð¿Ð°Ð¿
      const chatVideo = document.getElementById('vslVideoInline');
      if (chatVideo && chatVideo.currentTime > fullscreenVideo.currentTime) {
        // console.log('ðŸ’¾ Chat video time is ahead, updating saved time');
        localStorage.setItem('savedVideoTime', chatVideo.currentTime.toString());
      }
    }
  }
  
  function hideFullscreenPlayer() {
    const fullscreenPlayer = document.getElementById('fullscreenPlayer');
    const fullscreenVideo = document.getElementById('fullscreenVideo');
    
    // console.log('ðŸ” hideFullscreenPlayer called');
    // console.log('ðŸ” fullscreenPlayer found:', !!fullscreenPlayer);
    // console.log('ðŸ” fullscreenVideo found:', !!fullscreenVideo);
    
    if (fullscreenPlayer && fullscreenVideo) {
      // console.log('ðŸ” fullscreenVideo.currentTime:', fullscreenVideo.currentTime);
      // console.log('ðŸ” fullscreenVideo.paused:', fullscreenVideo.paused);
      
      // Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ð¿ÐµÑ€ÐµÐ´ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸ÐµÐ¼
      if (fullscreenVideo.currentTime > 0) {
        // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð²ÑÐµÑ… Ð¿Ð»ÐµÐµÑ€Ð¾Ð² Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ ÑÐ°Ð¼Ð¾Ðµ Ð¿Ð¾Ð·Ð´Ð½ÐµÐµ
        const chatVideo = document.getElementById('vslVideoInline');
        const returnVideo = document.getElementById('returnVslVideo');
        const returnVisitVideo = document.getElementById('returnVisitVideo');
        
        let maxTime = fullscreenVideo.currentTime;
        let maxSource = 'fullscreen';
        
        if (chatVideo && chatVideo.currentTime > maxTime) {
          maxTime = chatVideo.currentTime;
          maxSource = 'chat';
        }
        
        if (returnVideo && returnVideo.currentTime > maxTime) {
          maxTime = returnVideo.currentTime;
          maxSource = 'return';
        }
        
        if (returnVisitVideo && returnVisitVideo.currentTime > maxTime) {
          maxTime = returnVisitVideo.currentTime;
          maxSource = 'returnVisit';
        }
        
        localStorage.setItem('savedVideoTime', maxTime.toString());
        // console.log('ðŸ’¾ Saved MAX video time from', maxSource, ':', maxTime, 'seconds');
        
        // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑÐ¾Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¾ÑÑŒ
        const savedTime = localStorage.getItem('savedVideoTime');
        // console.log('ðŸ” Verified saved time in localStorage:', savedTime);
      } else {
        // console.log('âš ï¸ Video time is 0, not saving');
      }
      
      // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ñ€ÐµÑÑƒÑ€ÑÑ‹ Ð¿ÐµÑ€ÐµÐ´ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸ÐµÐ¼
      if (fullscreenPlayerCleanup) {
        fullscreenPlayerCleanup();
        fullscreenPlayerCleanup = null;
      }
      
      fullscreenPlayer.style.display = 'none';
      fullscreenVideo.pause();
      
      // ÐŸÐ¾Ð¿Ð°Ð¿ ÑÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ñ‡ÐµÑ€ÐµÐ· Ð¾Ð±Ñ‹Ñ‡Ð½ÑƒÑŽ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ
      
      // Ð¤Ð»Ð°Ð³ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ Ð½ÑƒÐ¶ÐµÐ½
      
      // Ð¡Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ Ñ„Ð»Ð°Ð³ iOS Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð²
      iosHandlersAdded = false;
    }
  }

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿Ð¾ÐºÐ°Ð·Ð° Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð½Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¹ Ð¼Ð¸Ð½ÑƒÑ‚Ðµ VSL Ð² Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð¼ Ð¿Ð»ÐµÐµÑ€Ðµ
  function showFullscreenVslMidPopup() {
    // console.log('ðŸŽ¯ Showing fullscreen VSL mid popup');
    const popup = document.getElementById('fullscreenVslMidPopup');
    // console.log('ðŸŽ¯ Popup element found:', !!popup);
    if (popup) {
      // console.log('âœ… Fullscreen popup element found, showing...');
      // console.log('ðŸŽ¯ Popup current display:', popup.style.display);
      // console.log('ðŸŽ¯ Popup current z-index:', popup.style.zIndex);
      
      // ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿
      popup.classList.add('show');
      popup.style.display = 'block';
      popup.style.opacity = '1';
      popup.style.visibility = 'visible';
      popup.style.zIndex = '1000';
      
      // console.log('ðŸŽ¯ Popup display after change:', popup.style.display);
      // console.log('ðŸŽ¯ Popup z-index after change:', popup.style.zIndex);
      // console.log('âœ… Fullscreen popup should now be visible');
      
      // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ Ð±Ð°Ð½Ð½ÐµÑ€ Ñ‚Ð¾Ð¶Ðµ Ð²Ð¸Ð´ÐµÐ½
      const banner = popup.querySelector('.fullscreen-vsl-mid-banner');
      if (banner) {
        // console.log('âœ… Fullscreen banner element found');
        banner.style.zIndex = '1001';
        // console.log('ðŸŽ¯ Fullscreen banner z-index set to:', banner.style.zIndex);
      } else {
        // console.error('âŒ Fullscreen banner element not found!');
      }
    } else {
      // console.error('âŒ Fullscreen popup element not found! fullscreenVslMidPopup does not exist in DOM');
      
      // ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ð¼ Ð²ÑÐµ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ Ñ Ð¿Ð¾Ñ…Ð¾Ð¶Ð¸Ð¼Ð¸ ID
      const allElements = document.querySelectorAll('[id*="popup"]');
      // console.log('ðŸŽ¯ All elements with "popup" in ID:', Array.from(allElements).map(el => el.id));
    }
  }

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº mousedown Ð´Ð»Ñ VSL ÐºÐ½Ð¾Ð¿Ð¾Ðº (Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹)
  document.addEventListener('mousedown', function(e) {
    if (e.target && (e.target.closest('.vsl-sound-btn') || e.target.id === 'vslPlayBtnSimple')) {
      e.preventDefault();
      e.stopPropagation();
      
      // ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ð»ÐµÐµÑ€
      showFullscreenPlayer();
    }
    
    // ÐšÐ½Ð¾Ð¿ÐºÐ° Ð²Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð·Ð²ÑƒÐºÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ°Ðº Ñ€Ð°Ð½ÑŒÑˆÐµ
    if (e.target && e.target.id === 'vslMuteBtn') {
      e.preventDefault();
      e.stopPropagation();
      toggleVslSound();
    }
  });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÐºÐ»Ð¸ÐºÐ° Ð½Ð° VSL Ð² Ñ‡Ð°Ñ‚Ðµ Ð´Ð»Ñ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°
  document.addEventListener('click', function(e) {
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ ÐºÐ»Ð¸Ðº Ð±Ñ‹Ð» Ð½Ð° VSL Ð²Ð¸Ð´ÐµÐ¾ Ð¸Ð»Ð¸ ÐµÐ³Ð¾ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ðµ, Ð½Ð¾ Ð½Ðµ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÐ°Ñ… Ð·Ð²ÑƒÐºÐ°
    if (e.target && e.target.closest('.vsl-bubble') && 
        !e.target.closest('.vsl-sound-btn') && 
        e.target.id !== 'vslMuteBtn' && 
        e.target.id !== 'vslPlayBtnSimple') {
      // console.log('ðŸŽ¬ VSL bubble clicked!');
      e.preventDefault();
      e.stopPropagation();
      
      // ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ ReturnPopup Ñ VSL
      // console.log('ðŸŽ¬ Trying to show return popup');
      // console.log('ðŸŽ¬ window.showReturnPopup exists:', !!window.showReturnPopup);
      if (window.showReturnPopup) {
        window.showReturnPopup();
      } else {
        // console.error('âŒ window.showReturnPopup is not defined!');
      }
    }
    
    // Ð‘Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾ÐºÐ°Ð· Ð´Ð¾Ð¼Ð¾Ð½ÐµÑ‚ÐºÐ¸ Ð¿Ñ€Ð¸ ÐºÐ»Ð¸ÐºÐµ Ð²Ð½Ðµ Ð²Ð¸Ð´ÐµÐ¾, ÐºÐ¾Ð³Ð´Ð° Ð²Ð¸Ð´ÐµÐ¾ Ð¸Ð³Ñ€Ð°ÐµÑ‚ Ð¸ Ð½ÐµÑ‚ Ð¿Ð¾Ð¿Ð°Ð¿Ð¾Ð²
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ ÐºÐ»Ð¸Ðº ÐÐ• Ð½Ð° Ð²Ð¸Ð´ÐµÐ¾ Ð¸ ÐÐ• Ð½Ð° Ð¿Ð¾Ð¿Ð°Ð¿Ð°Ñ…
    if (!e.target.closest('.vsl-bubble') && 
        !e.target.closest('.return-popup-backdrop') && 
        !e.target.closest('.return-visit-popup-backdrop') && 
        !e.target.closest('.vsl-exit-popup') && 
        !e.target.closest('.pwa-modal') && 
        !e.target.closest('.domonetka-form')) {
      
      // Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ðµ Ð²Ð¸Ð´ÐµÐ¾ Ð² Ñ‡Ð°Ñ‚Ðµ Ð¸ Ð½ÐµÑ‚ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ð¿Ð¾Ð¿Ð°Ð¿Ð¾Ð², Ð±Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾ÐºÐ°Ð· Ð´Ð¾Ð¼Ð¾Ð½ÐµÑ‚ÐºÐ¸
      const chatVideo = document.getElementById('vslVideoInline');
      const returnPopup = document.getElementById('returnPopup');
      const returnVisitPopup = document.getElementById('returnVisitPopup');
      const vslExitPopup = document.getElementById('vslExitPopup');
      const orderFormModal = document.getElementById('orderFormModal');
      const callBookingModal = document.getElementById('callBookingModal');
      const domonetkaForm = document.getElementById('domonetkaForm');
      
      if (chatVideo && !chatVideo.paused && 
          (!returnPopup || returnPopup.style.display === 'none') &&
          (!returnVisitPopup || returnVisitPopup.style.display === 'none') &&
          (!vslExitPopup || vslExitPopup.style.display === 'none') &&
          (!orderFormModal || orderFormModal.style.display === 'none') &&
          (!callBookingModal || callBookingModal.style.display === 'none') &&
          (!domonetkaForm || domonetkaForm.style.display === 'none')) {
        
        // Ð‘Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾ÐºÐ°Ð· Ð´Ð¾Ð¼Ð¾Ð½ÐµÑ‚ÐºÐ¸ Ð¿Ñ€Ð¸ ÐºÐ»Ð¸ÐºÐµ Ð²Ð½Ðµ Ð²Ð¸Ð´ÐµÐ¾
        e.stopPropagation();
        e.preventDefault();
        // console.log('ðŸš« Blocked domonetka form from showing on click outside video');
        return false;
      }
    }
  }, true); // Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ capture: true Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÑ…Ð²Ð°Ñ‚Ð° ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ñ€Ð°Ð½ÑŒÑˆÐµ Ð´Ñ€ÑƒÐ³Ð¸Ñ… Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð²

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº click Ð´Ð»Ñ Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²
  document.addEventListener('click', function(e) {
    if (e.target && (e.target.closest('.vsl-sound-btn') || e.target.id === 'vslPlayBtnSimple')) {
      e.preventDefault();
      e.stopPropagation();
      
      // ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ð»ÐµÐµÑ€
      showFullscreenPlayer();
    }
    
    // ÐšÐ½Ð¾Ð¿ÐºÐ° Ð²Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð·Ð²ÑƒÐºÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ°Ðº Ñ€Ð°Ð½ÑŒÑˆÐµ
    if (e.target && e.target.id === 'vslMuteBtn') {
      e.preventDefault();
      e.stopPropagation();
      toggleVslSound();
    }
  });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº touchstart Ð´Ð»Ñ VSL Ð² Ñ‡Ð°Ñ‚Ðµ Ð´Ð»Ñ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð°
  document.addEventListener('touchstart', function(e) {
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ ÐºÐ»Ð¸Ðº Ð±Ñ‹Ð» Ð½Ð° VSL Ð²Ð¸Ð´ÐµÐ¾ Ð¸Ð»Ð¸ ÐµÐ³Ð¾ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ðµ, Ð½Ð¾ Ð½Ðµ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÐ°Ñ… Ð·Ð²ÑƒÐºÐ°
    if (e.target && e.target.closest('.vsl-bubble') && 
        !e.target.closest('.vsl-sound-btn') && 
        e.target.id !== 'vslMuteBtn' && 
        e.target.id !== 'vslPlayBtnSimple') {
      e.preventDefault();
      e.stopPropagation();
      
      // ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ ReturnPopup Ñ VSL
      if (window.showReturnPopup) {
        window.showReturnPopup();
      }
    }
  });

  // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð·Ð²ÑƒÐºÐ° VSL
  document.addEventListener('DOMContentLoaded', function() {
    const muteBtn = document.getElementById('vslMuteBtn');
    
    if (muteBtn) {
      muteBtn.addEventListener('mousedown', function(e) {
        e.preventDefault();
        e.stopPropagation();
        toggleVslSound();
      });
      
      muteBtn.addEventListener('touchstart', function(e) {
        e.preventDefault();
        e.stopPropagation();
        toggleVslSound();
      });
    }
  });

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¸ Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ VSL Ð² Ñ‡Ð°Ñ‚Ðµ
  function startChatVsl() {
    const video = document.getElementById('vslVideoInline');
    if (video) {
      // Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð²Ð¸Ð´ÐµÐ¾, ÐµÑÐ»Ð¸ Ð¾Ð½Ð¾ Ð½Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð¾
      if (video.readyState === 0) {
        video.load();
      }
      
      // Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð²Ð¸Ð´ÐµÐ¾ Ñ Ð¾Ð±Ñ…Ð¾Ð´Ð¾Ð¼ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸
      startChatVslWithBypass(video);
    } else {
      // console.error('âŒ Video element not found in startChatVsl');
    }
  }

  // Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹
  document.addEventListener('DOMContentLoaded', function() {
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ðµ Ð»Ð¸ ÑÑ‚Ð¾ Ð¿Ð¾ÑÐµÑ‰ÐµÐ½Ð¸Ðµ
    const hasVisitedBefore = localStorage.getItem('hasVisitedBefore');
    const savedVideoTime = localStorage.getItem('savedVideoTime');
    
    if (hasVisitedBefore && savedVideoTime !== null) {
      // console.log('âœ… Return visit detected, hasVisitedBefore:', hasVisitedBefore, 'savedVideoTime:', savedVideoTime);
      // console.log('ðŸ” All localStorage keys:', Object.keys(localStorage));
      // console.log('ðŸ” savedVideoTime value:', localStorage.getItem('savedVideoTime'));
      
      // Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ñ‹Ð¹ VSL Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
      setTimeout(function() {
        // console.log('ðŸŽ¬ Opening fullscreen VSL with saved time:', savedVideoTime);
        if (window.showFullscreenPlayer) {
          window.showFullscreenPlayer();
        }
      }, 1000); // Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° 1 ÑÐµÐºÑƒÐ½Ð´Ð° Ð´Ð»Ñ VSL
      
      // Ð—Ð°Ñ‚ÐµÐ¼ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ñ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸ÐµÐ¼ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€
      setTimeout(function() {
        // console.log('ðŸŽ¬ Attempting to show return visit popup after 2 seconds');
        // Ð–Ð´ÐµÐ¼, Ð¿Ð¾ÐºÐ° Ð²ÑÐµ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Ð·Ð°Ð³Ñ€ÑƒÐ·ÑÑ‚ÑÑ
        let attempts = 0;
        const maxAttempts = 10;
        
        function tryShowPopup() {
          attempts++;
          // console.log('ðŸŽ¬ Attempt', attempts, 'to show return visit popup');
          if (window.showReturnVisitPopup) {
            // console.log('âœ… showReturnVisitPopup function found, calling it');
            window.showReturnVisitPopup();
          } else if (attempts < maxAttempts) {
            // console.log('â³ showReturnVisitPopup not found, waiting 500ms...');
            setTimeout(tryShowPopup, 500);
          } else {
            // console.log('âŒ Failed to find showReturnVisitPopup after', maxAttempts, 'attempts');
          }
        }
        
        tryShowPopup();
      }, 2000); // Ð—Ð°Ð´ÐµÑ€Ð¶ÐºÐ° 2 ÑÐµÐºÑƒÐ½Ð´Ñ‹ Ð´Ð»Ñ Ð¿Ð¾Ð¿Ð°Ð¿Ð°
    } else {
      // ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ð²Ð¸Ð·Ð¸Ñ‚ - Ð·Ð°Ð¿Ð¾Ð¼Ð¸Ð½Ð°ÐµÐ¼
      localStorage.setItem('hasVisitedBefore', 'true');
    }
    
    // Ð–Ð´ÐµÐ¼, Ð¿Ð¾ÐºÐ° ReturnPopup Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑÑ Ð¸ ÑÐ¾Ð·Ð´Ð°ÑÑ‚ Ð²Ð¸Ð´ÐµÐ¾
    setTimeout(function() {
      const popupVideo = document.getElementById('returnVslVideo');
      if (popupVideo) {
        // console.log('âœ… Found returnVslVideo element, setting up popup');
        // console.log('Video id:', popupVideo.id);
        // console.log('Video src:', popupVideo.src);
        // console.log('Video currentTime:', popupVideo.currentTime);
        // console.log('Video readyState:', popupVideo.readyState);
        // console.log('Video paused:', popupVideo.paused);
        // console.log('Video duration:', popupVideo.duration);
        setupVslTimePopup(popupVideo);
      } else {
        // console.log('âš ï¸ returnVslVideo not found yet, will try again when popup opens');
      }
    }, 1000);
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð²ÑÐµ Ð²Ð¸Ð´ÐµÐ¾ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ
    const allVideos = document.querySelectorAll('video');
    // console.log('ðŸ“¹ Found video elements:', allVideos.length);
    allVideos.forEach((v, index) => {
      // console.log(`Video ${index + 1}:`, {
      //   id: v.id,
      //   src: v.src,
      //   preload: v.preload,
      //   autoplay: v.autoplay,
      //   muted: v.muted,
      //   currentTime: v.currentTime,
      //   readyState: v.readyState,
      //   paused: v.paused,
      //   duration: v.duration
      // });
    });
    
    // Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‡ÐµÑ€ÐµÐ· 3 ÑÐµÐºÑƒÐ½Ð´Ñ‹
    setTimeout(function() {
      // console.log('ðŸ”„ 3 seconds later - checking vslVideoInline again:');
      const videoAgain = document.getElementById('vslVideoInline');
      if (videoAgain) {
        // console.log('Video currentTime:', videoAgain.currentTime);
        // console.log('Video readyState:', videoAgain.readyState);
        // console.log('Video paused:', videoAgain.paused);
      }
    }, 3000);
  });

  function stopChatVsl() {
    const video = document.getElementById('vslVideoInline');
    if (video) {
      video.pause();
    }
  }

        // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð² Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ VSL
  function setupVslTimePopup(video) {
    // console.log('ðŸŽ¬ setupVslTimePopup called for video:', video.id);
    // console.log('ðŸŽ¬ Video readyState:', video.readyState);
    // console.log('ðŸŽ¬ Video duration:', video.duration);
    // console.log('ðŸŽ¬ Video paused:', video.paused);
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ð³Ð¾Ñ‚Ð¾Ð²Ð¾ Ð»Ð¸ Ð²Ð¸Ð´ÐµÐ¾
    if (video.readyState < 1 || isNaN(video.duration)) {
      // console.log('ðŸŽ¬ Video not ready, waiting for metadata...');
      video.addEventListener('loadedmetadata', function() {
        // console.log('ðŸŽ¬ Video metadata loaded, setting up popup now');
        setupVslTimePopupInternal(video);
      });
      return;
    }
    
    setupVslTimePopupInternal(video);
  }
  
  function setupVslTimePopupInternal(video) {
    let popupShown = false;
    let messageShown = false;
    
    // Ð§Ð¸Ñ‚Ð°ÐµÐ¼ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð¸Ð· data-Ð°Ñ‚Ñ€Ð¸Ð±ÑƒÑ‚Ð¾Ð² Ð¸Ð»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
    const startTime = parseInt(video.dataset.popupStart) || 773; // Ð˜Ð·Ð¼ÐµÐ½Ð¸Ð»Ð¸ Ñ 893 Ð½Ð° 773
    const endTime = parseInt(video.dataset.popupEnd) || 1100;
    const messageTime = 593; // Ð—Ð° 3 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ Ð´Ð¾ Ð¿Ð¾Ð¿Ð°Ð¿Ð° (773 - 180 = 593)
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ Ð²Ñ€ÐµÐ¼Ñ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð·Ð° 3 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ Ð´Ð¾ Ð¿Ð¾Ð¿Ð°Ð¿Ð°
    const expectedMessageTime = startTime - 180; // 3 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ = 180 ÑÐµÐºÑƒÐ½Ð´ (773 - 180 = 593)
    if (messageTime !== expectedMessageTime) {
      // console.warn('âš ï¸ Message time mismatch! Expected:', expectedMessageTime, 'Got:', messageTime);
    }
    

    
    // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð¸ Ð¿Ð¾ÐºÐ°Ð·Ð° Ð¿Ð¾Ð¿Ð°Ð¿Ð°/ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ
    function checkTimeAndShowPopup() {
      const currentTime = video.currentTime;
      
      // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ñ Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸ÐµÐ¼ Ð·Ð° 3 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹ Ð´Ð¾ Ð¿Ð¾Ð¿Ð°Ð¿Ð°
      if (!messageShown && currentTime >= messageTime) {
        // console.log('ðŸ’¬ Showing auto message at time:', Math.floor(currentTime));
        if (window.showAutoMessage) {
          window.showAutoMessage();
        }
        messageShown = true;
      }
      
      // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ ÐµÑÐ»Ð¸ Ð²Ñ€ÐµÐ¼Ñ Ð² Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ðµ Ð¸ Ð¿Ð¾Ð¿Ð°Ð¿ ÐµÑ‰Ðµ Ð½Ðµ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ð»ÑÑ
      if (!popupShown && currentTime >= startTime && currentTime <= endTime) {
        // console.log('ðŸŽ¯ Showing VSL popup at time:', Math.floor(currentTime));
        showVslMidPopup();
        popupShown = true;
      }
    }
    
    // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾
    video.addEventListener('timeupdate', function() {
      checkTimeAndShowPopup();
    });
    
    // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ¼Ð¾Ñ‚ÐºÐ¸ Ð²Ð¸Ð´ÐµÐ¾ (ÐºÐ¾Ð³Ð´Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¿ÐµÑ€ÐµÐ¼Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚)
    video.addEventListener('seeked', function() {
      checkTimeAndShowPopup();
    });
    
    // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ (ÐºÐ¾Ð³Ð´Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÐºÐ»Ð¸ÐºÐ°ÐµÑ‚ Ð½Ð° Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ-Ð±Ð°Ñ€)
    video.addEventListener('seeking', function() {
      // ÐŸÑƒÑÑ‚Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº
    });
    
    // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¼ÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ñ…
    video.addEventListener('loadedmetadata', function() {
      checkTimeAndShowPopup();
    });
    
    // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚Ð¸ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ
                  video.addEventListener('canplay', function() {
                checkTimeAndShowPopup();
              });

              // ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ñ„Ð¾Ñ€Ð¼Ñƒ Ð·Ð°ÐºÐ°Ð·Ð° ÐºÐ¾Ð³Ð´Ð° Ð²Ð¸Ð´ÐµÐ¾ Ð·Ð°ÐºÐ¾Ð½Ñ‡Ð¸Ð»Ð¾ÑÑŒ
              video.addEventListener('ended', function() {
                // console.log('ðŸŽ¬ Video ended, showing order form');
                if (window.showOrderFormModal) {
                  window.showOrderFormModal();
                }
              });
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÑÑ€Ð°Ð·Ñƒ Ð¿Ñ€Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐµ, ÐµÑÐ»Ð¸ Ð²Ð¸Ð´ÐµÐ¾ ÑƒÐ¶Ðµ Ð² Ð½ÑƒÐ¶Ð½Ð¾Ð¼ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ðµ
    if (video.readyState >= 1) { // HAVE_METADATA Ð¸Ð»Ð¸ Ð±Ð¾Ð»ÑŒÑˆÐµ
      checkTimeAndShowPopup();
    }
    
    // Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ°Ð¶Ð´Ñ‹Ðµ 1 ÑÐµÐºÑƒÐ½Ð´Ñƒ
    setInterval(function() {
      const currentTime = video.currentTime;
      
      if (video.readyState >= 1) {
        if (currentTime >= startTime && currentTime <= endTime && !popupShown) {
          showVslMidPopup();
          popupShown = true;
        }
      }
    }, 1000);
  }

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿Ð¾ÐºÐ°Ð·Ð° Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð½Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¹ Ð¼Ð¸Ð½ÑƒÑ‚Ðµ
  function showVslMidPopup() {
    // console.log('ðŸŽ¯ showVslMidPopup called');
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÐºÐ°ÐºÐ¾Ðµ Ð²Ð¸Ð´ÐµÐ¾ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÑÑ
    const returnVideo = document.getElementById('returnVslVideo');
    const returnVisitVideo = document.getElementById('returnVisitVideo');
    const chatVideo = document.getElementById('vslVideoInline');
    const fullscreenVideo = document.getElementById('fullscreenVideo');
    
    // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÐºÐ°ÐºÐ¾Ð¹ Ð¿Ð¾Ð¿Ð°Ð¿ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚
    const returnPopup = document.getElementById('returnPopup');
    const returnVisitPopup = document.getElementById('returnVisitPopup');
    const fullscreenPlayer = document.getElementById('fullscreenPlayer');
    
    // console.log('ðŸŽ¯ returnPopup display:', returnPopup ? returnPopup.style.display : 'not found');
    // console.log('ðŸŽ¯ returnVisitPopup display:', returnVisitPopup ? returnVisitPopup.style.display : 'not found');
    // console.log('ðŸŽ¯ returnVideo paused:', returnVideo ? returnVideo.paused : 'not found');
    // console.log('ðŸŽ¯ returnVisitVideo paused:', returnVisitVideo ? returnVisitVideo.paused : 'not found');
    
    if (returnPopup && returnPopup.style.display === 'flex' && returnVideo) {
      // Ð•ÑÐ»Ð¸ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ ReturnPopup
      // console.log('ðŸŽ¯ Showing popup in ReturnPopup');
      if (window.showReturnVslMidPopup) {
        window.showReturnVslMidPopup();
      } else {
        // console.error('âŒ showReturnVslMidPopup is not defined!');
      }
    } else if (returnVisitPopup && returnVisitPopup.style.display === 'flex' && returnVisitVideo) {
      // Ð•ÑÐ»Ð¸ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ ReturnVisitPopup
      // console.log('ðŸŽ¯ Showing popup in ReturnVisitPopup');
      if (window.showReturnVisitVslMidPopup) {
        window.showReturnVisitVslMidPopup();
      } else {
        // console.error('âŒ showReturnVisitVslMidPopup is not defined!');
      }
    } else if (fullscreenPlayer && fullscreenPlayer.style.display === 'flex' && fullscreenVideo) {
      // Ð•ÑÐ»Ð¸ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ð»ÐµÐµÑ€
      // console.log('ðŸŽ¯ Showing popup in fullscreen player');
      if (window.showFullscreenVslMidPopup) {
        window.showFullscreenVslMidPopup();
      } else {
        // console.error('âŒ showFullscreenVslMidPopup is not defined!');
      }
    } else if (chatVideo && !chatVideo.paused) {
      // Ð•ÑÐ»Ð¸ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÑÑ Ð²Ð¸Ð´ÐµÐ¾ Ð² Ñ‡Ð°Ñ‚Ðµ
      // console.log('ðŸŽ¯ Showing popup in chat');
      const popup = document.getElementById('vslMidPopup');
      if (popup) {
        popup.style.display = 'block';
        popup.style.opacity = '1';
        popup.style.visibility = 'visible';
        popup.style.zIndex = '1000';
        
        const banner = popup.querySelector('.vsl-mid-banner');
        if (banner) {
          banner.style.zIndex = '1001';
        }
      }
    } else {
      // console.log('âš ï¸ No suitable popup found to show green banner');
    }
  }

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð² VSL ÐºÐ½Ð¾Ð¿ÐºÐ¸
  function setupVslButtonHandlers() {
    const vslPlayBtn = document.querySelector('.vsl-play-btn');
    const muteBtn = document.getElementById('vslMuteBtn');
    
    if (vslPlayBtn) {
      // Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸
      vslPlayBtn.replaceWith(vslPlayBtn.cloneNode(true));
      
      // ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð½Ð¾Ð²ÑƒÑŽ ÑÑÑ‹Ð»ÐºÑƒ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ
      const newVslPlayBtn = document.querySelector('.vsl-play-btn');
      
      if (newVslPlayBtn) {
        newVslPlayBtn.addEventListener('mousedown', function(e) {
          e.preventDefault();
          e.stopPropagation();
          toggleVslSound();
        });
        
        newVslPlayBtn.addEventListener('touchstart', function(e) {
          e.preventDefault();
          e.stopPropagation();
          toggleVslSound();
        });
      }
    }
    
    if (muteBtn) {
      muteBtn.addEventListener('mousedown', function(e) {
        e.preventDefault();
        e.stopPropagation();
        toggleVslSound();
      });
      
      muteBtn.addEventListener('touchstart', function(e) {
        e.preventDefault();
        e.stopPropagation();
        toggleVslSound();
      });
    }
  }



  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÐºÐ»Ð°Ð²Ð¸ÑˆÐ¸ Escape
  document.addEventListener('keydown', async (e) => {
    if (e.key === 'Escape') {
      // ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, ÐºÐ°ÐºÐ°Ñ Ñ„Ð¾Ñ€Ð¼Ð° Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð°
      const orderFormModal = document.getElementById('orderFormModal');
      const callBookingModal = document.getElementById('callBookingModal');
      
      if (orderFormModal && orderFormModal.style.display === 'flex') {
        // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ Ñ„Ð¾Ñ€Ð¼Ñ‹ Ð·Ð°ÐºÐ°Ð·Ð° Ñ‡ÐµÑ€ÐµÐ· Escape
        if (savedFormData.name && savedFormData.phone) {
          const leadData = {
            name: savedFormData.name,
            phone: savedFormData.phone,
            callTime: 'Ð¤Ð¾Ñ€Ð¼Ð° Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð° Ñ‡ÐµÑ€ÐµÐ· Escape',
            timestamp: new Date().toISOString(),
            reason: 'order_form_escape_closed',
            videoWatchTime: savedFormData.videoWatchTime || 0,
            userAgent: navigator.userAgent
          };
          
          try {
            // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸ (Ð·Ð°Ð¼ÐµÐ½Ð° API)
            logLeadData(leadData, 'form_interaction');
            // console.log('Order form closed via Escape - data sent');
          } catch (error) {
            // console.error('Error sending order form escape data:', error);
          }
        }
        
        // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ñ Ñ„Ð¾Ñ€Ð¼Ñ‹
        if (window.showFormReturnPopup) {
          window.showFormReturnPopup();
        }
      } else if (callBookingModal && callBookingModal.style.display === 'flex') {
        // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ Ñ„Ð¾Ñ€Ð¼Ñ‹ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ñ‡ÐµÑ€ÐµÐ· Escape
        if (savedFormData.name && savedFormData.phone) {
          const callTimeElement = document.getElementById('callTime');
          const callTime = callTimeElement ? callTimeElement.value : 'ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð¾';
          
          const leadData = {
            name: savedFormData.name,
            phone: savedFormData.phone,
            callTime: callTime,
            timestamp: new Date().toISOString(),
            reason: 'call_booking_escape_closed',
            videoWatchTime: savedFormData.videoWatchTime || 0,
            userAgent: navigator.userAgent
          };
          
          try {
            // Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸ (Ð·Ð°Ð¼ÐµÐ½Ð° API)
            logLeadData(leadData, 'form_interaction');
            // console.log('Call booking form closed via Escape - data sent');
          } catch (error) {
            // console.error('Error sending call booking escape data:', error);
          }
        }
        
        // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
        if (window.showTimeSelectionPopup) {
          window.showTimeSelectionPopup();
        }
      }
    }
  });



  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¾Ð±Ñ…Ð¾Ð´Ð° Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ Ð°Ð²Ñ‚Ð¾Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð² Ñ‡Ð°Ñ‚Ðµ
  function startChatVslWithBypass(video) {
    if (!video) return;
    
    // Ð¡Ñ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ 1: ÐŸÑ€Ð¾Ð±ÑƒÐµÐ¼ Ñ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ñ‹Ð¼ Ð·Ð²ÑƒÐºÐ¾Ð¼ (Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð² Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð½ÑÑ‚Ð²Ðµ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð¾Ð²)
    video.muted = true;
    video.play().then(() => {
      // console.log('âœ… Chat VSL started playing (muted)');
      // Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð·Ð²ÑƒÐº ÑÑ€Ð°Ð·Ñƒ
      video.muted = false;
      // console.log('ðŸ”Š Chat VSL sound enabled immediately');
      
      // ÐÐ°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð²Ð¸Ð´ÐµÐ¾
      setTimeout(() => {
        if (window.setupVslButtonHandlers) {
          window.setupVslButtonHandlers();
        }
      }, 100);
      
      // Ð¢Ð°ÐºÐ¶Ðµ Ð½Ð°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ ÑÑ€Ð°Ð·Ñƒ
      if (window.setupVslButtonHandlers) {
        window.setupVslButtonHandlers();
      }
      
      // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð´Ð»Ñ Ð¿Ð¾ÐºÐ°Ð·Ð° Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð½Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¹ Ð¼Ð¸Ð½ÑƒÑ‚Ðµ
      setupVslTimePopup(video);
    }).catch((error) => {
      // console.log('âŒ Chat VSL muted autoplay failed:', error.name);
      
      // Ð¡Ñ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ 2: ÐŸÑ€Ð¾Ð±ÑƒÐµÐ¼ Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹
      setTimeout(() => {
        video.muted = true;
        video.play().then(() => {
          // console.log('âœ… Chat VSL started playing (delayed muted)');
          // Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð·Ð²ÑƒÐº ÑÑ€Ð°Ð·Ñƒ
          video.muted = false;
          // console.log('ðŸ”Š Chat VSL sound enabled immediately (delayed)');
          
          // ÐÐ°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸
          if (window.setupVslButtonHandlers) {
            window.setupVslButtonHandlers();
          }
          setupVslTimePopup(video);
        }).catch((error2) => {
          // console.log('âŒ Chat VSL delayed autoplay failed:', error2.name);
          
          // Ð¡Ñ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ 3: Ð–Ð´ÐµÐ¼ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
          setupChatVslUserInteraction(video);
        });
      }, 500);
    });
  }

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ñ‡Ð°Ñ‚ VSL Ð¿Ð¾ÑÐ»Ðµ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
  function setupChatVslUserInteraction(video) {
    let hasUserInteracted = false;
    
    // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð½ÐµÐ²Ð¸Ð´Ð¸Ð¼ÑƒÑŽ ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ
    const playButton = document.createElement('div');
    playButton.style.cssText = `
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: transparent;
      cursor: pointer;
      z-index: 1000;
    `;
    playButton.innerHTML = `
      <div style="
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 20px 40px;
        border-radius: 10px;
        font-size: 18px;
        text-align: center;
        pointer-events: none;
      ">
        â–¶ï¸ ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ
      </div>
    `;
    
    const videoContainer = document.querySelector('.vsl-thumb');
    if (videoContainer) {
      videoContainer.appendChild(playButton);
    }
    
    playButton.onclick = () => {
      if (!hasUserInteracted) {
        hasUserInteracted = true;
        playButton.remove();
        video.muted = false;
        video.play().then(() => {
          // console.log('âœ… Chat VSL started after user interaction');
          
          // ÐÐ°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸
          if (window.setupVslButtonHandlers) {
            window.setupVslButtonHandlers();
          }
          setupVslTimePopup(video);
        }).catch((error) => {
          // console.error('âŒ Failed to play chat VSL after interaction:', error);
        });
      }
    };
    
    // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð´Ð»Ñ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ñ… Ñ‚Ð¸Ð¿Ð¾Ð² Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ
    const interactionEvents = ['click', 'touchstart', 'keydown', 'mousedown'];
    interactionEvents.forEach(event => {
      playButton.addEventListener(event, () => {
        if (!hasUserInteracted) {
          hasUserInteracted = true;
          playButton.remove();
          video.muted = false;
          video.play().then(() => {
            // console.log('âœ… Chat VSL started after user interaction');
            
            // ÐÐ°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸
            if (window.setupVslButtonHandlers) {
              window.setupVslButtonHandlers();
            }
            setupVslTimePopup(video);
          }).catch((error) => {
            // console.error('âŒ Failed to play chat VSL after interaction:', error);
          });
        }
      });
    });
  }

  // Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð°Ñ Ð´ÐµÑ‚ÐµÐºÑ†Ð¸Ñ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð´Ð»Ñ Ð¾Ð±Ñ…Ð¾Ð´Ð° Ð°Ð²Ñ‚Ð¾Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ñ
  let hasUserInteracted = false;
  
  function markUserInteraction() {
    if (!hasUserInteracted) {
      hasUserInteracted = true;
      // console.log('ðŸ‘† User interaction detected - autoplay should work now');
      
      // Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð²ÑÐµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð¿Ð¾ÑÐ»Ðµ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ
      document.removeEventListener('click', markUserInteraction);
      document.removeEventListener('touchstart', markUserInteraction);
      document.removeEventListener('keydown', markUserInteraction);
      document.removeEventListener('mousedown', markUserInteraction);
    }
  }
  
  // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð´Ð»Ñ Ð´ÐµÑ‚ÐµÐºÑ†Ð¸Ð¸ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ
  document.addEventListener('click', markUserInteraction, { once: true });
  document.addEventListener('touchstart', markUserInteraction, { once: true });
  document.addEventListener('keydown', markUserInteraction, { once: true });
  document.addEventListener('mousedown', markUserInteraction, { once: true });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¿Ð»ÐµÐµÑ€Ð°
  document.addEventListener('DOMContentLoaded', function() {
    const fullscreenCloseBtn = document.getElementById('fullscreenCloseBtn');
    const fullscreenPlayer = document.getElementById('fullscreenPlayer');
    const fullscreenVideo = document.getElementById('fullscreenVideo');
    
    if (fullscreenCloseBtn) {
      fullscreenCloseBtn.addEventListener('click', function() {
        // ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿ Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð¾Ð¼ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ Ð²Ð¼ÐµÑÑ‚Ð¾ Ð¿Ñ€ÑÐ¼Ð¾Ð³Ð¾ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ
        showVslCloseChoicePopup();
      });
    }
    
    // Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ Ð¿Ð¾ ÐºÐ»Ð¸ÐºÑƒ Ð½Ð° Ñ„Ð¾Ð½
    if (fullscreenPlayer) {
      fullscreenPlayer.addEventListener('click', function(e) {
        if (e.target === fullscreenPlayer) {
          hideFullscreenPlayer();
        }
      });
    }
    
    // Ð Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐ¼Ð¾Ñ‚ÐºÑƒ Ð² Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð¼ Ð¿Ð»ÐµÐµÑ€Ðµ
    if (fullscreenVideo) {
      // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ controls Ð´Ð»Ñ Ð²ÑÐµÑ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²
      fullscreenVideo.controls = true;
      fullscreenVideo.setAttribute('controlsList', 'nodownload nofullscreen noremoteplayback');
      
      // console.log('âœ… Video seeking enabled for fullscreenVideo');
    }
  });

  // ÐÐ³Ñ€ÐµÑÑÐ¸Ð²Ð½Ð°Ñ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ñ‹Ñ… Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¾Ðº Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹
  if (!window.imageLoadingBlocked) {
    window.imageLoadingBlocked = true;
    window.loadedImageUrls = new Set();
    
    // ÐŸÐµÑ€ÐµÑ…Ð²Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð²ÑÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð½Ð° Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ
    const originalFetch = window.fetch;
    window.fetch = function(...args) {
      const url = args[0];
      if (typeof url === 'string' && (url.includes('.png') || url.includes('.jpg') || url.includes('.jpeg') || url.includes('.svg'))) {
        if (window.loadedImageUrls.has(url)) {
          return Promise.resolve(new Response());
        }
        window.loadedImageUrls.add(url);
      }
      return originalFetch.apply(this, args);
    };
    
    // Ð‘Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÐ¼ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ñ‹Ñ… Image Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð² Ñ ÑƒÐ¶Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð½Ñ‹Ð¼Ð¸ URL
    const originalImage = window.Image;
    window.Image = function() {
      const img = new originalImage();
      const originalSetSrc = Object.getOwnPropertyDescriptor(HTMLImageElement.prototype, 'src').set;
      
      Object.defineProperty(img, 'src', {
        set: function(value) {
          if (window.loadedImageUrls.has(value)) {
            return;
          }
          window.loadedImageUrls.add(value);
          originalSetSrc.call(this, value);
        },
        get: function() {
          return this.getAttribute('src');
        }
      });
      
      return img;
    };
    
    // Ð—Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÐ¼ Ð²ÑÐµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð² ÐºÐµÑˆ
    const images = document.querySelectorAll('img');
    images.forEach(img => {
      if (img.src) {
        window.loadedImageUrls.add(img.src);
      }
      
      img.addEventListener('load', function() {
        this.style.opacity = '1';
      });
      
      img.addEventListener('error', function() {
        // Silent error handling
      });
    });
  }

  // Export functions to window
  window.openPopup = openPopup;
  window.toggleVslSound = toggleVslSound;
  window.startChatVsl = startChatVsl;
  window.stopChatVsl = stopChatVsl;
  window.setupVslButtonHandlers = setupVslButtonHandlers;
  window.setupVslTimePopup = setupVslTimePopup;
  window.hasUserInteracted = () => hasUserInteracted;
  window.showFullscreenPlayer = showFullscreenPlayer;
  window.hideFullscreenPlayer = hideFullscreenPlayer;
  window.showFullscreenVslMidPopup = showFullscreenVslMidPopup;
  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ Ð´Ð»Ñ ÐºÑ€ÐµÑÑ‚Ð¸ÐºÐ° Ð¸ Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð²Ñ‹Ð±Ð¾Ñ€Ð°
  const vslCloseBtn = document.getElementById('vslCloseBtn');
  const vslRestartBtn = document.getElementById('vslRestartBtn');
  const vslCloseChoicePopup = document.getElementById('vslCloseChoicePopup');
  const continueWatchingChoice = document.getElementById('continueWatchingChoice');
  const returnToChatChoice = document.getElementById('returnToChatChoice');

  vslCloseBtn?.addEventListener('click', () => {
    if (vslCloseChoicePopup) {
      vslCloseChoicePopup.style.display = 'flex';
    }
  });

  // ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ ÑÐ½Ð°Ñ‡Ð°Ð»Ð°"
  vslRestartBtn?.addEventListener('click', () => {
    const video = document.getElementById('vslVideoInline');
    if (video) {
      // Ð¡Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð²Ð¸Ð´ÐµÐ¾ Ð½Ð° Ð½Ð°Ñ‡Ð°Ð»Ð¾
      video.currentTime = 0;
      
      // ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ
      localStorage.removeItem('savedChatVideoTime');
      
      // ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð²Ð¸Ð´ÐµÐ¾ Ñ Ð¾Ð±Ñ…Ð¾Ð´Ð¾Ð¼ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸
      startChatVslWithBypass(video);
      
      // console.log('ðŸ”„ Chat video restarted from beginning');
    }
  });

  continueWatchingChoice?.addEventListener('click', () => {
    if (vslCloseChoicePopup) {
      vslCloseChoicePopup.style.display = 'none';
    }
  });

  returnToChatChoice?.addEventListener('click', () => {
    if (vslCloseChoicePopup) {
      vslCloseChoicePopup.style.display = 'none';
    }
    
    // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ð»ÐµÐµÑ€ ÐµÑÐ»Ð¸ Ð¾Ð½ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚
    const fullscreenPlayer = document.getElementById('fullscreenPlayer');
    if (fullscreenPlayer && fullscreenPlayer.style.display !== 'none') {
      hideFullscreenPlayer();
    }
    
    // ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð²Ð¸Ð´ÐµÐ¾ Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿Ñ‹
    const returnPopup = document.getElementById('returnPopup');
    const returnVisitPopup = document.getElementById('returnVisitPopup');
    const returnVideo = document.getElementById('returnVslVideo');
    const returnVisitVideo = document.getElementById('returnVisitVideo');
    
    // ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð²Ð¸Ð´ÐµÐ¾ Ð² ReturnPopup
    if (returnVideo) {
      returnVideo.pause();
      // console.log('ðŸ›‘ Stopped return video when returning to chat');
    }
    
    // ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð²Ð¸Ð´ÐµÐ¾ Ð² ReturnVisitPopup
    if (returnVisitVideo) {
      returnVisitVideo.pause();
      // console.log('ðŸ›‘ Stopped return visit video when returning to chat');
    }
    
    // Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ð°Ð¿Ñ‹
    if (returnPopup) {
      returnPopup.style.display = 'none';
    }
    
    if (returnVisitPopup) {
      returnVisitPopup.style.display = 'none';
    }
  });

  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¿Ð¾ÐºÐ°Ð·Ð° Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð²Ñ‹Ð±Ð¾Ñ€Ð°
  function showVslCloseChoicePopup() {
    if (vslCloseChoicePopup) {
      vslCloseChoicePopup.style.display = 'flex';
    }
  }



  // Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¿Ð¾ÐºÐ°Ð·Ð° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð± ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¼ Ð·Ð°ÐºÐ°Ð·Ðµ Ð² Ñ‡Ð°Ñ‚Ðµ
  function showSuccessMessageInChat(customerName = '') {
    // console.log('ðŸŽ‰ Showing success message in chat for:', customerName);
    
    const chatContainer = document.querySelector('.chat');
    if (!chatContainer) {
      // console.error('âŒ Chat container not found');
      return;
    }
    
    // ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð·Ð²Ð¾Ð½ÐºÐ°
    const callTimeElement = document.getElementById('callTime');
    let callTimeText = '1-2 Ð¼Ð¸Ð½ÑƒÑ‚Ñ‹'; // Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ
    
    if (callTimeElement && callTimeElement.value) {
      const selectedTime = callTimeElement.value;
      // console.log('ðŸŽ¯ Selected call time:', selectedTime);
      
      if (selectedTime === 'Ahora mismo') {
        callTimeText = '1-2 minutos';
      } else if (selectedTime === '5 minutos') {
        callTimeText = '5 minutos';
      } else if (selectedTime === '15 minutos') {
        callTimeText = '15 minutos';
      } else if (selectedTime === '30 minutos') {
        callTimeText = '30 minutos';
      }
    }
    
    // console.log('ðŸŽ¯ Final call time text:', callTimeText);
    
    // Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾Ð± ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¼ Ð·Ð°ÐºÐ°Ð·Ðµ
    const successMessage = document.createElement('div');
    successMessage.className = 'bubble success-message';
    successMessage.innerHTML = `
      <div class="specialist-image">
        <img src="/support.png" alt="Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸" class="support-img" style="width: 100% !important; height: auto !important; max-width: 100% !important; max-height: 330px !important;" />
      </div>
      <div class="success-content">
        <span class="success-text">${customerName ? customerName + ' ' : ''}Â¡solicitud aceptada! Espera la llamada del especialista en ${callTimeText}</span>
      </div>
    `;
    
    // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð² Ñ‡Ð°Ñ‚
    chatContainer.appendChild(successMessage);
    
    // ÐŸÑ€Ð¾ÐºÑ€ÑƒÑ‡Ð¸Ð²Ð°ÐµÐ¼ Ðº Ð½Ð¾Ð²Ð¾Ð¼Ñƒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸ÑŽ
    setTimeout(() => {
      chatContainer.scrollTop = chatContainer.scrollHeight;
      // console.log('ðŸ“œ Scrolled chat to show success message');
    }, 100);
  }

  window.showVslMidPopup = showVslMidPopup;
  window.showVslCloseChoicePopup = showVslCloseChoicePopup;
  window.showAutoMessage = showAutoMessage;
  window.showSuccessMessageInChat = showSuccessMessageInChat;
  window.savedFormData = savedFormData;
  window.startGlobalTimers = startGlobalTimers;
</script>

<style>
  .container {
    /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð¿ÐµÑ€ÐµÐ½ÐµÑÐµÐ½Ñ‹ Ð² global.css */
  }

  .chat {
    background: #e5ddd5;
    background-image: url('/whatsapp_background.png');
    background-repeat: repeat;
    background-size: auto;
    background-position: center;
    flex: 1;
    padding: 10px 8px 100px;
    position: relative;
    overflow-y: auto;
    overflow-x: hidden;
    min-height: 0; /* Ð’Ð°Ð¶Ð½Ð¾ Ð´Ð»Ñ flex-ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð° */
    height: 100%; /* Ð“Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾Ð»Ð½ÑƒÑŽ Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ */
    scroll-behavior: smooth;
  }

  .bubble {
    background: #fff;
    border-radius: 8px;
    padding: 8px 10px;
    margin: 8px 0;
    max-width: 80%;
    font-size: 14px;
    line-height: 1.35;
    box-shadow: 0 1px 0 rgba(0,0,0,.06);
    position: relative;
  }

  .vsl-bubble {
    max-width: 70%;
    margin: 8px auto;
    padding: 0;
  }

  .bubble::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: -8px;
    width: 0;
    height: 0;
    border: 8px solid transparent;
    border-right-color: #fff;
    border-left: 0;
    border-bottom: 0;
    margin-bottom: 8px;
  }

  .bubble.encryption {
    background: #f5f5dc; /* Ð–ÐµÐ»Ñ‚Ð¾Ð²Ð°Ñ‚Ñ‹Ð¹ Ñ„Ð¾Ð½ ÐºÐ°Ðº Ð² WhatsApp */
    color: #8b7355; /* ÐšÐ¾Ñ€Ð¸Ñ‡Ð½ÐµÐ²Ð°Ñ‚Ñ‹Ð¹ Ñ‚ÐµÐºÑÑ‚ */
    font-size: 12px;
    max-width: 90%;
    margin: 4px auto;
    text-align: center;
    border-radius: 12px;
    padding: 8px 12px;
    box-shadow: none;
    border: none;
    opacity: 1;
  }



  .bubble.encryption::after {
    display: none;
  }

  .bubble.urgent {
    background: #fff;
    color: #000;
    font-weight: 400;
    text-align: left;
  }

  /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð± ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¼ Ð·Ð°ÐºÐ°Ð·Ðµ */
  .bubble.success-message {
    background: #fff;
    border-left: 3px solid #4caf50;
    padding: 8px 10px;
    margin: 8px 0;
    max-width: 80%;
    font-size: 14px;
    line-height: 1.35;
  }

  .specialist-image {
    text-align: center;
    margin-bottom: 8px;
  }

  .bubble.success-message .support-img {
    width: 100% !important;
    height: auto !important;
    border-radius: 4px !important;
    object-fit: cover !important;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
    display: block !important;
    margin: 0 auto !important;
    max-width: 100% !important;
    max-height: 330px !important;
  }

  .success-content {
    text-align: center;
  }

  .success-text {
    color: #333;
    font-size: 14px;
  }

  /* .bubble.problem {
    background: #fff;
    color: #d32f2f;
    font-weight: 600;
  } */

  .vsl-bubble {
    max-width: 100%;
    cursor: pointer;
  }

  .vsl-bubble::after {
    display: none;
  }

  .vsl-card {
    background: #fff;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 16px rgba(0,0,0,.15);
    max-width: 100%;
    cursor: pointer;
    margin: 0;
  }

  .vsl-thumb {
    position: relative;
    display: grid;
    place-items: center;
    height: 500px !important;
    min-height: 500px !important;
    background: #333;
    color: #fff;
    font-weight: 700;
    font-size: 24px;
    overflow: hidden;
  }

  .vsl-video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: absolute;
    top: 0;
    left: 0;
    /* Ð‘Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÐ¼ ÐºÐ»Ð¸ÐºÐ¸ Ð¿Ð¾ Ð²Ð¸Ð´ÐµÐ¾ Ð² Ñ‡Ð°Ñ‚Ðµ */
    pointer-events: none;
  }

  /* Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¾Ð±Ñ€ÐµÐ·Ð°Ð½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾ Ð½Ð° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°Ñ… */
  @media (max-width: 768px) {
    .vsl-video {
      object-fit: contain; /* ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð²Ð¸Ð´ÐµÐ¾ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð±ÐµÐ· Ð¾Ð±Ñ€ÐµÐ·Ð°Ð½Ð¸Ñ */
      background: #000; /* Ð§ÐµÑ€Ð½Ñ‹Ð¹ Ñ„Ð¾Ð½ Ð´Ð»Ñ Ð¿ÑƒÑÑ‚Ñ‹Ñ… Ð¾Ð±Ð»Ð°ÑÑ‚ÐµÐ¹ */
    }
    
    .vsl-thumb {
      height: 300px !important; /* Ð£Ð¼ÐµÐ½ÑŒÑˆÐ°ÐµÐ¼ Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ Ð½Ð° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… */
      min-height: 300px !important;
      max-height: 300px !important; /* Ð¤Ð¸ÐºÑÐ¸Ñ€ÑƒÐµÐ¼ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ */
    }
    
    .vsl-card {
      height: 300px !important; /* Ð¤Ð¸ÐºÑÐ¸Ñ€ÑƒÐµÐ¼ Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ */
      min-height: 300px !important;
      max-height: 300px !important;
    }
  }

  @media (max-width: 480px) {
    .vsl-thumb {
      height: 250px !important; /* Ð•Ñ‰Ðµ Ð¼ÐµÐ½ÑŒÑˆÐµ Ð½Ð° Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ¸Ñ… ÑÐºÑ€Ð°Ð½Ð°Ñ… */
      min-height: 250px !important;
      max-height: 250px !important; /* Ð¤Ð¸ÐºÑÐ¸Ñ€ÑƒÐµÐ¼ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ */
    }
    
    .vsl-card {
      height: 250px !important; /* Ð¤Ð¸ÐºÑÐ¸Ñ€ÑƒÐµÐ¼ Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ */
      min-height: 250px !important;
      max-height: 250px !important;
    }
  }

  .vsl-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 2;
    gap: 15px;
  }

  .vsl-save-text {
    color: white;
    font-size: 14px;
    font-weight: 600;
    text-align: center;
    margin-top: 5px;
  }

  .vsl-placeholder {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1;
  }

  .vsl-play-btn {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    z-index: 2;
    cursor: pointer;
    transition: transform 0.2s ease;
  }

  .vsl-play-btn:hover {
    transform: translate(-50%, -50%) scale(1.1);
  }

  .vsl-play-btn svg {
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
  }

  .speaker-icon {
    font-size: 20px;
  }

  .play-text {
    font-size: 14px;
    font-weight: 600;
  }

  .vsl-info {
    padding: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
  }

  .vsl-title {
    font-weight: 600;
    color: #333;
  }

  .vsl-hint {
    font-size: 12px;
    color: var(--muted);
  }

  .chat-input {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: #f0f0f0;
    padding: 8px 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    border-top: 1px solid #ddd;
    border-radius: 0 0 20px 20px;
    z-index: 100;
    height: 60px; /* Ð¤Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ Ð²Ñ‹ÑÐ¾Ñ‚Ð° */
  }

  .input-btn {
    background: #fff;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #54656f;
    flex-shrink: 0;
    transition: background-color 0.2s;
  }

  .input-btn:hover {
    background: #e9edef;
  }

  .input-field-container {
    flex: 1;
    position: relative;
    display: flex;
    align-items: center;
    background: #fff;
    border-radius: 20px;
    padding: 8px 12px;
    min-height: 40px;
  }

  .chat-input-field {
    flex: 1;
    border: none;
    outline: none;
    background: transparent;
    font-size: 15px;
    color: #111b21;
    padding: 0;
    margin: 0;
  }

  .chat-input-field::placeholder {
    color: #667781;
  }

  .emoji-btn {
    background: none;
    border: none;
    color: #54656f;
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s;
  }

  .emoji-btn:hover {
    background: #e9edef;
  }

  .input-actions {
    display: flex;
    gap: 4px;
    margin-left: 8px;
  }

  .action-btn {
    background: none;
    border: none;
    color: #54656f;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s;
    width: 40px;
    height: 40px;
  }

  .action-btn:hover {
    background: #e9edef;
  }

  .popup-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.65);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 50;
  }

  .popup {
    background: #000;
    border-radius: 12px;
    width: min(900px, 92vw);
    aspect-ratio: 16/9;
    position: relative;
    overflow: hidden;
  }

  .popup video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .popup .close {
    position: absolute;
    top: 8px;
    right: 8px;
    background: rgba(255,255,255,.9);
    border-radius: 999px;
    padding: 6px;
    cursor: pointer;
    border: none;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
  }

  @media (min-width: 500px) {
    .pwa-modal {
      max-width: 420px;
    }
  }



  /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ ÑÐºÐ¸Ð´ÐºÐ¸ */
  .discount-message {
    display: flex;
    align-items: center;
    gap: 12px;
    background: #fff;
    border-radius: 12px;
    padding: 16px;
    margin: 12px 0;
    box-shadow: 0 4px 16px rgba(0,0,0,.1);
    max-width: 90%;
    position: relative;
  }

  .discount-message::after {
    display: none;
  }

  .discount-message .product-image {
    width: 70px;
    height: 90px;
    flex-shrink: 0;
  }

  .discount-message .product-image img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 8px;
  }

  .discount-content {
    flex: 1;
  }

  .discount-text {
    margin: 0 0 12px 0;
    font-size: 14px;
    line-height: 1.4;
    color: #333;
    font-weight: 500;
  }

  .discount-text p {
    margin: 0 0 4px 0;
  }

  .discount-text p:last-child {
    margin-bottom: 0;
  }

  .discount-btn {
    background: #007bff;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.2s;
    width: 100%;
  }

  .discount-btn:hover {
    background: #0056b3;
  }



  .auto-message {
    max-width: 90%;
    margin: 8px 0;
    background: #fff;
    border-radius: 8px;
    padding: 12px;
    box-shadow: 0 1px 0 rgba(0,0,0,.06);
    position: relative;
  }

  .auto-message::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: -8px;
    width: 0;
    height: 0;
    border: 8px solid transparent;
    border-right-color: #fff;
    border-left: 0;
    border-bottom: 0;
  }

  /* PWA Modal Styles */
  .pwa-modal {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    max-width: 420px;
    height: 100%;
    z-index: 10000;
    display: flex;
    align-items: flex-end;
    justify-content: center;
  }

  .pwa-modal-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
  }

  .pwa-modal-content {
    position: relative;
    width: 100%;
    background: #fff;
    border-radius: 20px 20px 0 0;
    box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.3);
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    max-height: 80vh;
    overflow: hidden;
  }

  .pwa-modal.show .pwa-modal-content {
    transform: translateY(0);
  }

  .pwa-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px 8px;
    border-bottom: 1px solid #f0f0f0;
  }

  .pwa-modal-handle {
    width: 40px;
    height: 4px;
    background: #ddd;
    border-radius: 2px;
    margin: 0 auto;
  }

  .pwa-modal-close {
    background: none;
    border: none;
    font-size: 24px;
    color: #666;
    cursor: pointer;
    padding: 4px;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
  }

  .pwa-modal-close:hover {
    background: #f0f0f0;
  }

  .pwa-modal-body {
    padding: 20px;
    overflow-y: auto;
    max-height: calc(80vh - 80px);
  }

  /* Form Styles */
  .form-header {
    text-align: center;
    margin-bottom: 20px;
  }

  .form-title {
    font-size: 20px;
    font-weight: bold;
    color: #333;
    margin: 0;
  }

  .product-image-section {
    text-align: center;
    margin-bottom: 20px;
  }

  .product-image {
    max-width: 200px;
    height: auto;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .timer-section {
    text-align: center;
    margin-bottom: 20px;
  }

  .timer-badge {
    display: inline-block;
    background: linear-gradient(135deg, #ff4444, #ff6666);
    color: white;
    padding: 10px 20px;
    border-radius: 25px;
    font-weight: bold;
    font-size: 18px;
    box-shadow: 0 4px 12px rgba(255, 68, 68, 0.3);
  }

  .order-form-fields {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .field-label {
    font-size: 14px;
    font-weight: 600;
    color: #333;
  }

  .form-input {
    padding: 14px;
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    font-size: 16px;
    transition: all 0.2s;
    background: #fafafa;
  }

  .form-input:focus {
    outline: none;
    border-color: #25d366;
    background: #fff;
    box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
  }

  .submit-btn {
    background: linear-gradient(135deg, #25d366, #128c7e);
    color: white;
    border: none;
    padding: 16px;
    border-radius: 12px;
    font-weight: 600;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
  }

  .submit-btn:hover {
    background: linear-gradient(135deg, #20b358, #0f7a6b);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(37, 211, 102, 0.4);
  }

  .form-disclaimer {
    font-size: 12px;
    color: #666;
    text-align: center;
    line-height: 1.4;
    margin-top: 12px;
    padding: 12px;
    background: #f8f9fa;
    border-radius: 8px;
  }

  /* Call Booking Styles */
  .call-to-action {
    text-align: center;
    margin-bottom: 24px;
  }

  .call-title {
    font-size: 20px;
    font-weight: bold;
    color: #333;
    margin: 0 0 8px 0;
    text-transform: uppercase;
  }

  .call-subtitle {
    font-size: 16px;
    color: #666;
    margin: 0;
  }

  .time-selection {
    margin-bottom: 24px;
  }

  .time-dropdown {
    width: 100%;
    padding: 14px;
    border: 2px solid #90ee90;
    border-radius: 12px;
    font-size: 16px;
    background: #f0f8f0;
    color: #333;
    cursor: pointer;
    appearance: none;
    background-image: url('data:image/svg+xml;utf8,<svg fill="black" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
    background-repeat: no-repeat;
    background-position: right 14px center;
    background-size: 20px;
    box-sizing: border-box;
    transition: all 0.2s;
  }

  .time-dropdown:focus {
    outline: none;
    border-color: #25d366;
    box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
  }

  .call-submit-btn {
    background: linear-gradient(135deg, #4fc3f7, #25d366);
    color: white;
    border: none;
    padding: 16px;
    border-radius: 12px;
    font-weight: 600;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.2s;
    width: 100%;
    margin-bottom: 16px;
    box-shadow: 0 4px 12px rgba(79, 195, 247, 0.3);
  }

  .call-submit-btn:hover {
    background: linear-gradient(135deg, #29b6f6, #20b358);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(79, 195, 247, 0.4);
  }

  .back-btn-chat {
    background: #f0f0f0;
    color: #666;
    border: none;
    padding: 14px;
    border-radius: 12px;
    font-weight: 600;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.2s;
    width: 100%;
  }

  .back-btn-chat:hover {
    background: #e0e0e0;
    transform: translateY(-1px);
  }

  /* Mobile optimizations */
  @media (max-width: 768px) {
    .pwa-modal {
      max-width: 100% !important;
      left: 0 !important;
      right: 0 !important;
      transform: none !important;
      width: 100% !important;
    }
    
    .pwa-modal-content {
      width: 100% !important;
    }
    
    .pwa-modal-body {
      padding: 16px;
    }
    
    .form-title {
      font-size: 18px;
    }
    
    .call-title {
      font-size: 18px;
    }
    
    .time-dropdown {
      width: 100% !important;
      max-width: 100% !important;
      position: relative !important;
      left: 0 !important;
      right: 0 !important;
      transform: none !important;
      margin: 0 !important;
      padding: 14px !important;
      box-sizing: border-box !important;
    }
    
    .time-dropdown option {
      position: relative !important;
      left: 0 !important;
      right: 0 !important;
      transform: none !important;
      width: 100% !important;
      text-align: left !important;
    }
    
    /* ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð²Ñ‹Ð¿Ð°Ð´Ð°ÑŽÑ‰ÐµÐ³Ð¾ ÑÐ¿Ð¸ÑÐºÐ° */
    .pwa-modal-body select {
      width: 100% !important;
      max-width: 100% !important;
      left: 0 !important;
      right: 0 !important;
      transform: none !important;
      position: relative !important;
    }
    
    /* Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð¾Ð¿Ñ†Ð¸Ð¹ Ð²Ñ‹Ð¿Ð°Ð´Ð°ÑŽÑ‰ÐµÐ³Ð¾ ÑÐ¿Ð¸ÑÐºÐ° */
    .pwa-modal-body select option {
      position: relative !important;
      left: 0 !important;
      right: 0 !important;
      transform: none !important;
      width: 100% !important;
      text-align: left !important;
    }
    
    /* Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ */
    .time-selection {
      width: 100% !important;
      max-width: 100% !important;
      position: relative !important;
      left: 0 !important;
      right: 0 !important;
      transform: none !important;
      margin: 0 0 24px 0 !important;
      padding: 0 !important;
      box-sizing: border-box !important;
    }
  }

  .reviews-banner {
    padding: 12px;
    margin: 16px 0 0 0;
  }

  .reviews-text {
    font-size: 14px;
    line-height: 1.2;
  }

  .review-item {
    margin-bottom: 16px;
  }

  .review-images {
    padding: 8px;
    gap: 6px;
  }

  .review-content {
    padding: 10px 12px 12px 12px;
  }

  .review-text {
    font-size: 13px;
    line-height: 1.3;
  }

  .rating-stars {
    font-size: 14px;
  }

  .rating-score {
    font-size: 13px;
  }

  .text-review-item {
    padding: 12px;
    margin-bottom: 12px;
  }

  .reviewer-avatar {
    width: 28px;
    height: 28px;
    font-size: 14px;
  }

  .reviewer-name {
    font-size: 13px;
  }

  .review-title {
    font-size: 15px;
  }

  .review-date {
    font-size: 11px;
  }

  .review-verified {
    font-size: 11px;
  }

  .review-text {
    font-size: 13px;
  }

  .review-helpful {
    font-size: 11px;
  }

  .vsl-play-btn svg {
    width: 60px;
    height: 60px;
  }

  .vsl-save-text {
    font-size: 12px;
  }

  .auto-message-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
  }

  .auto-message .product-image {
    width: 150px;
    height: auto;
    text-align: center;
  }

  .auto-message .product-image img {
    width: 100%;
    height: auto;
    border-radius: 8px;
  }

  .message-text {
    text-align: center;
    font-size: 14px;
    line-height: 1.4;
    color: #333;
    font-weight: 500;
  }



  .message-text p {
    margin: 0 0 4px 0;
  }

  .message-text p:last-child {
    margin-bottom: 0;
  }

  .auto-discount-container {
    max-width: 90%;
    margin: 8px 0;
    text-align: center;
  }

  .auto-discount-btn {
    background: #007bff;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.2s;
    width: 100%;
  }

  .auto-discount-btn:hover {
    background: #0056b3;
  }

  /* ÐŸÐ»Ð°ÑˆÐºÐ° Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð°Ð¼Ð¸ Ð¼ÑƒÐ¶Ñ‡Ð¸Ð½ */
  .reviews-banner {
    background: #90EE90;
    border: 2px solid #000;
    border-radius: 12px;
    padding: 16px;
    margin: 20px 0 0 0;
    text-align: center;
  }

  .reviews-text {
    color: #000;
    font-weight: bold;
    font-family: sans-serif;
    font-size: 16px;
    line-height: 1.3;
    margin: 0;
  }

  .reviews-text br {
    display: block;
    content: "";
    margin: 2px 0;
  }

  /* Ð¡ÐµÐºÑ†Ð¸Ñ Ð¾Ñ‚Ð·Ñ‹Ð²Ð¾Ð² */
  .reviews-section {
    margin: 20px 0 0 0;
  }

  .review-item {
    margin-bottom: 20px;
    background: #fff;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .review-images {
    display: flex;
    gap: 8px;
    padding: 12px;
  }

  .review-images.single {
    justify-content: center;
  }

  .review-image {
    flex: 1;
    max-width: 50%;
  }

  .review-images.single .review-image {
    max-width: 80%;
  }

  .review-image img {
    width: 100%;
    height: auto;
    border-radius: 8px;
    object-fit: cover;
  }

  .review-content {
    padding: 12px 16px 16px 16px;
  }

  .review-text {
    font-size: 14px;
    line-height: 1.4;
    color: #333;
    margin-bottom: 8px;
    font-weight: 500;
  }

  .review-rating {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .rating-stars {
    color: #FFD700;
    font-size: 16px;
  }

  .rating-score {
    font-weight: bold;
    color: #333;
    font-size: 14px;
  }

  /* Ð¢ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ðµ Ð¾Ñ‚Ð·Ñ‹Ð²Ñ‹ */
  .text-reviews-section {
    margin: 20px 0 0 0;
  }

  .text-review-item {
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 16px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .review-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .reviewer-info {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .reviewer-avatar {
    width: 32px;
    height: 32px;
    background: #f0f0f0;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
  }

  .reviewer-name {
    font-weight: 600;
    color: #333;
    font-size: 14px;
  }

  .review-title {
    font-weight: bold;
    color: #333;
    font-size: 16px;
    margin-bottom: 4px;
  }

  .review-date {
    color: #666;
    font-size: 12px;
    margin-bottom: 2px;
  }

  .review-verified {
    color: #ff6b35;
    font-size: 12px;
    font-weight: 600;
    margin-bottom: 8px;
  }

  .review-text {
    color: #333;
    font-size: 14px;
    line-height: 1.4;
    margin-bottom: 8px;
  }

  .review-helpful {
    color: #666;
    font-size: 12px;
    font-style: italic;
  }

  /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð½Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¹ Ð¼Ð¸Ð½ÑƒÑ‚Ðµ VSL */
  .vsl-mid-popup {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10;
    pointer-events: none; /* ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ ÐºÐ»Ð¸ÐºÐ°Ñ‚ÑŒ Ñ‡ÐµÑ€ÐµÐ· Ð¿Ð¾Ð¿Ð°Ð¿ Ð½Ð° Ð²Ð¸Ð´ÐµÐ¾ */
    background: transparent; /* Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð·Ð°Ñ‚ÐµÐ¼Ð½ÐµÐ½Ð¸Ðµ Ð²Ð¸Ð´ÐµÐ¾ */
  }

  .vsl-mid-banner {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    background: #4CAF50; /* ÐœÐµÐ½ÐµÐµ ÑÑ€ÐºÐ¸Ð¹ Ð·ÐµÐ»ÐµÐ½Ñ‹Ð¹ Ñ†Ð²ÐµÑ‚ */
    color: white;
    padding: 15px;
    text-align: center;
    font-weight: bold;
    font-size: 16px;
    z-index: 11;
    pointer-events: auto; /* ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ Ñ Ð±Ð°Ð½Ð½ÐµÑ€Ð¾Ð¼ */
    position: relative;
  }

  .vsl-mid-vignette {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at center, transparent 30%, rgba(0, 0, 0, 0.3) 100%);
    pointer-events: none;
    z-index: 1;
  }

  /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ Ð¿Ñ€ÑÐ¼Ð¾Ð³Ð¾ Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ñ Ð²Ð¸Ð´ÐµÐ¾ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹ - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ReturnPopup */

  /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ Ð·ÐµÐ»ÐµÐ½Ð¾Ð¹ Ð¼Ð¸Ð³Ð°ÑŽÑ‰ÐµÐ¹ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð·Ð²ÑƒÐºÐ° */
  .vsl-sound-btn {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 5;
    cursor: pointer;
  }

  .sound-btn-content {
    background: #4CAF50;
    border: 3px solid #45a049;
    border-radius: 12px;
    padding: 16px 24px;
    box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
    text-align: center;
    min-width: 200px;
    animation: pulse-green 2s infinite;
  }

  .sound-btn-text-top {
    color: white;
    font-weight: 700;
    font-size: 16px;
    margin-bottom: 4px;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
  }

  .sound-btn-text-bottom {
    color: white;
    font-weight: 600;
    font-size: 14px;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
  }

  .vsl-sound-btn:hover .sound-btn-content {
    background: #45a049;
    transform: scale(1.05);
    box-shadow: 0 6px 16px rgba(76, 175, 80, 0.6);
  }

  /* Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸ÑŽ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ð½Ð° Ð½Ðµ Ð²Ð»Ð¸ÑÐ»Ð° Ð½Ð° Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ */
  @keyframes pulse-green {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(1.05);
      opacity: 0.9;
    }
    100% {
      transform: scale(1);
      opacity: 1;
    }
  }

  /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð¿Ñ€Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ VSL */
  .vsl-close-choice-popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
  }

  .vsl-close-choice-content {
    background: white;
    padding: 30px;
    border-radius: 12px;
    text-align: center;
    max-width: 400px;
    width: 90%;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  }

  .vsl-close-choice-content h3 {
    margin: 0 0 10px 0;
    font-size: 24px;
    font-weight: 700;
    color: #d32f2f;
  }

  .vsl-close-choice-subtitle {
    margin: 0 0 20px 0;
    font-size: 16px;
    color: #333;
    line-height: 1.4;
  }

  .vsl-close-choice-buttons {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .vsl-close-choice-buttons .btn-primary {
    background: linear-gradient(135deg, #ff6b35, #ff4444);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s;
  }

  .vsl-close-choice-buttons .btn-primary:hover {
    background: linear-gradient(135deg, #e55a2b, #e53935);
    transform: translateY(-2px);
  }

  .vsl-close-choice-buttons .btn-secondary {
    background: #f5f5f5;
    color: #333;
    border: 2px solid #ddd;
    padding: 12px 20px;
    border-radius: 8px;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s;
  }

  .vsl-close-choice-buttons .btn-secondary:hover {
    background: #e9e9e9;
    border-color: #ccc;
    transform: translateY(-2px);
  }

  /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¿Ð»ÐµÐµÑ€Ð° */
  .fullscreen-player {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: transparent; /* Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð·Ð°Ñ‚ÐµÐ¼Ð½ÐµÐ½Ð¸Ðµ Ð² Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð¼ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ */
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1000;
  }

  .fullscreen-player-content {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent; /* Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð»ÑŽÐ±Ð¾Ð¹ Ñ„Ð¾Ð½ */
  }

  .fullscreen-player video {
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: #000;
  }
  
  /* ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð²ÑÐµ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾ */
  #fullscreenVideo::-webkit-media-controls-play-button,
  #fullscreenVideo::-webkit-media-controls-pause-button,
  #fullscreenVideo::-webkit-media-controls-timeline,
  #fullscreenVideo::-webkit-media-controls-current-time-display,
  #fullscreenVideo::-webkit-media-controls-time-remaining-display,
  #fullscreenVideo::-webkit-media-controls-seek-back-button,
  #fullscreenVideo::-webkit-media-controls-seek-forward-button,
  #fullscreenVideo::-webkit-media-controls-volume-slider,
  #fullscreenVideo::-webkit-media-controls-mute-button {
    display: block !important;
  }
  
  /* ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Firefox */
  #fullscreenVideo::-moz-media-controls-play-button,
  #fullscreenVideo::-moz-media-controls-pause-button,
  #fullscreenVideo::-moz-media-controls-timeline,
  #fullscreenVideo::-moz-media-controls-current-time-display,
  #fullscreenVideo::-moz-media-controls-time-remaining-display,
  #fullscreenVideo::-moz-media-controls-seek-back-button,
  #fullscreenVideo::-moz-media-controls-seek-forward-button,
  #fullscreenVideo::-moz-media-controls-volume-slider,
  #fullscreenVideo::-moz-media-controls-mute-button {
    display: block !important;
  }
  
  /* ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ¼Ð¾Ñ‚ÐºÐ¸ Ð½Ð° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð°Ñ… */
  #fullscreenVideo::-webkit-media-controls-timeline,
  #fullscreenVideo::-webkit-media-controls-seek-back-button,
  #fullscreenVideo::-webkit-media-controls-seek-forward-button {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
    pointer-events: auto !important;
    width: auto !important;
    height: auto !important;
  }
  
  /* Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð´Ð»Ñ iOS Safari */
  #fullscreenVideo::-webkit-media-controls-overlay-play-button {
    display: none !important;
  }
  
  /* ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð²Ð¸Ð´ÐµÐ¾ */
  #fullscreenVideo::-webkit-media-controls-enclosure {
    display: block !important;
  }
  
  /* Ð Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÐ¼ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ñ Ð²Ð¸Ð´ÐµÐ¾ */
  .video-wrapper {
    pointer-events: auto !important;
    position: relative !important;
    width: 100% !important;
    height: 100% !important;
  }
  
  /* Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð´Ð»Ñ Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð² */
  @media (max-width: 768px) {
    #fullscreenVideo {
      /* Ð Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÐ¼ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ñ Ð²Ð¸Ð´ÐµÐ¾ Ð½Ð° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… */
      pointer-events: auto !important;
    }
    
    /* ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð²ÑÐµ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð½Ð° Ð¼Ð¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ñ… */
    #fullscreenVideo::-webkit-media-controls-play-button,
    #fullscreenVideo::-webkit-media-controls-pause-button,
    #fullscreenVideo::-webkit-media-controls-timeline,
    #fullscreenVideo::-webkit-media-controls-current-time-display,
    #fullscreenVideo::-webkit-media-controls-time-remaining-display,
    #fullscreenVideo::-webkit-media-controls-seek-back-button,
    #fullscreenVideo::-webkit-media-controls-seek-forward-button,
    #fullscreenVideo::-webkit-media-controls-volume-slider,
    #fullscreenVideo::-webkit-media-controls-mute-button {
      display: block !important;
      opacity: 1 !important;
      visibility: visible !important;
      pointer-events: auto !important;
    }
    
    .video-wrapper {
      /* Ð Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÐ¼ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ñ Ð²Ð¸Ð´ÐµÐ¾ */
      overflow: visible !important;
      position: relative !important;
    }
  }
  
  /* ÐÐ³Ñ€ÐµÑÑÐ¸Ð²Ð½Ð¾Ðµ ÐºÐµÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹ */
  img {
    image-rendering: optimizeSpeed;
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
    /* ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ ÐºÐµÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ */
    cache-control: max-age=31536000;
    /* ÐŸÑ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÑ€Ð¸ÑÐ¾Ð²ÐºÑƒ */
    will-change: auto;
    transform: translateZ(0);
    backface-visibility: hidden;
    /* Ð‘Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÐ¼ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ */
    pointer-events: none;
  }
  
  /* Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ð´Ð»Ñ Ð¸Ð½Ñ‚ÐµÑ€Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹ */
  .review-image img,
  .product-image {
    pointer-events: auto;
  }
  
  /* ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ð¹ Ð±ÐµÐ· Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸Ð¹ */
  img, img:hover, img:focus, img:active {
    transform: translateZ(0) !important;
  }

  .fullscreen-close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    cursor: pointer;
    z-index: 1010;
    font-size: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .fullscreen-close-btn:hover {
    background: rgba(0, 0, 0, 0.9);
  }

  /* ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ðµ ÑÑ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¿Ð»ÐµÐµÑ€Ð° */
  @media (max-width: 768px) {
    .fullscreen-close-btn {
      top: 10px;
      right: 10px;
      width: 40px;
      height: 40px;
      font-size: 18px;
    }
  }

  /* Ð¡Ñ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ð¿Ð°Ð¿Ð° Ð½Ð° Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð¹ Ð¼Ð¸Ð½ÑƒÑ‚Ðµ VSL Ð² Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð¼ Ð¿Ð»ÐµÐµÑ€Ðµ */
  .fullscreen-vsl-mid-popup {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1000;
    pointer-events: none; /* ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ ÐºÐ»Ð¸ÐºÐ°Ñ‚ÑŒ Ñ‡ÐµÑ€ÐµÐ· Ð¿Ð¾Ð¿Ð°Ð¿ Ð½Ð° Ð²Ð¸Ð´ÐµÐ¾ */
    background: transparent; /* Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð·Ð°Ñ‚ÐµÐ¼Ð½ÐµÐ½Ð¸Ðµ Ð²Ð¸Ð´ÐµÐ¾ */
    display: none; /* ÐŸÐ¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ ÑÐºÑ€Ñ‹Ñ‚ */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }
  
  .fullscreen-vsl-mid-popup.show {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
  }

  .fullscreen-vsl-mid-banner {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    background: #4CAF50; /* ÐœÐµÐ½ÐµÐµ ÑÑ€ÐºÐ¸Ð¹ Ð·ÐµÐ»ÐµÐ½Ñ‹Ð¹ Ñ†Ð²ÐµÑ‚ */
    color: white;
    padding: 15px;
    text-align: center;
    font-weight: bold;
    font-size: 16px;
    z-index: 11;
    pointer-events: auto; /* ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ Ñ Ð±Ð°Ð½Ð½ÐµÑ€Ð¾Ð¼ */
    position: relative;
  }

  .fullscreen-vsl-mid-vignette {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: transparent; /* Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð·Ð°Ñ‚ÐµÐ¼Ð½ÐµÐ½Ð¸Ðµ Ð² Ð¿Ð¾Ð»Ð½Ð¾ÑÐºÑ€Ð°Ð½Ð½Ð¾Ð¼ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ */
    pointer-events: none;
    z-index: 1;
  }

</style>


