---
import { COPY } from '../content/copy';
import OrderForm from './OrderForm.astro';
import ReturnPopup from './ReturnPopup.astro';
import FormReturnPopup from './FormReturnPopup.astro';
import TimeSelectionPopup from './TimeSelectionPopup.astro';
import DomonetkaForm from './DomonetkaForm.astro';
import VSLExitPopup from './VSLExitPopup.astro';
import ReturnVisitPopup from './ReturnVisitPopup.astro';

import DiscountButton from './DiscountButton.astro';
import { siteConfig } from '../config/site-config';
const { messages, form } = COPY;
  const autoPostbackMs = form.autoPostbackSeconds ? form.autoPostbackSeconds * 1000 : 180000;
---

<div class="container">
  <slot name="header" />
  <div class="chat" id="chat">
    <!-- Encryption Message -->
    <div class="bubble encryption">
      {siteConfig.texts.chatMessages.encryptionMessage}
    </div>

    <!-- Urgent Message -->
    <div class="bubble urgent">
      <strong>{siteConfig.texts.chatMessages.urgentMessage}</strong><br><br>
      {siteConfig.texts.chatMessages.problemMessage}
    </div>

    <!-- VSL Card -->
    <div class="bubble vsl-bubble">
      <div class="vsl-card">
        <div class="vsl-thumb">
                      <video id="vslVideoInline" src={siteConfig.images.videos.chatVsl} muted loop playsinline preload="metadata" loading="lazy" class="vsl-video" data-popup-start={siteConfig.settings.vslPopupStartTime} data-popup-end={siteConfig.settings.vslPopupEndTime} data-video-src={siteConfig.images.videos.chatVsl} controlsList="nodownload nofullscreen noremoteplayback" onloadstart="console.log('Video loading started')" onloadeddata="console.log('Video data loaded')" oncanplay="console.log('Video can play, duration:', this.duration)" onerror="console.log('Video error:', this.error)"></video>
          <div class="vsl-overlay">
            <!-- –ó–µ–ª–µ–Ω–∞—è –º–∏–≥–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ –≤–∫–ª—é—á–µ–Ω–∏—è –∑–≤—É–∫–∞ -->
            <div class="vsl-sound-btn" id="vslPlayBtn" style="cursor: pointer; z-index: 5; pointer-events: auto;">
              <div class="sound-btn-content">
                <div class="sound-btn-text-top">{siteConfig.texts.buttons.enableSound}</div>
                <div class="sound-btn-text-bottom">{siteConfig.texts.buttons.saveErection}</div>
              </div>
            </div>
            
            <!-- –ü—Ä–æ—Å—Ç–∞—è –∫–Ω–æ–ø–∫–∞ –ø–æ–≤–µ—Ä—Ö –æ—Å–Ω–æ–≤–Ω–æ–π (—Å–∫—Ä—ã—Ç–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ) -->
            <button id="vslPlayBtnSimple" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: transparent; border: none; width: 200px; height: 80px; cursor: pointer; z-index: 7; display: none;"></button>
            
            <!-- –ú–∞–ª–µ–Ω—å–∫–∞—è –∫–Ω–æ–ø–∫–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏—è –∑–≤—É–∫–∞ (—Å–∫—Ä—ã—Ç–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ) -->
            <button id="vslMuteBtn" style="position: absolute; top: 10px; right: 10px; background: rgba(0, 0, 0, 0.7); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; z-index: 6; font-size: 16px; display: none; pointer-events: auto;">üîá</button>
            
            <!-- –ö—Ä–µ—Å—Ç–∏–∫ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è VSL -->
            <button id="vslCloseBtn" style="position: absolute; top: 10px; right: 50px; background: rgba(0, 0, 0, 0.7); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; z-index: 8; font-size: 18px; display: none; pointer-events: auto;">‚úï</button>
            
            <!-- –ü–æ–ø–∞–ø –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –º–∏–Ω—É—Ç–µ VSL -->
            <div id="vslMidPopup" class="vsl-mid-popup" style="display: none;">
              <!-- –ó–µ–ª–µ–Ω–∞—è –ø–ª–∞—à–∫–∞ —Å–≤–µ—Ä—Ö—É -->
              <div class="vsl-mid-banner" onclick="if(window.showOrderForm) window.showOrderForm();" style="cursor: pointer;">
                <div class="vsl-mid-vignette"></div>
                <div>{siteConfig.texts.popups.vslMidPopup.title}</div>
                <div style="font-size: 14px; margin-top: 5px;">{siteConfig.texts.popups.vslMidPopup.subtitle}</div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- Discount Button Message (—Å–∫—Ä—ã—Ç –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ) -->
    <div class="discount-message" style="display: none;">
      <div class="product-image">
        <img src={siteConfig.images.chatImages.productImage} alt={siteConfig.productName} loading="lazy" />
      </div>
      <div class="discount-content">
        <div class="discount-text">
          <p><strong>{siteConfig.texts.banners.exclusiveOffer}</strong> –ò–º–µ–Ω–Ω–æ –¥–ª—è –≤–∞—Å –¥–æ—Å—Ç—É–ø–Ω–∞</p>
          <p>{siteConfig.texts.banners.actionPrice} {siteConfig.productName}!</p>
          <p>{siteConfig.texts.banners.leaveRequest}</p>
        </div>
        <button id="getDiscountBtn" class="discount-btn">
          {siteConfig.texts.buttons.getSpecialOffer}
        </button>
      </div>
    </div>



    <!-- Auto Message with Product (shown after 3 minutes or on minimize) -->
    <div class="auto-message" id="autoMessage" style="display: none;">
      <div class="auto-message-content">
        <div class="product-image">
          <img src={siteConfig.images.chatImages.productImage} alt={siteConfig.productName} loading="lazy" />
        </div>
        <div class="message-text">
          <p><strong>{siteConfig.texts.banners.exclusiveOffer}</strong> –ò–º–µ–Ω–Ω–æ –¥–ª—è –≤–∞—Å –¥–æ—Å—Ç—É–ø–Ω–∞</p>
          <p>{siteConfig.texts.banners.actionPrice} {siteConfig.productName}!</p>
          <p>{siteConfig.texts.banners.leaveRequest}</p>
        </div>
      </div>
    </div>

    <!-- Auto Discount Button (separate from message) -->
    <div class="bubble auto-discount-container" id="autoDiscountContainer" style="display: none;">
      <button class="auto-discount-btn" id="autoDiscountBtn">
        {siteConfig.texts.buttons.getSpecialOffer}
      </button>
    </div>

    <!-- –ü–æ–ø–∞–ø –≤—ã–±–æ—Ä–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ VSL -->
    <div id="vslCloseChoicePopup" class="vsl-close-choice-popup" style="display: none;">
      <div class="vsl-close-choice-content">
        <h3>{siteConfig.texts.popups.vslCloseChoicePopup.title}</h3>
        <div class="vsl-close-choice-buttons">
          <button id="continueWatchingChoice" class="btn-primary">{siteConfig.texts.popups.vslCloseChoicePopup.continueButton}</button>
          <button id="returnToChatChoice" class="btn-secondary">{siteConfig.texts.popups.vslCloseChoicePopup.returnToChatButton}</button>
        </div>
      </div>
    </div>





  </div>

  <!-- PWA Modals (positioned relative to chat container) -->
  <div class="pwa-modal" id="orderFormModal" style="display: none;">
    <div class="pwa-modal-backdrop" id="orderFormBackdrop"></div>
    <div class="pwa-modal-content">
      <div class="pwa-modal-header">
        <div class="pwa-modal-handle"></div>
        <button class="pwa-modal-close" id="closeOrderFormModal">‚úï</button>
      </div>
      
      <div class="pwa-modal-body">
        <!-- Form Header -->
        <div class="form-header">
          <h2 class="form-title">–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ –∑–∞–∫–∞–∑–∞ UROXEL</h2>
        </div>

        <!-- Product Image -->
        <div class="product-image-section">
          <img src="/Uroxel_form.png" alt="UROXEL Triple Action" class="product-image" loading="lazy" />
        </div>

        <!-- Timer -->
        <div class="timer-section">
          <div class="timer-badge">
            <span id="orderTimer">04:19</span>
          </div>
        </div>

        <!-- Form Fields -->
        <form id="orderLeadForm" class="order-form-fields">
          <div class="form-group">
            <label for="orderName" class="field-label">{siteConfig.texts.forms.orderForm.namePlaceholder}</label>
            <input type="text" id="orderName" name="name" class="form-input" placeholder={siteConfig.texts.forms.orderForm.namePlaceholder} required>
          </div>

          <div class="form-group">
            <label for="orderPhone" class="field-label">{siteConfig.texts.forms.orderForm.phonePlaceholder}</label>
                          <input type="tel" id="orderPhone" name="phone" class="form-input" placeholder={siteConfig.texts.forms.orderForm.phonePlaceholder} required>
          </div>

                      <button type="submit" class="submit-btn">{siteConfig.texts.buttons.orderCall}</button>

          <div class="form-disclaimer">
            {siteConfig.legal.specialPriceDisclaimer} {siteConfig.legal.timerDisclaimer} {siteConfig.legal.mexicoOnly} {siteConfig.legal.consultationDisclaimer}
          </div>

          <!-- –ü–ª–∞—à–∫–∞ —Å –æ—Ç–∑—ã–≤–∞–º–∏ –º—É–∂—á–∏–Ω -->
          <div class="reviews-banner">
            <div class="reviews-text">
              {siteConfig.texts.banners.reviewsBanner.split(', ').slice(0, 1).join(', ')}<br>
              {siteConfig.texts.banners.reviewsBanner.split(', ').slice(1, 2).join(', ')}<br>
              {siteConfig.texts.banners.reviewsBanner.split(', ').slice(2).join(', ')}
            </div>
          </div>

          <!-- –û—Ç–∑—ã–≤—ã -->
          <div class="reviews-section">
            <!-- –ü–µ—Ä–≤—ã–π –æ—Ç–∑—ã–≤ (–ê–Ω—Ç–æ–Ω–∏–æ) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback1.image} alt={`${siteConfig.productName} –æ—Ç–∑—ã–≤ ${siteConfig.reviews.feedback1.name}`} loading="lazy">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback1.name} - {siteConfig.reviews.feedback1.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'‚òÖ'.repeat(siteConfig.reviews.feedback1.rating)}{'‚òÜ'.repeat(5 - siteConfig.reviews.feedback1.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback1.rating}.0</span>
                </div>
              </div>
            </div>

            <!-- –í—Ç–æ—Ä–æ–π –æ—Ç–∑—ã–≤ (–ö–∞—Ä–ª–æ—Å) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback2.image} alt={`${siteConfig.productName} –æ—Ç–∑—ã–≤ ${siteConfig.reviews.feedback2.name}`} loading="lazy">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback2.name} - {siteConfig.reviews.feedback2.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'‚òÖ'.repeat(siteConfig.reviews.feedback2.rating)}{'‚òÜ'.repeat(5 - siteConfig.reviews.feedback2.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback2.rating}.0</span>
                </div>
              </div>
            </div>

            <!-- –¢—Ä–µ—Ç–∏–π –æ—Ç–∑—ã–≤ (–ê–º–∞–ª–∏—è) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback3.image} alt={`${siteConfig.productName} –æ—Ç–∑—ã–≤ ${siteConfig.reviews.feedback3.name}`} loading="lazy">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback3.name} - {siteConfig.reviews.feedback3.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'‚òÖ'.repeat(siteConfig.reviews.feedback3.rating)}{'‚òÜ'.repeat(5 - siteConfig.reviews.feedback3.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback3.rating}.0</span>
                </div>
              </div>
            </div>

            <!-- –ß–µ—Ç–≤–µ—Ä—Ç—ã–π –æ—Ç–∑—ã–≤ (–ê–ª–æ–Ω—Å–æ) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback4.image} alt={`${siteConfig.productName} –æ—Ç–∑—ã–≤ ${siteConfig.reviews.feedback4.name}`} loading="lazy">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback4.name} - {siteConfig.reviews.feedback4.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'‚òÖ'.repeat(siteConfig.reviews.feedback4.rating)}{'‚òÜ'.repeat(5 - siteConfig.reviews.feedback4.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback4.rating}.0</span>
                </div>
              </div>
            </div>

            <!-- –ü—è—Ç—ã–π –æ—Ç–∑—ã–≤ (–ì—É—Å—Ç–∞–≤–æ) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback5.image} alt={`${siteConfig.productName} –æ—Ç–∑—ã–≤ ${siteConfig.reviews.feedback5.name}`} loading="lazy">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback5.name} - {siteConfig.reviews.feedback5.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'‚òÖ'.repeat(siteConfig.reviews.feedback5.rating)}{'‚òÜ'.repeat(5 - siteConfig.reviews.feedback5.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback5.rating}.0</span>
                </div>
              </div>
            </div>

            <!-- –®–µ—Å—Ç–æ–π –æ—Ç–∑—ã–≤ (–ò–≥–Ω–∞—Å–∏–æ) -->
            <div class="review-item">
              <div class="review-images single">
                <div class="review-image">
                  <img src={siteConfig.reviews.feedback6.image} alt={`${siteConfig.productName} –æ—Ç–∑—ã–≤ ${siteConfig.reviews.feedback6.name}`} loading="lazy">
                </div>
              </div>
              <div class="review-content">
                <div class="review-text">{siteConfig.reviews.feedback6.name} - {siteConfig.reviews.feedback6.text}</div>
                <div class="review-rating">
                  <span class="rating-stars">{'‚òÖ'.repeat(siteConfig.reviews.feedback6.rating)}{'‚òÜ'.repeat(5 - siteConfig.reviews.feedback6.rating)}</span>
                  <span class="rating-score">{siteConfig.reviews.feedback6.rating}.0</span>
                </div>
              </div>
            </div>
          </div>

          <!-- –¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ—Ç–∑—ã–≤—ã –±–µ–∑ –∫–∞—Ä—Ç–∏–Ω–æ–∫ -->
          <div class="text-reviews-section">
            <!-- –û—Ç–∑—ã–≤ 1 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">üë§</div>
                  <div class="reviewer-name">{siteConfig.textReviews.review1.name}</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">{'‚òÖ'.repeat(siteConfig.textReviews.review1.rating)}{'‚òÜ'.repeat(5 - siteConfig.textReviews.review1.rating)}</span>
                  <span class="rating-score">{siteConfig.textReviews.review1.rating}.0</span>
                </div>
              </div>
              <div class="review-title">{siteConfig.textReviews.review1.title}</div>
              <div class="review-date">{siteConfig.textReviews.review1.date}</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">{siteConfig.textReviews.review1.text}</div>
              {siteConfig.textReviews.review1.helpful && <div class="review-helpful">{siteConfig.textReviews.review1.helpful}</div>}
            </div>

            <!-- –û—Ç–∑—ã–≤ 2 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">üë§</div>
                  <div class="reviewer-name">Carlos</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                  <span class="rating-score">5.0</span>
                </div>
              </div>
              <div class="review-title">Buen producto</div>
              <div class="review-date">Comentado en M√©xico el 21 de abril de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Estoy muy conforme con el producto</div>
            </div>

            <!-- –û—Ç–∑—ã–≤ 3 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">üë§</div>
                  <div class="reviewer-name">Elmer HRmo</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
                  <span class="rating-score">4.0</span>
                </div>
              </div>
              <div class="review-title">Buen producto</div>
              <div class="review-date">Comentado en M√©xico el 11 de agosto de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Buen producto</div>
            </div>

            <!-- –û—Ç–∑—ã–≤ 4 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">üë§</div>
                  <div class="reviewer-name">Roberto Soriano D√°vila</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                  <span class="rating-score">5.0</span>
                </div>
              </div>
              <div class="review-title">Seriedad del proveedor.</div>
              <div class="review-date">Comentado en M√©xico el 9 de noviembre de 2024</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Muy buen producto, empez√≥ a actuar desde la primera toma, contiene elementos muy valiosos como el zinc, ya que la pr√≥stata es el √≥rgano que contiene 10 veces m√°s Zinc que cualquier otro √≥rgano, tambi√©n el licopeno que se usa para combatir el c√°ncer, as√≠ como otros productos valiosos como el ciruelo africano y la ortiga que han sido probados para desinflamar la pr√≥stata. Lo recomiendo ampliamente.</div>
              <div class="review-helpful">A 4 personas les result√≥ √∫til</div>
            </div>

            <!-- –û—Ç–∑—ã–≤ 5 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">üë§</div>
                  <div class="reviewer-name">Gerardo ponce lopez</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                  <span class="rating-score">5.0</span>
                </div>
              </div>
              <div class="review-title">MUY BIEN</div>
              <div class="review-date">Comentado en M√©xico el 20 de junio de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">LLEG√ì BIEN GRACIAS</div>
              <div class="review-helpful">A 2 personas les result√≥ √∫til</div>
            </div>

            <!-- –û—Ç–∑—ã–≤ 6 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">üë§</div>
                  <div class="reviewer-name">Cliente de Kindle</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
                  <span class="rating-score">4.0</span>
                </div>
              </div>
              <div class="review-title">Excelente</div>
              <div class="review-date">Comentado en M√©xico el 4 de mayo de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Ya voy por la quinta lata. ¬°El efecto es mejor de lo prometido!</div>
            </div>

            <!-- –û—Ç–∑—ã–≤ 7 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">üë§</div>
                  <div class="reviewer-name">GABRIEL MU√ëOZ NU√ëEZ</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                  <span class="rating-score">5.0</span>
                </div>
              </div>
              <div class="review-title">Gracias</div>
              <div class="review-date">Comentado en M√©xico el 7 de junio de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Gracias</div>
            </div>

            <!-- –û—Ç–∑—ã–≤ 8 -->
            <div class="text-review-item">
              <div class="review-header">
                <div class="reviewer-info">
                  <div class="reviewer-avatar">üë§</div>
                  <div class="reviewer-name">Ram√≥n N√∫√±ez-Doval</div>
                </div>
                <div class="review-rating">
                  <span class="rating-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
                  <span class="rating-score">5.0</span>
                </div>
              </div>
              <div class="review-title">Uroxel es un buen producto</div>
              <div class="review-date">Comentado en M√©xico el 16 de abril de 2025</div>
              <div class="review-verified">Compra verificada</div>
              <div class="review-text">Es un buen producto como se nos hab√≠a anunciado.</div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="pwa-modal" id="callBookingModal" style="display: none;">
    <div class="pwa-modal-backdrop" id="callBookingBackdrop"></div>
    <div class="pwa-modal-content">
      <div class="pwa-modal-header">
        <div class="pwa-modal-handle"></div>
        <button class="pwa-modal-close" id="closeCallBookingModal">‚úï</button>
      </div>
      
      <div class="pwa-modal-body">
        <!-- Product Image -->
        <div class="product-image-section">
          <img src="/Uroxel_form.png" alt="UROXEL Triple Action" class="product-image" loading="lazy" />
        </div>

        <div class="call-to-action">
          <h3 class="call-title">{siteConfig.texts.headers.bookCallTitle}</h3>
                      <p class="call-subtitle">{siteConfig.texts.headers.bookCallSubtitle}</p>
        </div>

        <div class="time-selection">
          <select id="callTime" class="time-dropdown">
            <option value="–ü—Ä—è–º–æ —Å–µ–π—á–∞—Å">–ü—Ä—è–º–æ —Å–µ–π—á–∞—Å</option>
            <option value="5 –º–∏–Ω—É—Ç">5 –º–∏–Ω—É—Ç</option>
            <option value="15 –º–∏–Ω—É—Ç">15 –º–∏–Ω—É—Ç</option>
            <option value="30 –º–∏–Ω—É—Ç">30 –º–∏–Ω—É—Ç</option>
          </select>
        </div>

                  <button id="callSubmitBtn" class="call-submit-btn">{siteConfig.texts.buttons.orderCall}</button>
        <button id="backToOrderBtn" class="back-btn-chat">{siteConfig.texts.buttons.backToOrder}</button>
      </div>
    </div>
  </div>

  

    <!-- Chat Input (outside of chat container) -->
    <div class="chat-input">
    <button class="input-btn">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
      </svg>
    </button>
    <div class="input-field-container">
      <input type="text" class="chat-input-field" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ" />
      <button class="emoji-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.5 11c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0C9.33 11 10 10.33 10 9.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
        </svg>
      </button>
    </div>
    <div class="input-actions">
      <button class="action-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"/>
        </svg>
      </button>
      <button class="action-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 12m-3.2 0a3.2 3.2 0 1 1 6.4 0a3.2 3.2 0 1 1 -6.4 0"/>
          <path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"/>
        </svg>
      </button>
      <button class="action-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
          <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<!-- Main VSL Popup -->
<!-- –ü–æ–ø–∞–ø —Å –≤–∏–¥–µ–æ —É–¥–∞–ª–µ–Ω - –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è -->

<!-- Return Popup Component -->
<ReturnPopup />

<!-- Form Return Popup Component -->
<FormReturnPopup />

<!-- Time Selection Popup Component -->
<TimeSelectionPopup />

<!-- Order Form Component (—Å–∫—Ä—ã—Ç, —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–æ—Ä–º–∞ –≤ —á–∞—Ç–µ) -->
<!-- <OrderForm /> -->

  <!-- Domonetka Form Component -->
  <DomonetkaForm />
  
  <!-- VSL Start Popup Component -->
  
  
  <!-- VSL Exit Popup Component -->
  <!-- <VSLExitPopup /> -->
  
  <!-- Return Visit Popup Component -->
  <ReturnVisitPopup />

<script>
  const openVsl = document.getElementById('openVsl');
  // const popup = document.getElementById('popup'); // –£–¥–∞–ª–µ–Ω
  // const closePopup = document.getElementById('closePopup'); // –£–¥–∞–ª–µ–Ω
  // const video = document.getElementById('vslVideo'); // –£–¥–∞–ª–µ–Ω
  const floatingForm = document.getElementById('floatingForm');
  const minimizeBtn = document.getElementById('minimizeBtn');
  const minimizedBadge = document.getElementById('minimizedBadge');
  const leadForm = document.getElementById('leadForm');
  const calltime = document.getElementById('calltime');

  let postbackTimeoutId;
  let videoStartTime = 0;
  let hasShownForm = false;

  function toggleVslSound() {
    const video = document.getElementById('vslVideoInline');
    const playBtn = document.getElementById('vslPlayBtn');
    const playBtnSimple = document.getElementById('vslPlayBtnSimple');
    const muteBtn = document.getElementById('vslMuteBtn');
    const closeBtn = document.getElementById('vslCloseBtn');
    
    if (video) {
      if (video.muted) {
        // –í–∫–ª—é—á–∞–µ–º –∑–≤—É–∫
        video.muted = false;
        
        // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        if (playBtn) playBtn.style.display = 'none';
        if (playBtnSimple) playBtnSimple.style.display = 'none';
        if (muteBtn) {
          muteBtn.style.display = 'block';
          muteBtn.textContent = 'üîá';
        }
        if (closeBtn) closeBtn.style.display = 'block';
      } else {
        // –í—ã–∫–ª—é—á–∞–µ–º –∑–≤—É–∫
        video.muted = true;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –∏ —Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        if (playBtn) playBtn.style.display = 'flex';
        if (playBtnSimple) playBtnSimple.style.display = 'block';
        if (muteBtn) muteBtn.style.display = 'none';
        if (closeBtn) closeBtn.style.display = 'none';
      }
    }
  }

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –≤–∏–¥–µ–æ –≤ ReturnPopup –±–µ–∑ –∫–Ω–æ–ø–æ–∫
  function openVideoInReturnPopup() {
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º ReturnPopup
    if (window.showReturnPopup) {
      window.showReturnPopup();
      
      // –°—Ä–∞–∑—É —Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∏ —Ç–µ–∫—Å—Ç
      setTimeout(function() {
        const textOverlay = document.querySelector('.vsl-text-overlay');
        const vignette = document.querySelector('.vsl-vignette');
        
        if (textOverlay) {
          textOverlay.style.display = 'none';
        }
        if (vignette) {
          vignette.style.display = 'none';
        }
        
        // –£–±–∏—Ä–∞–µ–º –∫—É—Ä—Å–æ—Ä pointer —Å –≤–∏–¥–µ–æ
        const video = document.getElementById('returnVslVideo');
        if (video) {
          video.style.cursor = 'default';
        }
      }, 100);
    }
  }
  
  function openPopup() {
    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º VSL –≤ —á–∞—Ç–µ –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º –ø–æ–ø–∞–ø–∞
    if (window.stopChatVsl) {
      window.stopChatVsl();
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø —Å –≤—ã–±–æ—Ä–æ–º –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –≤–∏–¥–µ–æ
    if (window.showReturnPopup) {
      window.showReturnPopup();
    }
  }

  // function closePopupAndShowForm() {
  //   // –£–¥–∞–ª–µ–Ω–∞ - –ø–æ–ø–∞–ø –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
  // }
  
  hasShownForm = true;
  scheduleAutoPostback();

  function minimizeForm() {
    floatingForm.dataset.minimized = 'true';
    floatingForm.style.display = 'none';
    minimizedBadge.style.display = 'inline-flex';
  }

  function expandForm() {
    floatingForm.dataset.minimized = 'false';
    floatingForm.style.display = 'block';
    minimizedBadge.style.display = 'none';
  }

  function scheduleAutoPostback() {
    // –£–±–∏—Ä–∞–µ–º –∞–≤—Ç–æ–æ—Ç–ø—Ä–∞–≤–∫—É –∑–∞—è–≤–æ–∫
    clearTimeout(postbackTimeoutId);
  }

  async function sendPostback(extra={}) {
    const formData = new FormData(leadForm);
    const payload = {
      name: formData.get('name') || '',
      phone: formData.get('phone') || '',
      calltime: formData.get('calltime') || '',
      videoWatchTime: videoStartTime ? Math.floor((Date.now() - videoStartTime) / 1000) : 0,
      ...extra,
      ts: Date.now(),
      ua: navigator.userAgent
    };
    try {
      await fetch('/api/postback', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });
    } catch (e) {
      console.error('postback error', e);
    }
  }

  // Event Listeners
  // openVsl?.addEventListener('click', (e) => { 
  //   e.preventDefault(); 
  //   openPopup(); 
  // });

  // closePopup?.addEventListener('click', () => { 
  //   closePopupAndShowForm(); 
  // });

  // popup?.addEventListener('click', (e) => { 
  //   if (e.target === popup) { 
  //     closePopupAndShowForm(); 
  //   } 
  // });

  minimizeBtn?.addEventListener('click', () => { 
    minimizeForm(); 
  });

  minimizedBadge?.addEventListener('click', () => { 
    expandForm(); 
  });

  calltime?.addEventListener('change', () => { 
    // –£–±–∏—Ä–∞–µ–º –∞–≤—Ç–æ–æ—Ç–ø—Ä–∞–≤–∫—É
  });

  leadForm?.addEventListener('submit', async (e) => {
    e.preventDefault();
    clearTimeout(postbackTimeoutId);
    await sendPostback({ reason: 'submit' });
    minimizeForm();
    alert('–°–ø–∞—Å–∏–±–æ! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏.');
  });

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º—è –≤–∏–¥–µ–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —É—Ö–æ–¥–∞
  document.addEventListener('visibilitychange', () => {
    const video = document.getElementById('vslVideoInline');
    if (document.hidden && video && !video.paused) {
      if (window.saveVideoTime) {
        window.saveVideoTime();
      }
    }
  });

  // –û—Ç–∫–ª—é—á–∞–µ–º –ø–µ—Ä–µ–º–æ—Ç–∫—É –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –≤–∏–¥–µ–æ
  const vslVideoInline = document.getElementById('vslVideoInline');
  if (vslVideoInline) {
    // –û—Ç–∫–ª—é—á–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
    vslVideoInline.addEventListener('contextmenu', (e) => {
      e.preventDefault();
      return false;
    });

    // –û—Ç–∫–ª—é—á–∞–µ–º –ø–µ—Ä–µ–º–æ—Ç–∫—É –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
    vslVideoInline.addEventListener('click', (e) => {
      e.preventDefault();
      return false;
    });

    // –û—Ç–∫–ª—é—á–∞–µ–º –ø–µ—Ä–µ–º–æ—Ç–∫—É –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏
    vslVideoInline.addEventListener('seeking', (e) => {
      e.preventDefault();
      return false;
    });

    // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–æ—Ç–∫—É –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è
    vslVideoInline.addEventListener('seeking', (e) => {
      e.preventDefault();
      vslVideoInline.currentTime = vslVideoInline.currentTime;
      return false;
    });

    // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–æ—Ç–∫—É –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è
    const originalCurrentTime = Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype, 'currentTime');
    Object.defineProperty(vslVideoInline, 'currentTime', {
      get: function() {
        return originalCurrentTime.get.call(this);
      },
      set: function(value) {
        // –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        if (this.paused) {
          originalCurrentTime.set.call(this, value);
        }
        // –ë–ª–æ–∫–∏—Ä—É–µ–º —Ä—É—á–Ω—É—é –ø–µ—Ä–µ–º–æ—Ç–∫—É
        return;
      }
    });

    // –û—Ç–∫–ª—é—á–∞–µ–º –ø–µ—Ä–µ–º–æ—Ç–∫—É –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏
    vslVideoInline.addEventListener('timeupdate', () => {
      // –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
      // –ë–ª–æ–∫–∏—Ä—É–µ–º –ª—é–±—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø–µ—Ä–µ–º–æ—Ç–∫–∏
    });
  }



  // Exit intent –æ—Ç–∫–ª—é—á–µ–Ω - –ø–æ–ø–∞–ø –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
  // document.addEventListener('mouseleave', (e) => {
  //   if (e.clientY <= 0 && !hasShownForm && !hasVisitedBefore) {
  //     if (window.showReturnPopup) {
  //       window.showReturnPopup();
  //     }
  //   }
  // });

  // VSL –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - —Ç–æ–ª—å–∫–æ –ø–æ –∫–ª–∏–∫—É
  let hasOpenedVsl = false;
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ä–∞–Ω–µ–µ
  let hasVisitedBefore = localStorage.getItem('hasVisitedBefore');
  
  // –ü–µ—Ä–≤—ã–π –≤–∏–∑–∏—Ç - –∑–∞–ø–æ–º–∏–Ω–∞–µ–º (VSL –≤ —á–∞—Ç–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
  if (!hasVisitedBefore) {
    localStorage.setItem('hasVisitedBefore', 'true');
  }

  // –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–∞–π–º–µ—Ä –∏ —Å—á–µ—Ç—á–∏–∫ –±–∞–Ω–æ–∫
  let globalTimeLeft = 4 * 60 + 19; // 4 –º–∏–Ω—É—Ç—ã 19 —Å–µ–∫—É–Ω–¥
  let globalBottlesLeft = 39;
  let globalTotalBottles = 1500;
  
  function updateGlobalTimer() {
    const minutes = Math.floor(globalTimeLeft / 60);
    const seconds = globalTimeLeft % 60;
    const timerElements = document.querySelectorAll('#timer, #domonetkaTimer, #orderTimer');
    timerElements.forEach(element => {
      element.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    });
    
    if (globalTimeLeft > 0) {
      globalTimeLeft--;
    }
  }
  
  function updateGlobalBottles() {
    const bottlesElements = document.querySelectorAll('#bottles, #domonetkaBottles');
    bottlesElements.forEach(element => {
      if (globalBottlesLeft > 0) {
        globalBottlesLeft--;
        element.textContent = `${globalBottlesLeft}/${globalTotalBottles}`;
      }
    });
  }
  
  // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã (–∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑)
  let globalTimerInterval;
  let globalBottlesInterval;
  let globalTimersStarted = false;
  
  function startGlobalTimers() {
    if (!globalTimersStarted) {
      if (!globalTimerInterval) {
        globalTimerInterval = setInterval(updateGlobalTimer, 1000);
      }
      if (!globalBottlesInterval) {
        globalBottlesInterval = setInterval(updateGlobalBottles, 4000 + Math.random() * 1000);
      }
      globalTimersStarted = true;
    }
  }
  
  // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä—ã —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  startGlobalTimers();

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü–æ–ª—É—á–∏—Ç—å —Å–∫–∏–¥–∫—É"
  const getDiscountBtn = document.getElementById('getDiscountBtn');
  getDiscountBtn?.addEventListener('click', () => {
    console.log('getDiscountBtn clicked');
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –∑–∞–∫–∞–∑–∞ –∫–∞–∫ PWA –º–æ–¥–∞–ª
    const orderFormModal = document.getElementById('orderFormModal');
    if (orderFormModal) {
      orderFormModal.style.display = 'flex';
      setTimeout(() => {
        orderFormModal.classList.add('show');
      }, 10);
    }
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ñ–æ—Ä–º –≤ —á–∞—Ç–µ
  const orderLeadForm = document.getElementById('orderLeadForm');
  const callSubmitBtn = document.getElementById('callSubmitBtn');
  const backToOrderBtn = document.getElementById('backToOrderBtn');

  // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
  let savedFormData = {};

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞
  orderLeadForm?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    console.log('Order form submitted');
    
    const formData = new FormData(orderLeadForm);
    const leadData = {
      name: formData.get('name'),
      phone: formData.get('phone'),
      timestamp: new Date().toISOString(),
      reason: 'order_form',
      videoWatchTime: videoStartTime ? Math.floor((Date.now() - videoStartTime) / 1000) : 0,
      userAgent: navigator.userAgent
    };
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ç–æ—Ä–æ–π —Ñ–æ—Ä–º—ã
    savedFormData = {
      name: formData.get('name'),
      phone: formData.get('phone'),
      videoWatchTime: videoStartTime ? Math.floor((Date.now() - videoStartTime) / 1000) : 0
    };
    
    try {
      const response = await fetch('/api/postback', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(leadData)
      });
      
      console.log('Response status:', response.status);
      
      if (response.ok) {
        console.log('Order form success, showing call booking form');
        // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –∑–∞–∫–∞–∑–∞
        const orderFormModal = document.getElementById('orderFormModal');
        if (orderFormModal) {
          orderFormModal.classList.remove('show');
          setTimeout(() => {
            orderFormModal.style.display = 'none';
          }, 300);
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–≤–æ–Ω–∫–∞
        const callBookingModal = document.getElementById('callBookingModal');
        if (callBookingModal) {
          callBookingModal.style.display = 'flex';
          setTimeout(() => {
            callBookingModal.classList.add('show');
          }, 10);
        }
      } else {
        console.error('Response not ok:', response.status);
      }
    } catch (error) {
      console.error('Error submitting order form:', error);
    }
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–≤–æ–Ω–∫–∞
  callSubmitBtn?.addEventListener('click', async () => {
    const callTimeElement = document.getElementById('callTime');
    const callTime = callTimeElement ? callTimeElement.value : '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
    
    console.log('Selected call time:', callTime);
    console.log('Call time element:', callTimeElement);
    
    const leadData = {
      name: savedFormData.name || '',
      phone: savedFormData.phone || '',
      callTime: callTime,
      timestamp: new Date().toISOString(),
      reason: 'call_booking',
      videoWatchTime: savedFormData.videoWatchTime || 0,
      userAgent: navigator.userAgent
    };
    
    console.log('Call booking form submitted with data:', leadData);
    
    try {
      const response = await fetch('/api/postback', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(leadData)
      });
      
      if (response.ok) {
        // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        const callBookingModal = document.getElementById('callBookingModal');
        if (callBookingModal) {
          callBookingModal.classList.remove('show');
          setTimeout(() => {
            callBookingModal.style.display = 'none';
          }, 300);
        }
        // –û—á–∏—â–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        savedFormData = {};
      } else {
        console.error('Response not ok:', response.status);
      }
    } catch (error) {
      console.error('Error submitting call booking:', error);
    }
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" –≤ —Ñ–æ—Ä–º–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
  backToOrderBtn?.addEventListener('click', async () => {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–ù–∞–∑–∞–¥"
    if (savedFormData.name && savedFormData.phone) {
      const callTimeElement = document.getElementById('callTime');
      const callTime = callTimeElement ? callTimeElement.value : '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
      
      const leadData = {
        name: savedFormData.name,
        phone: savedFormData.phone,
        callTime: callTime,
        timestamp: new Date().toISOString(),
        reason: 'call_booking_back_button',
        videoWatchTime: savedFormData.videoWatchTime || 0,
        userAgent: navigator.userAgent
      };
      
      try {
        await fetch('/api/postback', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(leadData)
        });
        console.log('Call booking back button clicked - data sent');
      } catch (error) {
        console.error('Error sending call booking back button data:', error);
      }
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ (—á–µ—Ç–≤–µ—Ä—Ç–∞—è —Å—Ç–∞–¥–∏—è)
    if (window.showTimeSelectionPopup) {
      window.showTimeSelectionPopup();
    }
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
  const closeOrderFormModal = document.getElementById('closeOrderFormModal');
  const closeCallBookingModal = document.getElementById('closeCallBookingModal');
  const orderFormBackdrop = document.getElementById('orderFormBackdrop');
  const callBookingBackdrop = document.getElementById('callBookingBackdrop');

  function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.remove('show');
      setTimeout(() => {
        modal.style.display = 'none';
      }, 300);
    }
  }

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏ –±–µ–∑ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏
  async function sendAutoCallRequest() {
    const leadData = {
      name: savedFormData.name || '',
      phone: savedFormData.phone || '',
      callTime: '–ù–µ –≤—ã–±—Ä–∞–Ω–æ',
      timestamp: new Date().toISOString(),
      reason: 'auto_call_booking',
      videoWatchTime: savedFormData.videoWatchTime || 0,
      userAgent: navigator.userAgent
    };
    
    try {
      const response = await fetch('/api/postback', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(leadData)
      });
      
      if (response.ok) {
        console.log('Auto call request sent successfully');
      } else {
        console.error('Failed to send auto call request');
      }
    } catch (error) {
      console.error('Error sending auto call request:', error);
    }
  }

  closeOrderFormModal?.addEventListener('click', async () => {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞
    if (savedFormData.name && savedFormData.phone) {
      const leadData = {
        name: savedFormData.name,
        phone: savedFormData.phone,
        callTime: '–§–æ—Ä–º–∞ –∑–∞–∫—Ä—ã—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º',
        timestamp: new Date().toISOString(),
        reason: 'order_form_closed',
        videoWatchTime: savedFormData.videoWatchTime || 0,
        userAgent: navigator.userAgent
      };
      
      try {
        await fetch('/api/postback', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(leadData)
        });
        console.log('Order form closed - data sent');
      } catch (error) {
        console.error('Error sending order form close data:', error);
      }
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å —Ñ–æ—Ä–º—ã (—Ç—Ä–µ—Ç—å—è —Å—Ç–∞–¥–∏—è)
    if (window.showFormReturnPopup) {
      window.showFormReturnPopup();
    }
  });

  closeCallBookingModal?.addEventListener('click', async () => {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ñ–æ—Ä–º—ã –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏
    if (savedFormData.name && savedFormData.phone) {
      const callTimeElement = document.getElementById('callTime');
      const callTime = callTimeElement ? callTimeElement.value : '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
      
      const leadData = {
        name: savedFormData.name,
        phone: savedFormData.phone,
        callTime: callTime,
        timestamp: new Date().toISOString(),
        reason: 'call_booking_closed',
        videoWatchTime: savedFormData.videoWatchTime || 0,
        userAgent: navigator.userAgent
      };
      
      try {
        await fetch('/api/postback', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(leadData)
        });
        console.log('Call booking form closed - data sent');
      } catch (error) {
        console.error('Error sending call booking close data:', error);
      }
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ (—á–µ—Ç–≤–µ—Ä—Ç–∞—è —Å—Ç–∞–¥–∏—è)
    if (window.showTimeSelectionPopup) {
      window.showTimeSelectionPopup();
    }
  });

  orderFormBackdrop?.addEventListener('click', async () => {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Ñ–æ–Ω —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞
    if (savedFormData.name && savedFormData.phone) {
      const leadData = {
        name: savedFormData.name,
        phone: savedFormData.phone,
        callTime: '–§–æ—Ä–º–∞ –∑–∞–∫—Ä—ã—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º',
        timestamp: new Date().toISOString(),
        reason: 'order_form_backdrop_closed',
        videoWatchTime: savedFormData.videoWatchTime || 0,
        userAgent: navigator.userAgent
      };
      
      try {
        await fetch('/api/postback', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(leadData)
        });
        console.log('Order form backdrop clicked - data sent');
      } catch (error) {
        console.error('Error sending order form backdrop data:', error);
      }
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å —Ñ–æ—Ä–º—ã (—Ç—Ä–µ—Ç—å—è —Å—Ç–∞–¥–∏—è)
    if (window.showFormReturnPopup) {
      window.showFormReturnPopup();
    }
  });

  callBookingBackdrop?.addEventListener('click', async () => {
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Ñ–æ–Ω —Ñ–æ—Ä–º—ã –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏
    if (savedFormData.name && savedFormData.phone) {
      const callTimeElement = document.getElementById('callTime');
      const callTime = callTimeElement ? callTimeElement.value : '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
      
      const leadData = {
        name: savedFormData.name,
        phone: savedFormData.phone,
        callTime: callTime,
        timestamp: new Date().toISOString(),
        reason: 'call_booking_backdrop_closed',
        videoWatchTime: savedFormData.videoWatchTime || 0,
        userAgent: navigator.userAgent
      };
      
      try {
        await fetch('/api/postback', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(leadData)
        });
        console.log('Call booking backdrop clicked - data sent');
      } catch (error) {
        console.error('Error sending call booking backdrop data:', error);
      }
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ (—á–µ—Ç–≤–µ—Ä—Ç–∞—è —Å—Ç–∞–¥–∏—è)
    if (window.showTimeSelectionPopup) {
      window.showTimeSelectionPopup();
    }
  });





  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º
  const autoMessage = document.getElementById('autoMessage');
  const autoDiscountContainer = document.getElementById('autoDiscountContainer');
  const autoDiscountBtn = document.getElementById('autoDiscountBtn');
  let hasShownAutoMessage = false;

  function showAutoMessage() {
    console.log('üéØ showAutoMessage called');
    if (!hasShownAutoMessage && autoMessage && autoDiscountContainer) {
      console.log('‚úÖ Showing auto message and button');
      autoMessage.style.display = 'block';
      autoDiscountContainer.style.display = 'block';
      hasShownAutoMessage = true;
      
      // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Å–æ–æ–±—â–µ–Ω–∏—é
      setTimeout(() => {
        const chatContainer = document.querySelector('.chat');
        if (chatContainer) {
          chatContainer.scrollTop = chatContainer.scrollHeight;
          console.log('üìú Scrolled chat to bottom');
        }
      }, 200);
    } else {
      console.log('‚ö†Ô∏è Auto message already shown or element not found');
    }
  }

  // –£–±–∏—Ä–∞–µ–º –ø–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞–Ω–∏–∏ –æ–∫–Ω–∞ - –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤ –Ω—É–∂–Ω–æ–µ –≤—Ä–µ–º—è VSL
  // document.addEventListener('visibilitychange', () => {
  //   if (document.hidden && !hasShownAutoMessage) {
  //     showAutoMessage();
  //   }
  // });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–ü–æ–ª—É—á–∏—Ç—å —Å–∫–∏–¥–∫—É" –≤ –∞–≤—Ç–æ—Å–æ–æ–±—â–µ–Ω–∏–∏
  autoDiscountBtn?.addEventListener('click', () => {
    console.log('üéØ autoDiscountBtn clicked');
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –∑–∞–∫–∞–∑–∞ –∫–∞–∫ PWA –º–æ–¥–∞–ª
    const orderFormModal = document.getElementById('orderFormModal');
    if (orderFormModal) {
      orderFormModal.style.display = 'flex';
      setTimeout(() => {
        orderFormModal.classList.add('show');
      }, 10);
    }
  });



  // –£–±–∏—Ä–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏—è - –æ–Ω–æ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤ –Ω—É–∂–Ω–æ–µ –≤—Ä–µ–º—è VSL
  // setTimeout(showAutoMessage, 5000);



  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ mousedown –¥–ª—è VSL –∫–Ω–æ–ø–æ–∫ (–æ—Å–Ω–æ–≤–Ω–æ–π)
  document.addEventListener('mousedown', function(e) {
    if (e.target && (e.target.closest('.vsl-sound-btn') || e.target.id === 'vslPlayBtnSimple')) {
      e.preventDefault();
      e.stopPropagation();
      
      // –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤–∏–¥–µ–æ –Ω–∞–ø—Ä—è–º—É—é –≤ ReturnPopup
      if (window.showReturnPopup) {
        window.showReturnPopup();
      }
    }
    
    // –ö–Ω–æ–ø–∫–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏—è –∑–≤—É–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
    if (e.target && e.target.id === 'vslMuteBtn') {
      e.preventDefault();
      e.stopPropagation();
      toggleVslSound();
    }
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ VSL –≤ —á–∞—Ç–µ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
  document.addEventListener('click', function(e) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–∏–∫ –±—ã–ª –Ω–∞ VSL –≤–∏–¥–µ–æ –∏–ª–∏ –µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –Ω–æ –Ω–µ –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö –∑–≤—É–∫–∞
    if (e.target && e.target.closest('.vsl-bubble') && 
        !e.target.closest('.vsl-sound-btn') && 
        e.target.id !== 'vslMuteBtn' && 
        e.target.id !== 'vslPlayBtnSimple') {
      e.preventDefault();
      e.stopPropagation();
      
      // –û—Ç–∫—Ä—ã–≤–∞–µ–º ReturnPopup —Å VSL
      if (window.showReturnPopup) {
        window.showReturnPopup();
      }
    }
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ touchstart –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
  document.addEventListener('touchstart', function(e) {
    if (e.target && (e.target.closest('.vsl-sound-btn') || e.target.id === 'vslPlayBtnSimple')) {
      e.preventDefault();
      e.stopPropagation();
      
      // –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤–∏–¥–µ–æ –Ω–∞–ø—Ä—è–º—É—é –≤ ReturnPopup
      if (window.showReturnPopup) {
        window.showReturnPopup();
      }
    }
    
    // –ö–Ω–æ–ø–∫–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏—è –∑–≤—É–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
    if (e.target && e.target.id === 'vslMuteBtn') {
      e.preventDefault();
      e.stopPropagation();
      toggleVslSound();
    }
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ touchstart –¥–ª—è VSL –≤ —á–∞—Ç–µ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
  document.addEventListener('touchstart', function(e) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–∏–∫ –±—ã–ª –Ω–∞ VSL –≤–∏–¥–µ–æ –∏–ª–∏ –µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –Ω–æ –Ω–µ –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö –∑–≤—É–∫–∞
    if (e.target && e.target.closest('.vsl-bubble') && 
        !e.target.closest('.vsl-sound-btn') && 
        e.target.id !== 'vslMuteBtn' && 
        e.target.id !== 'vslPlayBtnSimple') {
      e.preventDefault();
      e.stopPropagation();
      
      // –û—Ç–∫—Ä—ã–≤–∞–µ–º ReturnPopup —Å VSL
      if (window.showReturnPopup) {
        window.showReturnPopup();
      }
    }
  });

  // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∑–≤—É–∫–∞ VSL
  document.addEventListener('DOMContentLoaded', function() {
    const muteBtn = document.getElementById('vslMuteBtn');
    
    if (muteBtn) {
      muteBtn.addEventListener('mousedown', function(e) {
        e.preventDefault();
        e.stopPropagation();
        toggleVslSound();
      });
      
      muteBtn.addEventListener('touchstart', function(e) {
        e.preventDefault();
        e.stopPropagation();
        toggleVslSound();
      });
    }
  });

  // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è VSL –≤ —á–∞—Ç–µ
  function startChatVsl() {
    const video = document.getElementById('vslVideoInline');
    if (video) {
      // –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ–º –≤–∏–¥–µ–æ, –µ—Å–ª–∏ –æ–Ω–æ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
      if (video.readyState === 0) {
        video.load();
      }
      
      // –ó–∞–ø—É—Å–∫–∞–µ–º –≤–∏–¥–µ–æ
      video.play().then(function() {
        
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–∫–∏ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –≤–∏–¥–µ–æ
        setTimeout(() => {
          if (window.setupVslButtonHandlers) {
            window.setupVslButtonHandlers();
          }
        }, 100);
        
        // –¢–∞–∫–∂–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å—Ä–∞–∑—É
        if (window.setupVslButtonHandlers) {
          window.setupVslButtonHandlers();
        }
        
        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø–æ–ø–∞–ø–∞ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –º–∏–Ω—É—Ç–µ
        setupVslTimePopup(video);
      }).catch(function(error) {
        console.error('‚ùå Chat VSL play failed:', error);
      });
    } else {
      console.error('‚ùå Video element not found in startChatVsl');
    }
  }

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ø–∞–ø–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  document.addEventListener('DOMContentLoaded', function() {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ª–∏ —ç—Ç–æ –ø–æ—Å–µ—â–µ–Ω–∏–µ
    const hasVisitedBefore = localStorage.getItem('hasVisitedBefore');
    const savedVideoTime = localStorage.getItem('savedVideoTime');
    
    if (hasVisitedBefore && savedVideoTime && savedVideoTime > 0) {
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä
      setTimeout(function() {
        if (window.showReturnVisitPopup) {
          window.showReturnVisitPopup();
        }
      }, 2000); // –ó–∞–¥–µ—Ä–∂–∫–∞ 2 —Å–µ–∫—É–Ω–¥—ã
    } else {
      // –ü–µ—Ä–≤—ã–π –≤–∏–∑–∏—Ç - –∑–∞–ø–æ–º–∏–Ω–∞–µ–º
      localStorage.setItem('hasVisitedBefore', 'true');
      console.log('‚úÖ First visit, saved to localStorage');
    }
    
    // –ñ–¥–µ–º, –ø–æ–∫–∞ ReturnPopup –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∏ —Å–æ–∑–¥–∞—Å—Ç –≤–∏–¥–µ–æ
    setTimeout(function() {
      const popupVideo = document.getElementById('returnVslVideo');
      if (popupVideo) {
        console.log('‚úÖ Found returnVslVideo element, setting up popup');
        console.log('Video id:', popupVideo.id);
        console.log('Video src:', popupVideo.src);
        console.log('Video currentTime:', popupVideo.currentTime);
        console.log('Video readyState:', popupVideo.readyState);
        console.log('Video paused:', popupVideo.paused);
        console.log('Video duration:', popupVideo.duration);
        setupVslTimePopup(popupVideo);
      } else {
        console.log('‚ö†Ô∏è returnVslVideo not found yet, will try again when popup opens');
      }
    }, 1000);
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤–∏–¥–µ–æ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    const allVideos = document.querySelectorAll('video');
    console.log('üìπ Found video elements:', allVideos.length);
    allVideos.forEach((v, index) => {
      console.log(`Video ${index + 1}:`, {
        id: v.id,
        src: v.src,
        preload: v.preload,
        autoplay: v.autoplay,
        muted: v.muted,
        currentTime: v.currentTime,
        readyState: v.readyState,
        paused: v.paused,
        duration: v.duration
      });
    });
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(function() {
      console.log('üîÑ 3 seconds later - checking vslVideoInline again:');
      const videoAgain = document.getElementById('vslVideoInline');
      if (videoAgain) {
        console.log('Video currentTime:', videoAgain.currentTime);
        console.log('Video readyState:', videoAgain.readyState);
        console.log('Video paused:', videoAgain.paused);
      }
    }, 3000);
  });

  function stopChatVsl() {
    const video = document.getElementById('vslVideoInline');
    if (video) {
      video.pause();
    }
  }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ø–∞–ø–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –≤—Ä–µ–º–µ–Ω–∏ VSL
  function setupVslTimePopup(video) {
    console.log('üé¨ setupVslTimePopup called for video:', video.id);
    console.log('üé¨ Video readyState:', video.readyState);
    console.log('üé¨ Video duration:', video.duration);
    console.log('üé¨ Video paused:', video.paused);
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≥–æ—Ç–æ–≤–æ –ª–∏ –≤–∏–¥–µ–æ
    if (video.readyState < 1 || isNaN(video.duration)) {
      console.log('üé¨ Video not ready, waiting for metadata...');
      video.addEventListener('loadedmetadata', function() {
        console.log('üé¨ Video metadata loaded, setting up popup now');
        setupVslTimePopupInternal(video);
      });
      return;
    }
    
    setupVslTimePopupInternal(video);
  }
  
  function setupVslTimePopupInternal(video) {
    let popupShown = false;
    let messageShown = false;
    
    // –ß–∏—Ç–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ data-–∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    const startTime = parseInt(video.dataset.popupStart) || 893;
    const endTime = parseInt(video.dataset.popupEnd) || 1100;
    const messageTime = 713; // –ó–∞ 3 –º–∏–Ω—É—Ç—ã –¥–æ –ø–æ–ø–∞–ø–∞ (893 - 180 = 713)
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Ä–µ–º—è —Å–æ–æ–±—â–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∑–∞ 3 –º–∏–Ω—É—Ç—ã –¥–æ –ø–æ–ø–∞–ø–∞
    const expectedMessageTime = startTime - 180; // 3 –º–∏–Ω—É—Ç—ã = 180 —Å–µ–∫—É–Ω–¥
    if (messageTime !== expectedMessageTime) {
      console.warn('‚ö†Ô∏è Message time mismatch! Expected:', expectedMessageTime, 'Got:', messageTime);
    }
    

    
    // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–æ–∫–∞–∑–∞ –ø–æ–ø–∞–ø–∞/—Å–æ–æ–±—â–µ–Ω–∏—è
    function checkTimeAndShowPopup() {
      const currentTime = video.currentTime;
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –∑–∞ 3 –º–∏–Ω—É—Ç—ã –¥–æ –ø–æ–ø–∞–ø–∞
      if (!messageShown && currentTime >= messageTime) {
        console.log('üí¨ Showing auto message at time:', Math.floor(currentTime));
        if (window.showAutoMessage) {
          window.showAutoMessage();
        }
        messageShown = true;
      }
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –µ—Å–ª–∏ –≤—Ä–µ–º—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –∏ –ø–æ–ø–∞–ø –µ—â–µ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è
      if (!popupShown && currentTime >= startTime && currentTime <= endTime) {
        console.log('üéØ Showing VSL popup at time:', Math.floor(currentTime));
        showVslMidPopup();
        popupShown = true;
      }
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –≤–∏–¥–µ–æ
    video.addEventListener('timeupdate', function() {
      checkTimeAndShowPopup();
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–µ—Ä–µ–º–æ—Ç–∫–∏ –≤–∏–¥–µ–æ (–∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–º–∞—Ç—ã–≤–∞–µ—Ç)
    video.addEventListener('seeked', function() {
      checkTimeAndShowPopup();
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ (–∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä)
    video.addEventListener('seeking', function() {
      // –ü—É—Å—Ç–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
    video.addEventListener('loadedmetadata', function() {
      checkTimeAndShowPopup();
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
                  video.addEventListener('canplay', function() {
                checkTimeAndShowPopup();
              });

              // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –∑–∞–∫–∞–∑–∞ –∫–æ–≥–¥–∞ –≤–∏–¥–µ–æ –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å
              video.addEventListener('ended', function() {
                console.log('üé¨ Video ended, showing order form');
                if (window.showOrderFormModal) {
                  window.showOrderFormModal();
                }
              });
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ä–∞–∑—É –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ, –µ—Å–ª–∏ –≤–∏–¥–µ–æ —É–∂–µ –≤ –Ω—É–∂–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ
    if (video.readyState >= 1) { // HAVE_METADATA –∏–ª–∏ –±–æ–ª—å—à–µ
      checkTimeAndShowPopup();
    }
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 1 —Å–µ–∫—É–Ω–¥—É
    setInterval(function() {
      const currentTime = video.currentTime;
      
      if (video.readyState >= 1) {
        if (currentTime >= startTime && currentTime <= endTime && !popupShown) {
          showVslMidPopup();
          popupShown = true;
        }
      }
    }, 1000);
  }

  // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ –ø–æ–ø–∞–ø–∞ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –º–∏–Ω—É—Ç–µ
  function showVslMidPopup() {
    console.log('üéØ showVslMidPopup called');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞–∫–æ–µ –≤–∏–¥–µ–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è
    const returnVideo = document.getElementById('returnVslVideo');
    const returnVisitVideo = document.getElementById('returnVisitVideo');
    const chatVideo = document.getElementById('vslVideoInline');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞–∫–æ–π –ø–æ–ø–∞–ø –æ—Ç–∫—Ä—ã—Ç
    const returnPopup = document.getElementById('returnPopup');
    const returnVisitPopup = document.getElementById('returnVisitPopup');
    
    console.log('üéØ returnPopup display:', returnPopup ? returnPopup.style.display : 'not found');
    console.log('üéØ returnVisitPopup display:', returnVisitPopup ? returnVisitPopup.style.display : 'not found');
    console.log('üéØ returnVideo paused:', returnVideo ? returnVideo.paused : 'not found');
    console.log('üéØ returnVisitVideo paused:', returnVisitVideo ? returnVisitVideo.paused : 'not found');
    
    if (returnPopup && returnPopup.style.display === 'flex' && returnVideo) {
      // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç ReturnPopup
      console.log('üéØ Showing popup in ReturnPopup');
      if (window.showReturnVslMidPopup) {
        window.showReturnVslMidPopup();
      } else {
        console.error('‚ùå showReturnVslMidPopup is not defined!');
      }
    } else if (returnVisitPopup && returnVisitPopup.style.display === 'flex' && returnVisitVideo) {
      // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç ReturnVisitPopup
      console.log('üéØ Showing popup in ReturnVisitPopup');
      if (window.showReturnVisitVslMidPopup) {
        window.showReturnVisitVslMidPopup();
      } else {
        console.error('‚ùå showReturnVisitVslMidPopup is not defined!');
      }
    } else if (chatVideo && !chatVideo.paused) {
      // –ï—Å–ª–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –≤–∏–¥–µ–æ –≤ —á–∞—Ç–µ
      console.log('üéØ Showing popup in chat');
      const popup = document.getElementById('vslMidPopup');
      if (popup) {
        popup.style.display = 'block';
        popup.style.opacity = '1';
        popup.style.visibility = 'visible';
        popup.style.zIndex = '1000';
        
        const banner = popup.querySelector('.vsl-mid-banner');
        if (banner) {
          banner.style.zIndex = '1001';
        }
      }
    } else {
      console.log('‚ö†Ô∏è No suitable popup found to show green banner');
    }
  }

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ VSL –∫–Ω–æ–ø–∫–∏
  function setupVslButtonHandlers() {
    const vslPlayBtn = document.querySelector('.vsl-play-btn');
    const muteBtn = document.getElementById('vslMuteBtn');
    
    if (vslPlayBtn) {
      // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
      vslPlayBtn.replaceWith(vslPlayBtn.cloneNode(true));
      
      // –ü–æ–ª—É—á–∞–µ–º –Ω–æ–≤—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É
      const newVslPlayBtn = document.querySelector('.vsl-play-btn');
      
      if (newVslPlayBtn) {
        newVslPlayBtn.addEventListener('mousedown', function(e) {
          e.preventDefault();
          e.stopPropagation();
          toggleVslSound();
        });
        
        newVslPlayBtn.addEventListener('touchstart', function(e) {
          e.preventDefault();
          e.stopPropagation();
          toggleVslSound();
        });
      }
    }
    
    if (muteBtn) {
      muteBtn.addEventListener('mousedown', function(e) {
        e.preventDefault();
        e.stopPropagation();
        toggleVslSound();
      });
      
      muteBtn.addEventListener('touchstart', function(e) {
        e.preventDefault();
        e.stopPropagation();
        toggleVslSound();
      });
    }
  }



  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∞–≤–∏—à–∏ Escape
  document.addEventListener('keydown', async (e) => {
    if (e.key === 'Escape') {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞–∫–∞—è —Ñ–æ—Ä–º–∞ –æ—Ç–∫—Ä—ã—Ç–∞
      const orderFormModal = document.getElementById('orderFormModal');
      const callBookingModal = document.getElementById('callBookingModal');
      
      if (orderFormModal && orderFormModal.style.display === 'flex') {
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ñ–æ—Ä–º—ã –∑–∞–∫–∞–∑–∞ —á–µ—Ä–µ–∑ Escape
        if (savedFormData.name && savedFormData.phone) {
          const leadData = {
            name: savedFormData.name,
            phone: savedFormData.phone,
            callTime: '–§–æ—Ä–º–∞ –∑–∞–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ Escape',
            timestamp: new Date().toISOString(),
            reason: 'order_form_escape_closed',
            videoWatchTime: savedFormData.videoWatchTime || 0,
            userAgent: navigator.userAgent
          };
          
          try {
            await fetch('/api/postback', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(leadData)
            });
            console.log('Order form closed via Escape - data sent');
          } catch (error) {
            console.error('Error sending order form escape data:', error);
          }
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –≤–æ–∑–≤—Ä–∞—Ç–∞ —Å —Ñ–æ—Ä–º—ã
        if (window.showFormReturnPopup) {
          window.showFormReturnPopup();
        }
      } else if (callBookingModal && callBookingModal.style.display === 'flex') {
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ñ–æ—Ä–º—ã –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ Escape
        if (savedFormData.name && savedFormData.phone) {
          const callTimeElement = document.getElementById('callTime');
          const callTime = callTimeElement ? callTimeElement.value : '–ù–µ –≤—ã–±—Ä–∞–Ω–æ';
          
          const leadData = {
            name: savedFormData.name,
            phone: savedFormData.phone,
            callTime: callTime,
            timestamp: new Date().toISOString(),
            reason: 'call_booking_escape_closed',
            videoWatchTime: savedFormData.videoWatchTime || 0,
            userAgent: navigator.userAgent
          };
          
          try {
            await fetch('/api/postback', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(leadData)
            });
            console.log('Call booking form closed via Escape - data sent');
          } catch (error) {
            console.error('Error sending call booking escape data:', error);
          }
        }
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏
        if (window.showTimeSelectionPopup) {
          window.showTimeSelectionPopup();
        }
      }
    }
  });



  // Export functions to window
  window.openPopup = openPopup;
  window.toggleVslSound = toggleVslSound;
  window.startChatVsl = startChatVsl;
  window.stopChatVsl = stopChatVsl;
  window.setupVslButtonHandlers = setupVslButtonHandlers;
  window.setupVslTimePopup = setupVslTimePopup;
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫—Ä–µ—Å—Ç–∏–∫–∞ –∏ –ø–æ–ø–∞–ø–∞ –≤—ã–±–æ—Ä–∞
  const vslCloseBtn = document.getElementById('vslCloseBtn');
  const vslCloseChoicePopup = document.getElementById('vslCloseChoicePopup');
  const continueWatchingChoice = document.getElementById('continueWatchingChoice');
  const returnToChatChoice = document.getElementById('returnToChatChoice');

  vslCloseBtn?.addEventListener('click', () => {
    if (vslCloseChoicePopup) {
      vslCloseChoicePopup.style.display = 'flex';
    }
  });

  continueWatchingChoice?.addEventListener('click', () => {
    if (vslCloseChoicePopup) {
      vslCloseChoicePopup.style.display = 'none';
    }
  });

  returnToChatChoice?.addEventListener('click', () => {
    if (vslCloseChoicePopup) {
      vslCloseChoicePopup.style.display = 'none';
    }
    
    // –ü—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–ø–∞–ø—ã
    const returnPopup = document.getElementById('returnPopup');
    const returnVisitPopup = document.getElementById('returnVisitPopup');
    
    if (returnPopup) {
      returnPopup.style.display = 'none';
    }
    
    if (returnVisitPopup) {
      returnVisitPopup.style.display = 'none';
    }
  });

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø–æ–ø–∞–ø–∞ –≤—ã–±–æ—Ä–∞
  function showVslCloseChoicePopup() {
    if (vslCloseChoicePopup) {
      vslCloseChoicePopup.style.display = 'flex';
    }
  }



  window.showVslMidPopup = showVslMidPopup;
  window.showVslCloseChoicePopup = showVslCloseChoicePopup;
  window.showAutoMessage = showAutoMessage;
  window.savedFormData = savedFormData;
</script>

<style>
  .container {
    /* –°—Ç–∏–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –≤ global.css */
  }

  .chat {
    background: #e5ddd5;
    background-image: url('/whatsapp_background.png');
    background-repeat: repeat;
    background-size: auto;
    background-position: center;
    flex: 1;
    padding: 10px 8px 100px;
    position: relative;
    overflow-y: auto;
    overflow-x: hidden;
    min-height: 0; /* –í–∞–∂–Ω–æ –¥–ª—è flex-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
    height: 100%; /* –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –ø–æ–ª–Ω—É—é –≤—ã—Å–æ—Ç—É */
    scroll-behavior: smooth;
  }

  .bubble {
    background: #fff;
    border-radius: 8px;
    padding: 8px 10px;
    margin: 8px 0;
    max-width: 80%;
    font-size: 14px;
    line-height: 1.35;
    box-shadow: 0 1px 0 rgba(0,0,0,.06);
    position: relative;
  }

  .vsl-bubble {
    max-width: 70%;
    margin: 8px auto;
    padding: 0;
  }

  .bubble::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: -8px;
    width: 0;
    height: 0;
    border: 8px solid transparent;
    border-right-color: #fff;
    border-left: 0;
    border-bottom: 0;
    margin-bottom: 8px;
  }

  .bubble.encryption {
    background: #f8f8f8;
    color: #8e8e8e;
    font-size: 12px;
    max-width: 90%;
    margin: 4px auto;
    text-align: center;
    border-radius: 12px;
    padding: 8px 12px;
    box-shadow: none;
  }

  .bubble.encryption::after {
    display: none;
  }

  .bubble.urgent {
    background: #fff;
    color: #000;
    font-weight: 400;
    text-align: left;
  }

  /* .bubble.problem {
    background: #fff;
    color: #d32f2f;
    font-weight: 600;
  } */

  .vsl-bubble {
    max-width: 100%;
    cursor: pointer;
  }

  .vsl-bubble::after {
    display: none;
  }

  .vsl-card {
    background: #fff;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 16px rgba(0,0,0,.15);
    max-width: 100%;
    cursor: pointer;
    margin: 0;
  }

  .vsl-thumb {
    position: relative;
    display: grid;
    place-items: center;
    height: 500px !important;
    min-height: 500px !important;
    background: #333;
    color: #fff;
    font-weight: 700;
    font-size: 24px;
    overflow: hidden;
  }

  .vsl-video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: absolute;
    top: 0;
    left: 0;
    /* –û—Ç–∫–ª—é—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
    pointer-events: none;
  }

  /* –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–µ–æ */
  .vsl-video::-webkit-media-controls {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-panel {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-play-button {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-timeline {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-current-time-display {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-time-remaining-display {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-mute-button {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-volume-slider {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-fullscreen-button {
    display: none !important;
  }

  /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
  .vsl-video::-webkit-media-controls-enclosure {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-overlay-play-button {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-rewind-button {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-return-to-realtime-button {
    display: none !important;
  }

  .vsl-video::-webkit-media-controls-toggle-closed-captions-button {
    display: none !important;
  }

  /* –û—Ç–∫–ª—é—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è Firefox */
  .vsl-video::-moz-media-controls {
    display: none !important;
  }

  /* –û—Ç–∫–ª—é—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è Edge */
  .vsl-video::-ms-media-controls {
    display: none !important;
  }

  .vsl-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 2;
    gap: 15px;
  }

  .vsl-save-text {
    color: white;
    font-size: 14px;
    font-weight: 600;
    text-align: center;
    margin-top: 5px;
  }

  .vsl-placeholder {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1;
  }

  .vsl-play-btn {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
    z-index: 2;
    cursor: pointer;
    transition: transform 0.2s ease;
  }

  .vsl-play-btn:hover {
    transform: translate(-50%, -50%) scale(1.1);
  }

  .vsl-play-btn svg {
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
  }

  .speaker-icon {
    font-size: 20px;
  }

  .play-text {
    font-size: 14px;
    font-weight: 600;
  }

  .vsl-info {
    padding: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 12px;
  }

  .vsl-title {
    font-weight: 600;
    color: #333;
  }

  .vsl-hint {
    font-size: 12px;
    color: var(--muted);
  }

  .chat-input {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: #f0f0f0;
    padding: 8px 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    border-top: 1px solid #ddd;
    border-radius: 0 0 20px 20px;
    z-index: 100;
    height: 60px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
  }

  .input-btn {
    background: #fff;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    color: #54656f;
    flex-shrink: 0;
    transition: background-color 0.2s;
  }

  .input-btn:hover {
    background: #e9edef;
  }

  .input-field-container {
    flex: 1;
    position: relative;
    display: flex;
    align-items: center;
    background: #fff;
    border-radius: 20px;
    padding: 8px 12px;
    min-height: 40px;
  }

  .chat-input-field {
    flex: 1;
    border: none;
    outline: none;
    background: transparent;
    font-size: 15px;
    color: #111b21;
    padding: 0;
    margin: 0;
  }

  .chat-input-field::placeholder {
    color: #667781;
  }

  .emoji-btn {
    background: none;
    border: none;
    color: #54656f;
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s;
  }

  .emoji-btn:hover {
    background: #e9edef;
  }

  .input-actions {
    display: flex;
    gap: 4px;
    margin-left: 8px;
  }

  .action-btn {
    background: none;
    border: none;
    color: #54656f;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s;
    width: 40px;
    height: 40px;
  }

  .action-btn:hover {
    background: #e9edef;
  }

  .popup-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.65);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 50;
  }

  .popup {
    background: #000;
    border-radius: 12px;
    width: min(900px, 92vw);
    aspect-ratio: 16/9;
    position: relative;
    overflow: hidden;
  }

  .popup video {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .popup .close {
    position: absolute;
    top: 8px;
    right: 8px;
    background: rgba(255,255,255,.9);
    border-radius: 999px;
    padding: 6px;
    cursor: pointer;
    border: none;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
  }

  @media (min-width: 500px) {
    .pwa-modal {
      max-width: 420px;
    }
  }



  /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —Å–∫–∏–¥–∫–∏ */
  .discount-message {
    display: flex;
    align-items: center;
    gap: 12px;
    background: #fff;
    border-radius: 12px;
    padding: 16px;
    margin: 12px 0;
    box-shadow: 0 4px 16px rgba(0,0,0,.1);
    max-width: 90%;
    position: relative;
  }

  .discount-message::after {
    display: none;
  }

  .discount-message .product-image {
    width: 70px;
    height: 90px;
    flex-shrink: 0;
  }

  .discount-message .product-image img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 8px;
  }

  .discount-content {
    flex: 1;
  }

  .discount-text {
    margin: 0 0 12px 0;
    font-size: 14px;
    line-height: 1.4;
    color: #333;
    font-weight: 500;
  }

  .discount-text p {
    margin: 0 0 4px 0;
  }

  .discount-text p:last-child {
    margin-bottom: 0;
  }

  .discount-btn {
    background: #007bff;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.2s;
    width: 100%;
  }

  .discount-btn:hover {
    background: #0056b3;
  }



  .auto-message {
    max-width: 90%;
    margin: 8px 0;
    background: #fff;
    border-radius: 8px;
    padding: 12px;
    box-shadow: 0 1px 0 rgba(0,0,0,.06);
    position: relative;
  }

  .auto-message::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: -8px;
    width: 0;
    height: 0;
    border: 8px solid transparent;
    border-right-color: #fff;
    border-left: 0;
    border-bottom: 0;
  }

  /* PWA Modal Styles */
  .pwa-modal {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 100%;
    max-width: 420px;
    height: 100%;
    z-index: 10000;
    display: flex;
    align-items: flex-end;
    justify-content: center;
  }

  .pwa-modal-backdrop {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
  }

  .pwa-modal-content {
    position: relative;
    width: 100%;
    background: #fff;
    border-radius: 20px 20px 0 0;
    box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.3);
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    max-height: 80vh;
    overflow: hidden;
  }

  .pwa-modal.show .pwa-modal-content {
    transform: translateY(0);
  }

  .pwa-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px 8px;
    border-bottom: 1px solid #f0f0f0;
  }

  .pwa-modal-handle {
    width: 40px;
    height: 4px;
    background: #ddd;
    border-radius: 2px;
    margin: 0 auto;
  }

  .pwa-modal-close {
    background: none;
    border: none;
    font-size: 24px;
    color: #666;
    cursor: pointer;
    padding: 4px;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
  }

  .pwa-modal-close:hover {
    background: #f0f0f0;
  }

  .pwa-modal-body {
    padding: 20px;
    overflow-y: auto;
    max-height: calc(80vh - 80px);
  }

  /* Form Styles */
  .form-header {
    text-align: center;
    margin-bottom: 20px;
  }

  .form-title {
    font-size: 20px;
    font-weight: bold;
    color: #333;
    margin: 0;
  }

  .product-image-section {
    text-align: center;
    margin-bottom: 20px;
  }

  .product-image {
    max-width: 200px;
    height: auto;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .timer-section {
    text-align: center;
    margin-bottom: 20px;
  }

  .timer-badge {
    display: inline-block;
    background: linear-gradient(135deg, #ff4444, #ff6666);
    color: white;
    padding: 10px 20px;
    border-radius: 25px;
    font-weight: bold;
    font-size: 18px;
    box-shadow: 0 4px 12px rgba(255, 68, 68, 0.3);
  }

  .order-form-fields {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .field-label {
    font-size: 14px;
    font-weight: 600;
    color: #333;
  }

  .form-input {
    padding: 14px;
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    font-size: 16px;
    transition: all 0.2s;
    background: #fafafa;
  }

  .form-input:focus {
    outline: none;
    border-color: #25d366;
    background: #fff;
    box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
  }

  .submit-btn {
    background: linear-gradient(135deg, #25d366, #128c7e);
    color: white;
    border: none;
    padding: 16px;
    border-radius: 12px;
    font-weight: 600;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
  }

  .submit-btn:hover {
    background: linear-gradient(135deg, #20b358, #0f7a6b);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(37, 211, 102, 0.4);
  }

  .form-disclaimer {
    font-size: 12px;
    color: #666;
    text-align: center;
    line-height: 1.4;
    margin-top: 12px;
    padding: 12px;
    background: #f8f9fa;
    border-radius: 8px;
  }

  /* Call Booking Styles */
  .call-to-action {
    text-align: center;
    margin-bottom: 24px;
  }

  .call-title {
    font-size: 20px;
    font-weight: bold;
    color: #333;
    margin: 0 0 8px 0;
    text-transform: uppercase;
  }

  .call-subtitle {
    font-size: 16px;
    color: #666;
    margin: 0;
  }

  .time-selection {
    margin-bottom: 24px;
  }

  .time-dropdown {
    width: 100%;
    padding: 14px;
    border: 2px solid #90ee90;
    border-radius: 12px;
    font-size: 16px;
    background: #f0f8f0;
    color: #333;
    cursor: pointer;
    appearance: none;
    background-image: url('data:image/svg+xml;utf8,<svg fill="black" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/></svg>');
    background-repeat: no-repeat;
    background-position: right 14px center;
    background-size: 20px;
    box-sizing: border-box;
    transition: all 0.2s;
  }

  .time-dropdown:focus {
    outline: none;
    border-color: #25d366;
    box-shadow: 0 0 0 3px rgba(37, 211, 102, 0.1);
  }

  .call-submit-btn {
    background: linear-gradient(135deg, #4fc3f7, #25d366);
    color: white;
    border: none;
    padding: 16px;
    border-radius: 12px;
    font-weight: 600;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.2s;
    width: 100%;
    margin-bottom: 16px;
    box-shadow: 0 4px 12px rgba(79, 195, 247, 0.3);
  }

  .call-submit-btn:hover {
    background: linear-gradient(135deg, #29b6f6, #20b358);
    transform: translateY(-2px);
    box-shadow: 0 6px 16px rgba(79, 195, 247, 0.4);
  }

  .back-btn-chat {
    background: #f0f0f0;
    color: #666;
    border: none;
    padding: 14px;
    border-radius: 12px;
    font-weight: 600;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.2s;
    width: 100%;
  }

  .back-btn-chat:hover {
    background: #e0e0e0;
    transform: translateY(-1px);
  }

  /* Mobile optimizations */
  @media (max-width: 480px) {
    .pwa-modal {
      max-width: calc(100% - 40px);
      left: 20px;
      right: 20px;
      transform: none;
    }
    
    .pwa-modal-content {
      border-radius: 16px 16px 0 0;
    }
    
    .pwa-modal-body {
      padding: 16px;
    }
    
    .form-title {
      font-size: 18px;
    }
    
    .call-title {
      font-size: 18px;
    }

    .reviews-banner {
      padding: 12px;
      margin: 16px 0 0 0;
    }

    .reviews-text {
      font-size: 14px;
      line-height: 1.2;
    }

    .review-item {
      margin-bottom: 16px;
    }

    .review-images {
      padding: 8px;
      gap: 6px;
    }

    .review-content {
      padding: 10px 12px 12px 12px;
    }

    .review-text {
      font-size: 13px;
      line-height: 1.3;
    }

    .rating-stars {
      font-size: 14px;
    }

    .rating-score {
      font-size: 13px;
    }

    .text-review-item {
      padding: 12px;
      margin-bottom: 12px;
    }

    .reviewer-avatar {
      width: 28px;
      height: 28px;
      font-size: 14px;
    }

    .reviewer-name {
      font-size: 13px;
    }

    .review-title {
      font-size: 15px;
    }

    .review-date {
      font-size: 11px;
    }

    .review-verified {
      font-size: 11px;
    }

    .review-text {
      font-size: 13px;
    }

    .review-helpful {
      font-size: 11px;
    }

    .vsl-play-btn svg {
      width: 60px;
      height: 60px;
    }

    .vsl-save-text {
      font-size: 12px;
    }
  }

  .auto-message-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
  }

  .auto-message .product-image {
    width: 150px;
    height: auto;
    text-align: center;
  }

  .auto-message .product-image img {
    width: 100%;
    height: auto;
    border-radius: 8px;
  }

  .message-text {
    text-align: center;
    font-size: 14px;
    line-height: 1.4;
    color: #333;
    font-weight: 500;
  }



  .message-text p {
    margin: 0 0 4px 0;
  }

  .message-text p:last-child {
    margin-bottom: 0;
  }

  .auto-discount-container {
    max-width: 90%;
    margin: 8px 0;
    text-align: center;
  }

  .auto-discount-btn {
    background: #007bff;
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.2s;
    width: 100%;
  }

  .auto-discount-btn:hover {
    background: #0056b3;
  }

  /* –ü–ª–∞—à–∫–∞ —Å –æ—Ç–∑—ã–≤–∞–º–∏ –º—É–∂—á–∏–Ω */
  .reviews-banner {
    background: #90EE90;
    border: 2px solid #000;
    border-radius: 12px;
    padding: 16px;
    margin: 20px 0 0 0;
    text-align: center;
  }

  .reviews-text {
    color: #000;
    font-weight: bold;
    font-family: sans-serif;
    font-size: 16px;
    line-height: 1.3;
    margin: 0;
  }

  .reviews-text br {
    display: block;
    content: "";
    margin: 2px 0;
  }

  /* –°–µ–∫—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ */
  .reviews-section {
    margin: 20px 0 0 0;
  }

  .review-item {
    margin-bottom: 20px;
    background: #fff;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .review-images {
    display: flex;
    gap: 8px;
    padding: 12px;
  }

  .review-images.single {
    justify-content: center;
  }

  .review-image {
    flex: 1;
    max-width: 50%;
  }

  .review-images.single .review-image {
    max-width: 80%;
  }

  .review-image img {
    width: 100%;
    height: auto;
    border-radius: 8px;
    object-fit: cover;
  }

  .review-content {
    padding: 12px 16px 16px 16px;
  }

  .review-text {
    font-size: 14px;
    line-height: 1.4;
    color: #333;
    margin-bottom: 8px;
    font-weight: 500;
  }

  .review-rating {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .rating-stars {
    color: #FFD700;
    font-size: 16px;
  }

  .rating-score {
    font-weight: bold;
    color: #333;
    font-size: 14px;
  }

  /* –¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ—Ç–∑—ã–≤—ã */
  .text-reviews-section {
    margin: 20px 0 0 0;
  }

  .text-review-item {
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 16px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
  }

  .review-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .reviewer-info {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .reviewer-avatar {
    width: 32px;
    height: 32px;
    background: #f0f0f0;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
  }

  .reviewer-name {
    font-weight: 600;
    color: #333;
    font-size: 14px;
  }

  .review-title {
    font-weight: bold;
    color: #333;
    font-size: 16px;
    margin-bottom: 4px;
  }

  .review-date {
    color: #666;
    font-size: 12px;
    margin-bottom: 2px;
  }

  .review-verified {
    color: #ff6b35;
    font-size: 12px;
    font-weight: 600;
    margin-bottom: 8px;
  }

  .review-text {
    color: #333;
    font-size: 14px;
    line-height: 1.4;
    margin-bottom: 8px;
  }

  .review-helpful {
    color: #666;
    font-size: 12px;
    font-style: italic;
  }

  /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ø–∞–ø–∞ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –º–∏–Ω—É—Ç–µ VSL */
  .vsl-mid-popup {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10;
    pointer-events: none; /* –ü–æ–∑–≤–æ–ª—è–µ—Ç –∫–ª–∏–∫–∞—Ç—å —á–µ—Ä–µ–∑ –ø–æ–ø–∞–ø –Ω–∞ –≤–∏–¥–µ–æ */
    background: transparent; /* –£–±–∏—Ä–∞–µ–º –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ */
  }

  .vsl-mid-banner {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    background: #4CAF50; /* –ú–µ–Ω–µ–µ —è—Ä–∫–∏–π –∑–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç */
    color: white;
    padding: 15px;
    text-align: center;
    font-weight: bold;
    font-size: 16px;
    z-index: 11;
    pointer-events: auto; /* –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –±–∞–Ω–Ω–µ—Ä–æ–º */
    position: relative;
  }

  .vsl-mid-vignette {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at center, transparent 30%, rgba(0, 0, 0, 0.3) 100%);
    pointer-events: none;
    z-index: 1;
  }

  /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä—è–º–æ–≥–æ –ø–æ–ø–∞–ø–∞ —Å –≤–∏–¥–µ–æ —É–¥–∞–ª–µ–Ω—ã - –∏—Å–ø–æ–ª—å–∑—É–µ–º ReturnPopup */

  /* –°—Ç–∏–ª–∏ –¥–ª—è –∑–µ–ª–µ–Ω–æ–π –º–∏–≥–∞—é—â–µ–π –∫–Ω–æ–ø–∫–∏ –≤–∫–ª—é—á–µ–Ω–∏—è –∑–≤—É–∫–∞ */
  .vsl-sound-btn {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 5;
    cursor: pointer;
  }

  .sound-btn-content {
    background: #4CAF50;
    border: 3px solid #45a049;
    border-radius: 12px;
    padding: 16px 24px;
    box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
    text-align: center;
    min-width: 200px;
    animation: pulse-green 2s infinite;
  }

  .sound-btn-text-top {
    color: white;
    font-weight: 700;
    font-size: 16px;
    margin-bottom: 4px;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
  }

  .sound-btn-text-bottom {
    color: white;
    font-weight: 600;
    font-size: 14px;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
  }

  .vsl-sound-btn:hover {
    animation: none;
  }

  .vsl-sound-btn:hover .sound-btn-content {
    animation: none;
    background: #45a049;
    transform: scale(1.05);
    box-shadow: 0 6px 16px rgba(76, 175, 80, 0.6);
  }

  /* –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –∞–Ω–∏–º–∞—Ü–∏—é, —á—Ç–æ–±—ã –æ–Ω–∞ –Ω–µ –≤–ª–∏—è–ª–∞ –Ω–∞ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ */
  @keyframes pulse-green {
    0% {
      transform: scale(1);
      opacity: 1;
    }
    50% {
      transform: scale(1.05);
      opacity: 0.9;
    }
    100% {
      transform: scale(1);
      opacity: 1;
    }
  }

  /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ø–∞–ø–∞ –≤—ã–±–æ—Ä–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ VSL */
  .vsl-close-choice-popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
  }

  .vsl-close-choice-content {
    background: white;
    padding: 30px;
    border-radius: 12px;
    text-align: center;
    max-width: 400px;
    width: 90%;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  }

  .vsl-close-choice-content h3 {
    margin: 0 0 20px 0;
    font-size: 18px;
    color: #333;
  }

  .vsl-close-choice-buttons {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .vsl-close-choice-buttons .btn-primary {
    background: linear-gradient(135deg, #ff6b35, #ff4444);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s;
  }

  .vsl-close-choice-buttons .btn-primary:hover {
    background: linear-gradient(135deg, #e55a2b, #e53935);
    transform: translateY(-2px);
  }

  .vsl-close-choice-buttons .btn-secondary {
    background: #f5f5f5;
    color: #333;
    border: 2px solid #ddd;
    padding: 12px 20px;
    border-radius: 8px;
    font-weight: 700;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.3s;
  }

  .vsl-close-choice-buttons .btn-secondary:hover {
    background: #e9e9e9;
    border-color: #ccc;
    transform: translateY(-2px);
  }


</style>


